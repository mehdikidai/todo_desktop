var em=Object.defineProperty;var tm=(t,e,n)=>e in t?em(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var nm=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var wn=(t,e,n)=>(tm(t,typeof e!="symbol"?e+"":e,n),n);var tA=nm((oA,Ws)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var el={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vc=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},rm=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],o=t[n++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},wc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,o=a?t[s+1]:0,u=s+2<t.length,l=u?t[s+2]:0,c=i>>2,h=(i&3)<<4|o>>4;let d=(o&15)<<2|l>>6,m=l&63;u||(m=64,a||(d=64)),r.push(n[c],n[h],n[d],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(vc(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):rm(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],o=s<t.length?n[t.charAt(s)]:0;++s;const l=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||o==null||l==null||h==null)throw new sm;const d=i<<2|o>>4;if(r.push(d),l!==64){const m=o<<4&240|l>>2;if(r.push(m),h!==64){const x=l<<6&192|h;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class sm extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const im=function(t){const e=vc(t);return wc.encodeByteArray(e,!0)},qs=function(t){return im(t).replace(/\./g,"")},am=function(t){try{return wc.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function om(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const um=()=>om().__FIREBASE_DEFAULTS__,lm=()=>{if(typeof process>"u"||typeof el>"u")return;const t=el.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},cm=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&am(t[1]);return e&&JSON.parse(e)},wo=()=>{try{return um()||lm()||cm()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},hm=t=>{var e,n;return(n=(e=wo())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},dm=t=>{const e=hm(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Tc=()=>{var t;return(t=wo())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mm(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[qs(JSON.stringify(n)),qs(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pm(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function gm(){var t;const e=(t=wo())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _m(){return!gm()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ym(){try{return typeof indexedDB=="object"}catch{return!1}}function vm(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wm="FirebaseError";class Kn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=wm,Object.setPrototypeOf(this,Kn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ec.prototype.create)}}class Ec{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?Tm(i,r):"Error",o=`${this.serviceName}: ${a} (${s}).`;return new Kn(s,o,r)}}function Tm(t,e){return t.replace(Em,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Em=/\{\$([^}]+)}/g;function ba(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(tl(i)&&tl(a)){if(!ba(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function tl(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lt(t){return t&&t._delegate?t._delegate:t}class Ar{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xt="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Im{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new fm;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Sm(e))try{this.getOrInitializeService({instanceIdentifier:Xt})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Xt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xt){return this.instances.has(e)}getOptions(e=Xt){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);r===o&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Am(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Xt){return this.component?this.component.multipleInstances?e:Xt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Am(t){return t===Xt?void 0:t}function Sm(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rm{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Im(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var q;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(q||(q={}));const km={debug:q.DEBUG,verbose:q.VERBOSE,info:q.INFO,warn:q.WARN,error:q.ERROR,silent:q.SILENT},Dm=q.INFO,Pm={[q.DEBUG]:"log",[q.VERBOSE]:"log",[q.INFO]:"info",[q.WARN]:"warn",[q.ERROR]:"error"},bm=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Pm[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ic{constructor(e){this.name=e,this._logLevel=Dm,this._logHandler=bm,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in q))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?km[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,q.DEBUG,...e),this._logHandler(this,q.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,q.VERBOSE,...e),this._logHandler(this,q.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,q.INFO,...e),this._logHandler(this,q.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,q.WARN,...e),this._logHandler(this,q.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,q.ERROR,...e),this._logHandler(this,q.ERROR,...e)}}const Cm=(t,e)=>e.some(n=>t instanceof n);let nl,rl;function xm(){return nl||(nl=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Mm(){return rl||(rl=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ac=new WeakMap,Ca=new WeakMap,Sc=new WeakMap,ua=new WeakMap,To=new WeakMap;function Vm(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(Lt(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&Ac.set(n,t)}).catch(()=>{}),To.set(e,t),e}function Nm(t){if(Ca.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Ca.set(t,e)}let xa={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Ca.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Sc.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Lt(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Om(t){xa=t(xa)}function Lm(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(la(this),e,...n);return Sc.set(r,e.sort?e.sort():[e]),Lt(r)}:Mm().includes(t)?function(...e){return t.apply(la(this),e),Lt(Ac.get(this))}:function(...e){return Lt(t.apply(la(this),e))}}function Fm(t){return typeof t=="function"?Lm(t):(t instanceof IDBTransaction&&Nm(t),Cm(t,xm())?new Proxy(t,xa):t)}function Lt(t){if(t instanceof IDBRequest)return Vm(t);if(ua.has(t))return ua.get(t);const e=Fm(t);return e!==t&&(ua.set(t,e),To.set(e,t)),e}const la=t=>To.get(t);function Um(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),o=Lt(a);return r&&a.addEventListener("upgradeneeded",u=>{r(Lt(a.result),u.oldVersion,u.newVersion,Lt(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),o.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",l=>s(l.oldVersion,l.newVersion,l))}).catch(()=>{}),o}const jm=["get","getKey","getAll","getAllKeys","count"],Bm=["put","add","delete","clear"],ca=new Map;function sl(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ca.get(e))return ca.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Bm.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||jm.includes(n)))return;const i=async function(a,...o){const u=this.transaction(a,s?"readwrite":"readonly");let l=u.store;return r&&(l=l.index(o.shift())),(await Promise.all([l[n](...o),s&&u.done]))[0]};return ca.set(e,i),i}Om(t=>({...t,get:(e,n,r)=>sl(e,n)||t.get(e,n,r),has:(e,n)=>!!sl(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if($m(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function $m(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ma="@firebase/app",il="0.10.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const un=new Ic("@firebase/app"),Wm="@firebase/app-compat",qm="@firebase/analytics-compat",zm="@firebase/analytics",Hm="@firebase/app-check-compat",Gm="@firebase/app-check",Zm="@firebase/auth",Km="@firebase/auth-compat",Qm="@firebase/database",Jm="@firebase/database-compat",Xm="@firebase/functions",ep="@firebase/functions-compat",tp="@firebase/installations",np="@firebase/installations-compat",rp="@firebase/messaging",sp="@firebase/messaging-compat",ip="@firebase/performance",ap="@firebase/performance-compat",op="@firebase/remote-config",up="@firebase/remote-config-compat",lp="@firebase/storage",cp="@firebase/storage-compat",hp="@firebase/firestore",dp="@firebase/firestore-compat",fp="firebase",mp="10.11.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va="[DEFAULT]",pp={[Ma]:"fire-core",[Wm]:"fire-core-compat",[zm]:"fire-analytics",[qm]:"fire-analytics-compat",[Gm]:"fire-app-check",[Hm]:"fire-app-check-compat",[Zm]:"fire-auth",[Km]:"fire-auth-compat",[Qm]:"fire-rtdb",[Jm]:"fire-rtdb-compat",[Xm]:"fire-fn",[ep]:"fire-fn-compat",[tp]:"fire-iid",[np]:"fire-iid-compat",[rp]:"fire-fcm",[sp]:"fire-fcm-compat",[ip]:"fire-perf",[ap]:"fire-perf-compat",[op]:"fire-rc",[up]:"fire-rc-compat",[lp]:"fire-gcs",[cp]:"fire-gcs-compat",[hp]:"fire-fst",[dp]:"fire-fst-compat","fire-js":"fire-js",[fp]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zs=new Map,gp=new Map,Na=new Map;function al(t,e){try{t.container.addComponent(e)}catch(n){un.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Hs(t){const e=t.name;if(Na.has(e))return un.debug(`There were multiple attempts to register component ${e}.`),!1;Na.set(e,t);for(const n of zs.values())al(n,t);for(const n of gp.values())al(n,t);return!0}function _p(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yp={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ft=new Ec("app","Firebase",yp);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ar("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ft.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wp=mp;function Rc(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Va,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Ft.create("bad-app-name",{appName:String(s)});if(n||(n=Tc()),!n)throw Ft.create("no-options");const i=zs.get(s);if(i){if(ba(n,i.options)&&ba(r,i.config))return i;throw Ft.create("duplicate-app",{appName:s})}const a=new Rm(s);for(const u of Na.values())a.addComponent(u);const o=new vp(n,r,a);return zs.set(s,o),o}function Tp(t=Va){const e=zs.get(t);if(!e&&t===Va&&Tc())return Rc();if(!e)throw Ft.create("no-app",{appName:t});return e}function Cn(t,e,n){var r;let s=(r=pp[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${s}" with version "${e}":`];i&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),un.warn(o.join(" "));return}Hs(new Ar(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ep="firebase-heartbeat-database",Ip=1,Sr="firebase-heartbeat-store";let ha=null;function kc(){return ha||(ha=Um(Ep,Ip,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Sr)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ft.create("idb-open",{originalErrorMessage:t.message})})),ha}async function Ap(t){try{const n=(await kc()).transaction(Sr),r=await n.objectStore(Sr).get(Dc(t));return await n.done,r}catch(e){if(e instanceof Kn)un.warn(e.message);else{const n=Ft.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});un.warn(n.message)}}}async function ol(t,e){try{const r=(await kc()).transaction(Sr,"readwrite");await r.objectStore(Sr).put(e,Dc(t)),await r.done}catch(n){if(n instanceof Kn)un.warn(n.message);else{const r=Ft.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});un.warn(r.message)}}}function Dc(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sp=1024,Rp=30*24*60*60*1e3;class kp{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Pp(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=ul();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=Rp}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=ul(),{heartbeatsToSend:r,unsentEntries:s}=Dp(this._heartbeatsCache.heartbeats),i=qs(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function ul(){return new Date().toISOString().substring(0,10)}function Dp(t,e=Sp){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),ll(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),ll(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Pp{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ym()?vm().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Ap(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return ol(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return ol(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function ll(t){return qs(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bp(t){Hs(new Ar("platform-logger",e=>new Ym(e),"PRIVATE")),Hs(new Ar("heartbeat",e=>new kp(e),"PRIVATE")),Cn(Ma,il,t),Cn(Ma,il,"esm2017"),Cn("fire-js","")}bp("");var Cp="firebase",xp="10.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cn(Cp,xp,"app");var Mp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},y,Eo=Eo||{},M=Mp||self;function wi(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Ti(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function Vp(t){return Object.prototype.hasOwnProperty.call(t,da)&&t[da]||(t[da]=++Np)}var da="closure_uid_"+(1e9*Math.random()>>>0),Np=0;function Op(t,e,n){return t.call.apply(t.bind,arguments)}function Lp(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function Se(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Se=Op:Se=Lp,Se.apply(null,arguments)}function Rs(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function pe(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,s,i){for(var a=Array(arguments.length-2),o=2;o<arguments.length;o++)a[o-2]=arguments[o];return e.prototype[s].apply(r,a)}}function Zt(){this.s=this.s,this.o=this.o}var Fp=0;Zt.prototype.s=!1;Zt.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),Fp!=0)&&Vp(this)};Zt.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Pc=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Io(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function cl(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(wi(r)){const s=t.length||0,i=r.length||0;t.length=s+i;for(let a=0;a<i;a++)t[s+a]=r[a]}else t.push(r)}}function Re(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Re.prototype.h=function(){this.defaultPrevented=!0};var Up=function(){if(!M.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const n=()=>{};M.addEventListener("test",n,e),M.removeEventListener("test",n,e)}catch{}return t}();function Rr(t){return/^[\s\xa0]*$/.test(t)}function Ei(){var t=M.navigator;return t&&(t=t.userAgent)?t:""}function et(t){return Ei().indexOf(t)!=-1}function Ao(t){return Ao[" "](t),t}Ao[" "]=function(){};function jp(t,e){var n=Mg;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var Bp=et("Opera"),Un=et("Trident")||et("MSIE"),bc=et("Edge"),Oa=bc||Un,Cc=et("Gecko")&&!(Ei().toLowerCase().indexOf("webkit")!=-1&&!et("Edge"))&&!(et("Trident")||et("MSIE"))&&!et("Edge"),Yp=Ei().toLowerCase().indexOf("webkit")!=-1&&!et("Edge");function xc(){var t=M.document;return t?t.documentMode:void 0}var La;e:{var fa="",ma=function(){var t=Ei();if(Cc)return/rv:([^\);]+)(\)|;)/.exec(t);if(bc)return/Edge\/([\d\.]+)/.exec(t);if(Un)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(Yp)return/WebKit\/(\S+)/.exec(t);if(Bp)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(ma&&(fa=ma?ma[1]:""),Un){var pa=xc();if(pa!=null&&pa>parseFloat(fa)){La=String(pa);break e}}La=fa}var Fa;if(M.document&&Un){var hl=xc();Fa=hl||parseInt(La,10)||void 0}else Fa=void 0;var $p=Fa;function kr(t,e){if(Re.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Cc){e:{try{Ao(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:Wp[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&kr.$.h.call(this)}}pe(kr,Re);var Wp={2:"touch",3:"pen",4:"mouse"};kr.prototype.h=function(){kr.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Ii="closure_listenable_"+(1e6*Math.random()|0),qp=0;function zp(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=s,this.key=++qp,this.fa=this.ia=!1}function Ai(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function So(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function Hp(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function Mc(t){const e={};for(const n in t)e[n]=t[n];return e}const dl="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Vc(t,e){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)t[n]=r[n];for(let i=0;i<dl.length;i++)n=dl[i],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Si(t){this.src=t,this.g={},this.h=0}Si.prototype.add=function(t,e,n,r,s){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var a=ja(t,e,r,s);return-1<a?(e=t[a],n||(e.ia=!1)):(e=new zp(e,this.src,i,!!r,s),e.ia=n,t.push(e)),e};function Ua(t,e){var n=e.type;if(n in t.g){var r=t.g[n],s=Pc(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(Ai(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function ja(t,e,n,r){for(var s=0;s<t.length;++s){var i=t[s];if(!i.fa&&i.listener==e&&i.capture==!!n&&i.la==r)return s}return-1}var Ro="closure_lm_"+(1e6*Math.random()|0),ga={};function Nc(t,e,n,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)Nc(t,e[i],n,r,s);return null}return n=Fc(n),t&&t[Ii]?t.O(e,n,Ti(r)?!!r.capture:!!r,s):Gp(t,e,n,!1,r,s)}function Gp(t,e,n,r,s,i){if(!e)throw Error("Invalid event type");var a=Ti(s)?!!s.capture:!!s,o=Do(t);if(o||(t[Ro]=o=new Si(t)),n=o.add(e,n,r,a,i),n.proxy)return n;if(r=Zp(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Up||(s=a),s===void 0&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(Lc(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function Zp(){function t(n){return e.call(t.src,t.listener,n)}const e=Kp;return t}function Oc(t,e,n,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)Oc(t,e[i],n,r,s);else r=Ti(r)?!!r.capture:!!r,n=Fc(n),t&&t[Ii]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=ja(i,n,r,s),-1<n&&(Ai(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=Do(t))&&(e=t.g[e.toString()],t=-1,e&&(t=ja(e,n,r,s)),(n=-1<t?e[t]:null)&&ko(n))}function ko(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Ii])Ua(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Lc(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Do(e))?(Ua(n,t),n.h==0&&(n.src=null,e[Ro]=null)):Ai(t)}}}function Lc(t){return t in ga?ga[t]:ga[t]="on"+t}function Kp(t,e){if(t.fa)t=!0;else{e=new kr(e,this);var n=t.listener,r=t.la||t.src;t.ia&&ko(t),t=n.call(r,e)}return t}function Do(t){return t=t[Ro],t instanceof Si?t:null}var _a="__closure_events_fn_"+(1e9*Math.random()>>>0);function Fc(t){return typeof t=="function"?t:(t[_a]||(t[_a]=function(e){return t.handleEvent(e)}),t[_a])}function me(){Zt.call(this),this.i=new Si(this),this.S=this,this.J=null}pe(me,Zt);me.prototype[Ii]=!0;me.prototype.removeEventListener=function(t,e,n,r){Oc(this,t,e,n,r)};function we(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Re(e,t);else if(e instanceof Re)e.target=e.target||t;else{var s=e;e=new Re(r,t),Vc(e,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var a=e.g=n[i];s=ks(a,r,!0,e)&&s}if(a=e.g=t,s=ks(a,r,!0,e)&&s,s=ks(a,r,!1,e)&&s,n)for(i=0;i<n.length;i++)a=e.g=n[i],s=ks(a,r,!1,e)&&s}me.prototype.N=function(){if(me.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Ai(n[r]);delete t.g[e],t.h--}}this.J=null};me.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};me.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function ks(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var a=e[i];if(a&&!a.fa&&a.capture==n){var o=a.listener,u=a.la||a.src;a.ia&&Ua(t.i,a),s=o.call(u,r)!==!1&&s}}return s&&!r.defaultPrevented}var Po=M.JSON.stringify;class Qp{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function Jp(){var t=bo;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class Xp{constructor(){this.h=this.g=null}add(e,n){const r=Uc.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var Uc=new Qp(()=>new eg,t=>t.reset());class eg{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function tg(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function ng(t){M.setTimeout(()=>{throw t},0)}let Dr,Pr=!1,bo=new Xp,jc=()=>{const t=M.Promise.resolve(void 0);Dr=()=>{t.then(rg)}};var rg=()=>{for(var t;t=Jp();){try{t.h.call(t.g)}catch(n){ng(n)}var e=Uc;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Pr=!1};function Ri(t,e){me.call(this),this.h=t||1,this.g=e||M,this.j=Se(this.qb,this),this.l=Date.now()}pe(Ri,me);y=Ri.prototype;y.ga=!1;y.T=null;y.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),we(this,"tick"),this.ga&&(Co(this),this.start()))}};y.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Co(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}y.N=function(){Ri.$.N.call(this),Co(this),delete this.g};function xo(t,e,n){if(typeof t=="function")n&&(t=Se(t,n));else if(t&&typeof t.handleEvent=="function")t=Se(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:M.setTimeout(t,e||0)}function Bc(t){t.g=xo(()=>{t.g=null,t.i&&(t.i=!1,Bc(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class sg extends Zt{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Bc(this)}N(){super.N(),this.g&&(M.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function br(t){Zt.call(this),this.h=t,this.g={}}pe(br,Zt);var fl=[];function Yc(t,e,n,r){Array.isArray(n)||(n&&(fl[0]=n.toString()),n=fl);for(var s=0;s<n.length;s++){var i=Nc(e,n[s],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function $c(t){So(t.g,function(e,n){this.g.hasOwnProperty(n)&&ko(e)},t),t.g={}}br.prototype.N=function(){br.$.N.call(this),$c(this)};br.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ki(){this.g=!0}ki.prototype.Ea=function(){this.g=!1};function ig(t,e,n,r,s,i){t.info(function(){if(t.g)if(i)for(var a="",o=i.split("&"),u=0;u<o.length;u++){var l=o[u].split("=");if(1<l.length){var c=l[0];l=l[1];var h=c.split("_");a=2<=h.length&&h[1]=="type"?a+(c+"="+l+"&"):a+(c+"=redacted&")}}else a=null;else a=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+n+`
`+a})}function ag(t,e,n,r,s,i,a){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+n+`
`+i+" "+a})}function Dn(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+ug(t,n)+(r?" "+r:"")})}function og(t,e){t.info(function(){return"TIMEOUT: "+e})}ki.prototype.info=function(){};function ug(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var a=1;a<s.length;a++)s[a]=""}}}}return Po(n)}catch{return e}}var pn={},ml=null;function Di(){return ml=ml||new me}pn.Ta="serverreachability";function Wc(t){Re.call(this,pn.Ta,t)}pe(Wc,Re);function Cr(t){const e=Di();we(e,new Wc(e))}pn.STAT_EVENT="statevent";function qc(t,e){Re.call(this,pn.STAT_EVENT,t),this.stat=e}pe(qc,Re);function be(t){const e=Di();we(e,new qc(e,t))}pn.Ua="timingevent";function zc(t,e){Re.call(this,pn.Ua,t),this.size=e}pe(zc,Re);function is(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return M.setTimeout(function(){t()},e)}var Pi={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Hc={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Mo(){}Mo.prototype.h=null;function pl(t){return t.h||(t.h=t.i())}function Gc(){}var as={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Vo(){Re.call(this,"d")}pe(Vo,Re);function No(){Re.call(this,"c")}pe(No,Re);var Ba;function bi(){}pe(bi,Mo);bi.prototype.g=function(){return new XMLHttpRequest};bi.prototype.i=function(){return{}};Ba=new bi;function os(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new br(this),this.P=lg,t=Oa?125:void 0,this.V=new Ri(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Zc}function Zc(){this.i=null,this.g="",this.h=!1}var lg=45e3,Kc={},Ya={};y=os.prototype;y.setTimeout=function(t){this.P=t};function $a(t,e,n){t.L=1,t.A=xi(St(e)),t.u=n,t.S=!0,Qc(t,null)}function Qc(t,e){t.G=Date.now(),us(t),t.B=St(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),ih(n.i,"t",r),t.o=0,n=t.l.J,t.h=new Zc,t.g=Rh(t.l,n?e:null,!t.u),0<t.O&&(t.M=new sg(Se(t.Pa,t,t.g),t.O)),Yc(t.U,t.g,"readystatechange",t.nb),e=t.I?Mc(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Cr(),ig(t.j,t.v,t.B,t.m,t.W,t.u)}y.nb=function(t){t=t.target;const e=this.M;e&&rt(t)==3?e.l():this.Pa(t)};y.Pa=function(t){try{if(t==this.g)e:{const c=rt(this.g);var e=this.g.Ia();const h=this.g.da();if(!(3>c)&&(c!=3||Oa||this.g&&(this.h.h||this.g.ja()||vl(this.g)))){this.J||c!=4||e==7||(e==8||0>=h?Cr(3):Cr(2)),Ci(this);var n=this.g.da();this.ca=n;t:if(Jc(this)){var r=vl(this.g);t="";var s=r.length,i=rt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){en(this),yr(this);var a="";break t}this.h.i=new M.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.length=0,this.h.g+=t,this.o=0,a=this.h.g}else a=this.g.ja();if(this.i=n==200,ag(this.j,this.v,this.B,this.m,this.W,c,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var o,u=this.g;if((o=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Rr(o)){var l=o;break t}}l=null}if(n=l)Dn(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Wa(this,n);else{this.i=!1,this.s=3,be(12),en(this),yr(this);break e}}this.S?(Xc(this,c,a),Oa&&this.i&&c==3&&(Yc(this.U,this.V,"tick",this.mb),this.V.start())):(Dn(this.j,this.m,a,null),Wa(this,a)),c==4&&en(this),this.i&&!this.J&&(c==4?Eh(this.l,this):(this.i=!1,us(this)))}else bg(this.g),n==400&&0<a.indexOf("Unknown SID")?(this.s=3,be(12)):(this.s=0,be(13)),en(this),yr(this)}}}catch{}finally{}};function Jc(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function Xc(t,e,n){let r=!0,s;for(;!t.J&&t.o<n.length;)if(s=cg(t,n),s==Ya){e==4&&(t.s=4,be(14),r=!1),Dn(t.j,t.m,null,"[Incomplete Response]");break}else if(s==Kc){t.s=4,be(15),Dn(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Dn(t.j,t.m,s,null),Wa(t,s);Jc(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,be(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Bo(e),e.M=!0,be(11))):(Dn(t.j,t.m,n,"[Invalid Chunked Response]"),en(t),yr(t))}y.mb=function(){if(this.g){var t=rt(this.g),e=this.g.ja();this.o<e.length&&(Ci(this),Xc(this,t,e),this.i&&t!=4&&us(this))}};function cg(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?Ya:(n=Number(e.substring(n,r)),isNaN(n)?Kc:(r+=1,r+n>e.length?Ya:(e=e.slice(r,r+n),t.o=r+n,e)))}y.cancel=function(){this.J=!0,en(this)};function us(t){t.Y=Date.now()+t.P,eh(t,t.P)}function eh(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=is(Se(t.lb,t),e)}function Ci(t){t.C&&(M.clearTimeout(t.C),t.C=null)}y.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(og(this.j,this.B),this.L!=2&&(Cr(),be(17)),en(this),this.s=2,yr(this)):eh(this,this.Y-t)};function yr(t){t.l.H==0||t.J||Eh(t.l,t)}function en(t){Ci(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,Co(t.V),$c(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Wa(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||qa(n.i,t))){if(!t.K&&qa(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Ks(n),Ni(n);else break e;jo(n),be(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&n.A==0&&!n.v&&(n.v=is(Se(n.ib,n),6e3));if(1>=uh(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else tn(n,11)}else if((t.K||n.g==t)&&Ks(n),!Rr(e))for(s=n.Ja.g.parse(e),e=0;e<s.length;e++){let l=s[e];if(n.V=l[0],l=l[1],n.H==2)if(l[0]=="c"){n.K=l[1],n.pa=l[2];const c=l[3];c!=null&&(n.ra=c,n.l.info("VER="+n.ra));const h=l[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));const d=l[5];d!=null&&typeof d=="number"&&0<d&&(r=1.5*d,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const m=t.g;if(m){const x=m.g?m.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(x){var i=r.i;i.g||x.indexOf("spdy")==-1&&x.indexOf("quic")==-1&&x.indexOf("h2")==-1||(i.j=i.l,i.g=new Set,i.h&&(Oo(i,i.h),i.h=null))}if(r.F){const F=m.g?m.g.getResponseHeader("X-HTTP-Session-Id"):null;F&&(r.Da=F,J(r.I,r.F,F))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var a=t;if(r.wa=Sh(r,r.J?r.pa:null,r.Y),a.K){lh(r.i,a);var o=a,u=r.L;u&&o.setTimeout(u),o.C&&(Ci(o),us(o)),r.g=a}else wh(r);0<n.j.length&&Oi(n)}else l[0]!="stop"&&l[0]!="close"||tn(n,7);else n.H==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?tn(n,7):Uo(n):l[0]!="noop"&&n.h&&n.h.Aa(l),n.A=0)}}Cr(4)}catch{}}function hg(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(wi(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function dg(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(wi(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function th(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(wi(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=dg(t),r=hg(t),s=r.length,i=0;i<s;i++)e.call(void 0,r[i],n&&n[i],t)}var nh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fg(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var i=t[n].substring(0,r);s=t[n].substring(r+1)}else i=t[n];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function sn(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof sn){this.h=t.h,Gs(this,t.j),this.s=t.s,this.g=t.g,Zs(this,t.m),this.l=t.l;var e=t.i,n=new xr;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),gl(this,n),this.o=t.o}else t&&(e=String(t).match(nh))?(this.h=!1,Gs(this,e[1]||"",!0),this.s=hr(e[2]||""),this.g=hr(e[3]||"",!0),Zs(this,e[4]),this.l=hr(e[5]||"",!0),gl(this,e[6]||"",!0),this.o=hr(e[7]||"")):(this.h=!1,this.i=new xr(null,this.h))}sn.prototype.toString=function(){var t=[],e=this.j;e&&t.push(dr(e,_l,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(dr(e,_l,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(dr(n,n.charAt(0)=="/"?gg:pg,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",dr(n,yg)),t.join("")};function St(t){return new sn(t)}function Gs(t,e,n){t.j=n?hr(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Zs(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function gl(t,e,n){e instanceof xr?(t.i=e,vg(t.i,t.h)):(n||(e=dr(e,_g)),t.i=new xr(e,t.h))}function J(t,e,n){t.i.set(e,n)}function xi(t){return J(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function hr(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function dr(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,mg),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function mg(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var _l=/[#\/\?@]/g,pg=/[#\?:]/g,gg=/[#\?]/g,_g=/[#\?@]/g,yg=/#/g;function xr(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Kt(t){t.g||(t.g=new Map,t.h=0,t.i&&fg(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}y=xr.prototype;y.add=function(t,e){Kt(this),this.i=null,t=Qn(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function rh(t,e){Kt(t),e=Qn(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function sh(t,e){return Kt(t),e=Qn(t,e),t.g.has(e)}y.forEach=function(t,e){Kt(this),this.g.forEach(function(n,r){n.forEach(function(s){t.call(e,s,r,this)},this)},this)};y.ta=function(){Kt(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const s=t[r];for(let i=0;i<s.length;i++)n.push(e[r])}return n};y.Z=function(t){Kt(this);let e=[];if(typeof t=="string")sh(this,t)&&(e=e.concat(this.g.get(Qn(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};y.set=function(t,e){return Kt(this),this.i=null,t=Qn(this,t),sh(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};y.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function ih(t,e,n){rh(t,e),0<n.length&&(t.i=null,t.g.set(Qn(t,e),Io(n)),t.h+=n.length)}y.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const i=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var s=i;a[r]!==""&&(s+="="+encodeURIComponent(String(a[r]))),t.push(s)}}return this.i=t.join("&")};function Qn(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function vg(t,e){e&&!t.j&&(Kt(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(rh(this,r),ih(this,s,n))},t)),t.j=e}var wg=class{constructor(t,e){this.g=t,this.map=e}};function ah(t){this.l=t||Tg,M.PerformanceNavigationTiming?(t=M.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(M.g&&M.g.Ka&&M.g.Ka()&&M.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Tg=10;function oh(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function uh(t){return t.h?1:t.g?t.g.size:0}function qa(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Oo(t,e){t.g?t.g.add(e):t.h=e}function lh(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}ah.prototype.cancel=function(){if(this.i=ch(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function ch(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return Io(t.i)}var Eg=class{stringify(t){return M.JSON.stringify(t,void 0)}parse(t){return M.JSON.parse(t,void 0)}};function Ig(){this.g=new Eg}function Ag(t,e,n){const r=n||"";try{th(t,function(s,i){let a=s;Ti(s)&&(a=Po(s)),e.push(r+i+"="+encodeURIComponent(a))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function Sg(t,e){const n=new ki;if(M.Image){const r=new Image;r.onload=Rs(Ds,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Rs(Ds,n,r,"TestLoadImage: error",!1,e),r.onabort=Rs(Ds,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Rs(Ds,n,r,"TestLoadImage: timeout",!1,e),M.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Ds(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function ls(t){this.l=t.ec||null,this.j=t.ob||!1}pe(ls,Mo);ls.prototype.g=function(){return new Mi(this.l,this.j)};ls.prototype.i=function(t){return function(){return t}}({});function Mi(t,e){me.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Lo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}pe(Mi,me);var Lo=0;y=Mi.prototype;y.open=function(t,e){if(this.readyState!=Lo)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Mr(this)};y.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||M).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};y.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,cs(this)),this.readyState=Lo};y.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Mr(this)),this.g&&(this.readyState=3,Mr(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof M.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;hh(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function hh(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}y.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?cs(this):Mr(this),this.readyState==3&&hh(this)}};y.Za=function(t){this.g&&(this.response=this.responseText=t,cs(this))};y.Ya=function(t){this.g&&(this.response=t,cs(this))};y.ka=function(){this.g&&cs(this)};function cs(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Mr(t)}y.setRequestHeader=function(t,e){this.v.append(t,e)};y.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};y.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Mr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Mi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var Rg=M.JSON.parse;function ae(t){me.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=dh,this.L=this.M=!1}pe(ae,me);var dh="",kg=/^https?$/i,Dg=["POST","PUT"];y=ae.prototype;y.Oa=function(t){this.M=t};y.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Ba.g(),this.C=this.u?pl(this.u):pl(Ba),this.g.onreadystatechange=Se(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(i){yl(this,i);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const i of r.keys())n.set(i,r.get(i));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(i=>i.toLowerCase()=="content-type"),s=M.FormData&&t instanceof M.FormData,!(0<=Pc(Dg,e))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,a]of n)this.g.setRequestHeader(i,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{ph(this),0<this.B&&((this.L=Pg(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Se(this.ua,this)):this.A=xo(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){yl(this,i)}};function Pg(t){return Un&&typeof t.timeout=="number"&&t.ontimeout!==void 0}y.ua=function(){typeof Eo<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,we(this,"timeout"),this.abort(8))};function yl(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,fh(t),Vi(t)}function fh(t){t.F||(t.F=!0,we(t,"complete"),we(t,"error"))}y.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,we(this,"complete"),we(this,"abort"),Vi(this))};y.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Vi(this,!0)),ae.$.N.call(this)};y.La=function(){this.s||(this.G||this.v||this.l?mh(this):this.kb())};y.kb=function(){mh(this)};function mh(t){if(t.h&&typeof Eo<"u"&&(!t.C[1]||rt(t)!=4||t.da()!=2)){if(t.v&&rt(t)==4)xo(t.La,0,t);else if(we(t,"readystatechange"),rt(t)==4){t.h=!1;try{const a=t.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var s=String(t.I).match(nh)[1]||null;!s&&M.self&&M.self.location&&(s=M.self.location.protocol.slice(0,-1)),r=!kg.test(s?s.toLowerCase():"")}n=r}if(n)we(t,"complete"),we(t,"success");else{t.m=6;try{var i=2<rt(t)?t.g.statusText:""}catch{i=""}t.j=i+" ["+t.da()+"]",fh(t)}}finally{Vi(t)}}}}function Vi(t,e){if(t.g){ph(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||we(t,"ready");try{n.onreadystatechange=r}catch{}}}function ph(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(M.clearTimeout(t.A),t.A=null)}y.isActive=function(){return!!this.g};function rt(t){return t.g?t.g.readyState:0}y.da=function(){try{return 2<rt(this)?this.g.status:-1}catch{return-1}};y.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};y.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),Rg(e)}};function vl(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case dh:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function bg(t){const e={};t=(t.g&&2<=rt(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Rr(t[r]))continue;var n=tg(t[r]);const s=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const i=e[s]||[];e[s]=i,i.push(n)}Hp(e,function(r){return r.join(", ")})}y.Ia=function(){return this.m};y.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function gh(t){let e="";return So(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function Fo(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=gh(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):J(t,e,n))}function ar(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function _h(t){this.Ga=0,this.j=[],this.l=new ki,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=ar("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=ar("baseRetryDelayMs",5e3,t),this.hb=ar("retryDelaySeedMs",1e4,t),this.eb=ar("forwardChannelMaxRetries",2,t),this.xa=ar("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new ah(t&&t.concurrentRequestLimit),this.Ja=new Ig,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}y=_h.prototype;y.ra=8;y.H=1;function Uo(t){if(yh(t),t.H==3){var e=t.W++,n=St(t.I);if(J(n,"SID",t.K),J(n,"RID",e),J(n,"TYPE","terminate"),hs(t,n),e=new os(t,t.l,e),e.L=2,e.A=xi(St(n)),n=!1,M.navigator&&M.navigator.sendBeacon)try{n=M.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&M.Image&&(new Image().src=e.A,n=!0),n||(e.g=Rh(e.l,null),e.g.ha(e.A)),e.G=Date.now(),us(e)}Ah(t)}function Ni(t){t.g&&(Bo(t),t.g.cancel(),t.g=null)}function yh(t){Ni(t),t.u&&(M.clearTimeout(t.u),t.u=null),Ks(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&M.clearTimeout(t.m),t.m=null)}function Oi(t){if(!oh(t.i)&&!t.m){t.m=!0;var e=t.Na;Dr||jc(),Pr||(Dr(),Pr=!0),bo.add(e,t),t.C=0}}function Cg(t,e){return uh(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=is(Se(t.Na,t,e),Ih(t,t.C)),t.C++,!0)}y.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const s=new os(this,this.l,t);let i=this.s;if(this.U&&(i?(i=Mc(i),Vc(i,this.U)):i=this.U),this.o!==null||this.O||(s.I=i,i=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=vh(this,s,e),n=St(this.I),J(n,"RID",t),J(n,"CVER",22),this.F&&J(n,"X-HTTP-Session-Id",this.F),hs(this,n),i&&(this.O?e="headers="+encodeURIComponent(String(gh(i)))+"&"+e:this.o&&Fo(n,this.o,i)),Oo(this.i,s),this.bb&&J(n,"TYPE","init"),this.P?(J(n,"$req",e),J(n,"SID","null"),s.aa=!0,$a(s,n,null)):$a(s,n,e),this.H=2}}else this.H==3&&(t?wl(this,t):this.j.length==0||oh(this.i)||wl(this))};function wl(t,e){var n;e?n=e.m:n=t.W++;const r=St(t.I);J(r,"SID",t.K),J(r,"RID",n),J(r,"AID",t.V),hs(t,r),t.o&&t.s&&Fo(r,t.o,t.s),n=new os(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=vh(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Oo(t.i,n),$a(n,r,e)}function hs(t,e){t.na&&So(t.na,function(n,r){J(e,r,n)}),t.h&&th({},function(n,r){J(e,r,n)})}function vh(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Se(t.h.Va,t.h,t):null;e:{var s=t.j;let i=-1;for(;;){const a=["count="+n];i==-1?0<n?(i=s[0].g,a.push("ofs="+i)):i=0:a.push("ofs="+i);let o=!0;for(let u=0;u<n;u++){let l=s[u].g;const c=s[u].map;if(l-=i,0>l)i=Math.max(0,s[u].g-100),o=!1;else try{Ag(c,a,"req"+l+"_")}catch{r&&r(c)}}if(o){r=a.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function wh(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Dr||jc(),Pr||(Dr(),Pr=!0),bo.add(e,t),t.A=0}}function jo(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=is(Se(t.Ma,t),Ih(t,t.A)),t.A++,!0)}y.Ma=function(){if(this.u=null,Th(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=is(Se(this.jb,this),t)}};y.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,be(10),Ni(this),Th(this))};function Bo(t){t.B!=null&&(M.clearTimeout(t.B),t.B=null)}function Th(t){t.g=new os(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=St(t.wa);J(e,"RID","rpc"),J(e,"SID",t.K),J(e,"AID",t.V),J(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&J(e,"TO",t.qa),J(e,"TYPE","xmlhttp"),hs(t,e),t.o&&t.s&&Fo(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=xi(St(e)),n.u=null,n.S=!0,Qc(n,t)}y.ib=function(){this.v!=null&&(this.v=null,Ni(this),jo(this),be(19))};function Ks(t){t.v!=null&&(M.clearTimeout(t.v),t.v=null)}function Eh(t,e){var n=null;if(t.g==e){Ks(t),Bo(t),t.g=null;var r=2}else if(qa(t.i,e))n=e.F,lh(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var s=t.C;r=Di(),we(r,new zc(r,n)),Oi(t)}else wh(t);else if(s=e.s,s==3||s==0&&0<e.ca||!(r==1&&Cg(t,e)||r==2&&jo(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:tn(t,5);break;case 4:tn(t,10);break;case 3:tn(t,6);break;default:tn(t,2)}}}function Ih(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function tn(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Se(t.pb,t);n||(n=new sn("//www.google.com/images/cleardot.gif"),M.location&&M.location.protocol=="http"||Gs(n,"https"),xi(n)),Sg(n.toString(),r)}else be(2);t.H=0,t.h&&t.h.za(e),Ah(t),yh(t)}y.pb=function(t){t?(this.l.info("Successfully pinged google.com"),be(2)):(this.l.info("Failed to ping google.com"),be(1))};function Ah(t){if(t.H=0,t.ma=[],t.h){const e=ch(t.i);(e.length!=0||t.j.length!=0)&&(cl(t.ma,e),cl(t.ma,t.j),t.i.i.length=0,Io(t.j),t.j.length=0),t.h.ya()}}function Sh(t,e,n){var r=n instanceof sn?St(n):new sn(n);if(r.g!="")e&&(r.g=e+"."+r.g),Zs(r,r.m);else{var s=M.location;r=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var i=new sn(null);r&&Gs(i,r),e&&(i.g=e),s&&Zs(i,s),n&&(i.l=n),r=i}return n=t.F,e=t.Da,n&&e&&J(r,n,e),J(r,"VER",t.ra),hs(t,r),r}function Rh(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new ae(new ls({ob:n})):new ae(t.va),e.Oa(t.J),e}y.isActive=function(){return!!this.h&&this.h.isActive(this)};function kh(){}y=kh.prototype;y.Ba=function(){};y.Aa=function(){};y.za=function(){};y.ya=function(){};y.isActive=function(){return!0};y.Va=function(){};function Qs(){if(Un&&!(10<=Number($p)))throw Error("Environmental error: no available transport.")}Qs.prototype.g=function(t,e){return new Fe(t,e)};function Fe(t,e){me.call(this),this.g=new _h(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Rr(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Rr(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Jn(this)}pe(Fe,me);Fe.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;be(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=Sh(t,null,t.Y),Oi(t)};Fe.prototype.close=function(){Uo(this.g)};Fe.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=Po(t),t=n);e.j.push(new wg(e.fb++,t)),e.H==3&&Oi(e)};Fe.prototype.N=function(){this.g.h=null,delete this.j,Uo(this.g),delete this.g,Fe.$.N.call(this)};function Dh(t){Vo.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}pe(Dh,Vo);function Ph(){No.call(this),this.status=1}pe(Ph,No);function Jn(t){this.g=t}pe(Jn,kh);Jn.prototype.Ba=function(){we(this.g,"a")};Jn.prototype.Aa=function(t){we(this.g,new Dh(t))};Jn.prototype.za=function(t){we(this.g,new Ph)};Jn.prototype.ya=function(){we(this.g,"b")};function xg(){this.blockSize=-1}function Ge(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}pe(Ge,xg);Ge.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function ya(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var s=0;16>s;++s)r[s]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],s=t.g[2];var i=t.g[3],a=e+(i^n&(s^i))+r[0]+3614090360&4294967295;e=n+(a<<7&4294967295|a>>>25),a=i+(s^e&(n^s))+r[1]+3905402710&4294967295,i=e+(a<<12&4294967295|a>>>20),a=s+(n^i&(e^n))+r[2]+606105819&4294967295,s=i+(a<<17&4294967295|a>>>15),a=n+(e^s&(i^e))+r[3]+3250441966&4294967295,n=s+(a<<22&4294967295|a>>>10),a=e+(i^n&(s^i))+r[4]+4118548399&4294967295,e=n+(a<<7&4294967295|a>>>25),a=i+(s^e&(n^s))+r[5]+1200080426&4294967295,i=e+(a<<12&4294967295|a>>>20),a=s+(n^i&(e^n))+r[6]+2821735955&4294967295,s=i+(a<<17&4294967295|a>>>15),a=n+(e^s&(i^e))+r[7]+4249261313&4294967295,n=s+(a<<22&4294967295|a>>>10),a=e+(i^n&(s^i))+r[8]+1770035416&4294967295,e=n+(a<<7&4294967295|a>>>25),a=i+(s^e&(n^s))+r[9]+2336552879&4294967295,i=e+(a<<12&4294967295|a>>>20),a=s+(n^i&(e^n))+r[10]+4294925233&4294967295,s=i+(a<<17&4294967295|a>>>15),a=n+(e^s&(i^e))+r[11]+2304563134&4294967295,n=s+(a<<22&4294967295|a>>>10),a=e+(i^n&(s^i))+r[12]+1804603682&4294967295,e=n+(a<<7&4294967295|a>>>25),a=i+(s^e&(n^s))+r[13]+4254626195&4294967295,i=e+(a<<12&4294967295|a>>>20),a=s+(n^i&(e^n))+r[14]+2792965006&4294967295,s=i+(a<<17&4294967295|a>>>15),a=n+(e^s&(i^e))+r[15]+1236535329&4294967295,n=s+(a<<22&4294967295|a>>>10),a=e+(s^i&(n^s))+r[1]+4129170786&4294967295,e=n+(a<<5&4294967295|a>>>27),a=i+(n^s&(e^n))+r[6]+3225465664&4294967295,i=e+(a<<9&4294967295|a>>>23),a=s+(e^n&(i^e))+r[11]+643717713&4294967295,s=i+(a<<14&4294967295|a>>>18),a=n+(i^e&(s^i))+r[0]+3921069994&4294967295,n=s+(a<<20&4294967295|a>>>12),a=e+(s^i&(n^s))+r[5]+3593408605&4294967295,e=n+(a<<5&4294967295|a>>>27),a=i+(n^s&(e^n))+r[10]+38016083&4294967295,i=e+(a<<9&4294967295|a>>>23),a=s+(e^n&(i^e))+r[15]+3634488961&4294967295,s=i+(a<<14&4294967295|a>>>18),a=n+(i^e&(s^i))+r[4]+3889429448&4294967295,n=s+(a<<20&4294967295|a>>>12),a=e+(s^i&(n^s))+r[9]+568446438&4294967295,e=n+(a<<5&4294967295|a>>>27),a=i+(n^s&(e^n))+r[14]+3275163606&4294967295,i=e+(a<<9&4294967295|a>>>23),a=s+(e^n&(i^e))+r[3]+4107603335&4294967295,s=i+(a<<14&4294967295|a>>>18),a=n+(i^e&(s^i))+r[8]+1163531501&4294967295,n=s+(a<<20&4294967295|a>>>12),a=e+(s^i&(n^s))+r[13]+2850285829&4294967295,e=n+(a<<5&4294967295|a>>>27),a=i+(n^s&(e^n))+r[2]+4243563512&4294967295,i=e+(a<<9&4294967295|a>>>23),a=s+(e^n&(i^e))+r[7]+1735328473&4294967295,s=i+(a<<14&4294967295|a>>>18),a=n+(i^e&(s^i))+r[12]+2368359562&4294967295,n=s+(a<<20&4294967295|a>>>12),a=e+(n^s^i)+r[5]+4294588738&4294967295,e=n+(a<<4&4294967295|a>>>28),a=i+(e^n^s)+r[8]+2272392833&4294967295,i=e+(a<<11&4294967295|a>>>21),a=s+(i^e^n)+r[11]+1839030562&4294967295,s=i+(a<<16&4294967295|a>>>16),a=n+(s^i^e)+r[14]+4259657740&4294967295,n=s+(a<<23&4294967295|a>>>9),a=e+(n^s^i)+r[1]+2763975236&4294967295,e=n+(a<<4&4294967295|a>>>28),a=i+(e^n^s)+r[4]+1272893353&4294967295,i=e+(a<<11&4294967295|a>>>21),a=s+(i^e^n)+r[7]+4139469664&4294967295,s=i+(a<<16&4294967295|a>>>16),a=n+(s^i^e)+r[10]+3200236656&4294967295,n=s+(a<<23&4294967295|a>>>9),a=e+(n^s^i)+r[13]+681279174&4294967295,e=n+(a<<4&4294967295|a>>>28),a=i+(e^n^s)+r[0]+3936430074&4294967295,i=e+(a<<11&4294967295|a>>>21),a=s+(i^e^n)+r[3]+3572445317&4294967295,s=i+(a<<16&4294967295|a>>>16),a=n+(s^i^e)+r[6]+76029189&4294967295,n=s+(a<<23&4294967295|a>>>9),a=e+(n^s^i)+r[9]+3654602809&4294967295,e=n+(a<<4&4294967295|a>>>28),a=i+(e^n^s)+r[12]+3873151461&4294967295,i=e+(a<<11&4294967295|a>>>21),a=s+(i^e^n)+r[15]+530742520&4294967295,s=i+(a<<16&4294967295|a>>>16),a=n+(s^i^e)+r[2]+3299628645&4294967295,n=s+(a<<23&4294967295|a>>>9),a=e+(s^(n|~i))+r[0]+4096336452&4294967295,e=n+(a<<6&4294967295|a>>>26),a=i+(n^(e|~s))+r[7]+1126891415&4294967295,i=e+(a<<10&4294967295|a>>>22),a=s+(e^(i|~n))+r[14]+2878612391&4294967295,s=i+(a<<15&4294967295|a>>>17),a=n+(i^(s|~e))+r[5]+4237533241&4294967295,n=s+(a<<21&4294967295|a>>>11),a=e+(s^(n|~i))+r[12]+1700485571&4294967295,e=n+(a<<6&4294967295|a>>>26),a=i+(n^(e|~s))+r[3]+2399980690&4294967295,i=e+(a<<10&4294967295|a>>>22),a=s+(e^(i|~n))+r[10]+4293915773&4294967295,s=i+(a<<15&4294967295|a>>>17),a=n+(i^(s|~e))+r[1]+2240044497&4294967295,n=s+(a<<21&4294967295|a>>>11),a=e+(s^(n|~i))+r[8]+1873313359&4294967295,e=n+(a<<6&4294967295|a>>>26),a=i+(n^(e|~s))+r[15]+4264355552&4294967295,i=e+(a<<10&4294967295|a>>>22),a=s+(e^(i|~n))+r[6]+2734768916&4294967295,s=i+(a<<15&4294967295|a>>>17),a=n+(i^(s|~e))+r[13]+1309151649&4294967295,n=s+(a<<21&4294967295|a>>>11),a=e+(s^(n|~i))+r[4]+4149444226&4294967295,e=n+(a<<6&4294967295|a>>>26),a=i+(n^(e|~s))+r[11]+3174756917&4294967295,i=e+(a<<10&4294967295|a>>>22),a=s+(e^(i|~n))+r[2]+718787259&4294967295,s=i+(a<<15&4294967295|a>>>17),a=n+(i^(s|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(s+(a<<21&4294967295|a>>>11))&4294967295,t.g[2]=t.g[2]+s&4294967295,t.g[3]=t.g[3]+i&4294967295}Ge.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,s=this.h,i=0;i<e;){if(s==0)for(;i<=n;)ya(this,t,i),i+=this.blockSize;if(typeof t=="string"){for(;i<e;)if(r[s++]=t.charCodeAt(i++),s==this.blockSize){ya(this,r),s=0;break}}else for(;i<e;)if(r[s++]=t[i++],s==this.blockSize){ya(this,r),s=0;break}}this.h=s,this.i+=e};Ge.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Z(t,e){this.h=e;for(var n=[],r=!0,s=t.length-1;0<=s;s--){var i=t[s]|0;r&&i==e||(n[s]=i,r=!1)}this.g=n}var Mg={};function Yo(t){return-128<=t&&128>t?jp(t,function(e){return new Z([e|0],0>e?-1:0)}):new Z([t|0],0>t?-1:0)}function st(t){if(isNaN(t)||!isFinite(t))return xn;if(0>t)return ye(st(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=za;return new Z(e,0)}function bh(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return ye(bh(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=st(Math.pow(e,8)),r=xn,s=0;s<t.length;s+=8){var i=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+i),e);8>i?(i=st(Math.pow(e,i)),r=r.R(i).add(st(a))):(r=r.R(n),r=r.add(st(a)))}return r}var za=4294967296,xn=Yo(0),Ha=Yo(1),Tl=Yo(16777216);y=Z.prototype;y.ea=function(){if(Be(this))return-ye(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:za+r)*e,e*=za}return t};y.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(wt(this))return"0";if(Be(this))return"-"+ye(this).toString(t);for(var e=st(Math.pow(t,6)),n=this,r="";;){var s=Xs(n,e).g;n=Js(n,s.R(e));var i=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=s,wt(n))return i+r;for(;6>i.length;)i="0"+i;r=i+r}};y.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function wt(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Be(t){return t.h==-1}y.X=function(t){return t=Js(this,t),Be(t)?-1:wt(t)?0:1};function ye(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Z(n,~t.h).add(Ha)}y.abs=function(){return Be(this)?ye(this):this};y.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,s=0;s<=e;s++){var i=r+(this.D(s)&65535)+(t.D(s)&65535),a=(i>>>16)+(this.D(s)>>>16)+(t.D(s)>>>16);r=a>>>16,i&=65535,a&=65535,n[s]=a<<16|i}return new Z(n,n[n.length-1]&-2147483648?-1:0)};function Js(t,e){return t.add(ye(e))}y.R=function(t){if(wt(this)||wt(t))return xn;if(Be(this))return Be(t)?ye(this).R(ye(t)):ye(ye(this).R(t));if(Be(t))return ye(this.R(ye(t)));if(0>this.X(Tl)&&0>t.X(Tl))return st(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<t.g.length;s++){var i=this.D(r)>>>16,a=this.D(r)&65535,o=t.D(s)>>>16,u=t.D(s)&65535;n[2*r+2*s]+=a*u,Ps(n,2*r+2*s),n[2*r+2*s+1]+=i*u,Ps(n,2*r+2*s+1),n[2*r+2*s+1]+=a*o,Ps(n,2*r+2*s+1),n[2*r+2*s+2]+=i*o,Ps(n,2*r+2*s+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Z(n,0)};function Ps(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function or(t,e){this.g=t,this.h=e}function Xs(t,e){if(wt(e))throw Error("division by zero");if(wt(t))return new or(xn,xn);if(Be(t))return e=Xs(ye(t),e),new or(ye(e.g),ye(e.h));if(Be(e))return e=Xs(t,ye(e)),new or(ye(e.g),e.h);if(30<t.g.length){if(Be(t)||Be(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Ha,r=e;0>=r.X(t);)n=El(n),r=El(r);var s=Tn(n,1),i=Tn(r,1);for(r=Tn(r,2),n=Tn(n,2);!wt(r);){var a=i.add(r);0>=a.X(t)&&(s=s.add(n),i=a),r=Tn(r,1),n=Tn(n,1)}return e=Js(t,s.R(e)),new or(s,e)}for(s=xn;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),i=st(n),a=i.R(e);Be(a)||0<a.X(t);)n-=r,i=st(n),a=i.R(e);wt(i)&&(i=Ha),s=s.add(i),t=Js(t,a)}return new or(s,t)}y.gb=function(t){return Xs(this,t).h};y.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Z(n,this.h&t.h)};y.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Z(n,this.h|t.h)};y.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Z(n,this.h^t.h)};function El(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Z(n,t.h)}function Tn(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,s=[],i=0;i<r;i++)s[i]=0<e?t.D(i+n)>>>e|t.D(i+n+1)<<32-e:t.D(i+n);return new Z(s,t.h)}Qs.prototype.createWebChannel=Qs.prototype.g;Fe.prototype.send=Fe.prototype.u;Fe.prototype.open=Fe.prototype.m;Fe.prototype.close=Fe.prototype.close;Pi.NO_ERROR=0;Pi.TIMEOUT=8;Pi.HTTP_ERROR=6;Hc.COMPLETE="complete";Gc.EventType=as;as.OPEN="a";as.CLOSE="b";as.ERROR="c";as.MESSAGE="d";me.prototype.listen=me.prototype.O;ae.prototype.listenOnce=ae.prototype.P;ae.prototype.getLastError=ae.prototype.Sa;ae.prototype.getLastErrorCode=ae.prototype.Ia;ae.prototype.getStatus=ae.prototype.da;ae.prototype.getResponseJson=ae.prototype.Wa;ae.prototype.getResponseText=ae.prototype.ja;ae.prototype.send=ae.prototype.ha;ae.prototype.setWithCredentials=ae.prototype.Oa;Ge.prototype.digest=Ge.prototype.l;Ge.prototype.reset=Ge.prototype.reset;Ge.prototype.update=Ge.prototype.j;Z.prototype.add=Z.prototype.add;Z.prototype.multiply=Z.prototype.R;Z.prototype.modulo=Z.prototype.gb;Z.prototype.compare=Z.prototype.X;Z.prototype.toNumber=Z.prototype.ea;Z.prototype.toString=Z.prototype.toString;Z.prototype.getBits=Z.prototype.D;Z.fromNumber=st;Z.fromString=bh;var Vg=function(){return new Qs},Ng=function(){return Di()},va=Pi,Og=Hc,Lg=pn,Il={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Fg=ls,bs=Gc,Ug=ae,jg=Ge,Mn=Z;const Al="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ie.UNAUTHENTICATED=new Ie(null),Ie.GOOGLE_CREDENTIALS=new Ie("google-credentials-uid"),Ie.FIRST_PARTY=new Ie("first-party-uid"),Ie.MOCK_USER=new Ie("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xn="10.11.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ln=new Ic("@firebase/firestore");function ur(){return ln.logLevel}function A(t,...e){if(ln.logLevel<=q.DEBUG){const n=e.map($o);ln.debug(`Firestore (${Xn}): ${t}`,...n)}}function Rt(t,...e){if(ln.logLevel<=q.ERROR){const n=e.map($o);ln.error(`Firestore (${Xn}): ${t}`,...n)}}function jn(t,...e){if(ln.logLevel<=q.WARN){const n=e.map($o);ln.warn(`Firestore (${Xn}): ${t}`,...n)}}function $o(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C(t="Unexpected state"){const e=`FIRESTORE (${Xn}) INTERNAL ASSERTION FAILED: `+t;throw Rt(e),new Error(e)}function Q(t,e){t||C()}function N(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class I extends Kn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Bg{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ie.UNAUTHENTICATED))}shutdown(){}}class Yg{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class $g{constructor(e){this.t=e,this.currentUser=Ie.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Ut;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ut,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},o=u=>{A("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(u=>o(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?o(u):(A("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ut)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(A("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Q(typeof r.accessToken=="string"),new Ch(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Q(e===null||typeof e=="string"),new Ie(e)}}class Wg{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Ie.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class qg{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new Wg(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ie.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class zg{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Hg{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=i=>{i.error!=null&&A("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,A("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{A("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):A("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Q(typeof n.token=="string"),this.R=n.token,new zg(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gg(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=Gg(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function G(t,e){return t<e?-1:t>e?1:0}function Bn(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new I(f.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new I(f.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new I(f.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new I(f.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return he.fromMillis(Date.now())}static fromDate(e){return he.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new he(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?G(this.nanoseconds,e.nanoseconds):G(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(e){this.timestamp=e}static fromTimestamp(e){return new V(e)}static min(){return new V(new he(0,0))}static max(){return new V(new he(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e,n,r){n===void 0?n=0:n>e.length&&C(),r===void 0?r=e.length-n:r>e.length-n&&C(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Vr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Vr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class X extends Vr{construct(e,n,r){return new X(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new I(f.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new X(n)}static emptyPath(){return new X([])}}const Zg=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ve extends Vr{construct(e,n,r){return new ve(e,n,r)}static isValidIdentifier(e){return Zg.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ve.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ve(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new I(f.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new I(f.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new I(f.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else o==="`"?(a=!a,s++):o!=="."||a?(r+=o,s++):(i(),s++)}if(i(),a)throw new I(f.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ve(n)}static emptyPath(){return new ve([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k{constructor(e){this.path=e}static fromPath(e){return new k(X.fromString(e))}static fromName(e){return new k(X.fromString(e).popFirst(5))}static empty(){return new k(X.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&X.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return X.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new k(new X(e.slice()))}}function Kg(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=V.fromTimestamp(r===1e9?new he(n+1,0):new he(n,r));return new Yt(s,k.empty(),e)}function Qg(t){return new Yt(t.readTime,t.key,-1)}class Yt{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Yt(V.min(),k.empty(),-1)}static max(){return new Yt(V.max(),k.empty(),-1)}}function Jg(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=k.comparator(t.documentKey,e.documentKey),n!==0?n:G(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xg="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class e_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ds(t){if(t.code!==f.FAILED_PRECONDITION||t.message!==Xg)throw t;A("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&C(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new p((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof p?n:p.resolve(n)}catch(n){return p.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):p.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):p.reject(n)}static resolve(e){return new p((n,r)=>{n(e)})}static reject(e){return new p((n,r)=>{r(e)})}static waitFor(e){return new p((n,r)=>{let s=0,i=0,a=!1;e.forEach(o=>{++s,o.next(()=>{++i,a&&i===s&&n()},u=>r(u))}),a=!0,i===s&&n()})}static or(e){let n=p.resolve(!1);for(const r of e)n=n.next(s=>s?p.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new p((r,s)=>{const i=e.length,a=new Array(i);let o=0;for(let u=0;u<i;u++){const l=u;n(e[l]).next(c=>{a[l]=c,++o,o===i&&r(a)},c=>s(c))}})}static doWhile(e,n){return new p((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function t_(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function fs(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Wo.oe=-1;function Li(t){return t==null}function ei(t){return t===0&&1/t==-1/0}function n_(t){return typeof t=="number"&&Number.isInteger(t)&&!ei(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sl(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function gn(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Mh(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e,n){this.comparator=e,this.root=n||_e.EMPTY}insert(e,n){return new ie(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,_e.BLACK,null,null))}remove(e){return new ie(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_e.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cs(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cs(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cs(this.root,e,this.comparator,!0)}}class Cs{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _e{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??_e.RED,this.left=s??_e.EMPTY,this.right=i??_e.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new _e(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return _e.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return _e.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_e.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw C();const e=this.left.check();if(e!==this.right.check())throw C();return e+(this.isRed()?0:1)}}_e.EMPTY=null,_e.RED=!0,_e.BLACK=!1;_e.EMPTY=new class{constructor(){this.size=0}get key(){throw C()}get value(){throw C()}get color(){throw C()}get left(){throw C()}get right(){throw C()}copy(e,n,r,s,i){return this}insert(e,n,r){return new _e(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.comparator=e,this.data=new ie(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Rl(this.data.getIterator())}getIteratorFrom(e){return new Rl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Te)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Te(this.comparator);return n.data=e,n}}class Rl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(e){this.fields=e,e.sort(ve.comparator)}static empty(){return new Oe([])}unionWith(e){let n=new Te(ve.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Oe(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Bn(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Vh("Invalid base64 string: "+i):i}}(e);return new De(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new De(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return G(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}De.EMPTY_BYTE_STRING=new De("");const r_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $t(t){if(Q(!!t),typeof t=="string"){let e=0;const n=r_.exec(t);if(Q(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:le(t.seconds),nanos:le(t.nanos)}}function le(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function cn(t){return typeof t=="string"?De.fromBase64String(t):De.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qo(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function zo(t){const e=t.mapValue.fields.__previous_value__;return qo(e)?zo(e):e}function Nr(t){const e=$t(t.mapValue.fields.__local_write_time__.timestampValue);return new he(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(e,n,r,s,i,a,o,u,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=u,this.useFetchStreams=l}}class Or{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Or("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Or&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function hn(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?qo(t)?4:i_(t)?9007199254740991:10:C()}function ct(t,e){if(t===e)return!0;const n=hn(t);if(n!==hn(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Nr(t).isEqual(Nr(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=$t(s.timestampValue),o=$t(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return cn(s.bytesValue).isEqual(cn(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return le(s.geoPointValue.latitude)===le(i.geoPointValue.latitude)&&le(s.geoPointValue.longitude)===le(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return le(s.integerValue)===le(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=le(s.doubleValue),o=le(i.doubleValue);return a===o?ei(a)===ei(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return Bn(t.arrayValue.values||[],e.arrayValue.values||[],ct);case 10:return function(s,i){const a=s.mapValue.fields||{},o=i.mapValue.fields||{};if(Sl(a)!==Sl(o))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(o[u]===void 0||!ct(a[u],o[u])))return!1;return!0}(t,e);default:return C()}}function Lr(t,e){return(t.values||[]).find(n=>ct(n,e))!==void 0}function Yn(t,e){if(t===e)return 0;const n=hn(t),r=hn(e);if(n!==r)return G(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return G(t.booleanValue,e.booleanValue);case 2:return function(i,a){const o=le(i.integerValue||i.doubleValue),u=le(a.integerValue||a.doubleValue);return o<u?-1:o>u?1:o===u?0:isNaN(o)?isNaN(u)?0:-1:1}(t,e);case 3:return kl(t.timestampValue,e.timestampValue);case 4:return kl(Nr(t),Nr(e));case 5:return G(t.stringValue,e.stringValue);case 6:return function(i,a){const o=cn(i),u=cn(a);return o.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const o=i.split("/"),u=a.split("/");for(let l=0;l<o.length&&l<u.length;l++){const c=G(o[l],u[l]);if(c!==0)return c}return G(o.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const o=G(le(i.latitude),le(a.latitude));return o!==0?o:G(le(i.longitude),le(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(i,a){const o=i.values||[],u=a.values||[];for(let l=0;l<o.length&&l<u.length;++l){const c=Yn(o[l],u[l]);if(c)return c}return G(o.length,u.length)}(t.arrayValue,e.arrayValue);case 10:return function(i,a){if(i===xs.mapValue&&a===xs.mapValue)return 0;if(i===xs.mapValue)return 1;if(a===xs.mapValue)return-1;const o=i.fields||{},u=Object.keys(o),l=a.fields||{},c=Object.keys(l);u.sort(),c.sort();for(let h=0;h<u.length&&h<c.length;++h){const d=G(u[h],c[h]);if(d!==0)return d;const m=Yn(o[u[h]],l[c[h]]);if(m!==0)return m}return G(u.length,c.length)}(t.mapValue,e.mapValue);default:throw C()}}function kl(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return G(t,e);const n=$t(t),r=$t(e),s=G(n.seconds,r.seconds);return s!==0?s:G(n.nanos,r.nanos)}function $n(t){return Ga(t)}function Ga(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=$t(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return cn(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return k.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Ga(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Ga(n.fields[a])}`;return s+"}"}(t.mapValue):C()}function Dl(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Za(t){return!!t&&"integerValue"in t}function Ho(t){return!!t&&"arrayValue"in t}function Pl(t){return!!t&&"nullValue"in t}function bl(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Os(t){return!!t&&"mapValue"in t}function vr(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return gn(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=vr(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=vr(t.arrayValue.values[n]);return e}return Object.assign({},t)}function i_(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Me{constructor(e){this.value=e}static empty(){return new Me({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Os(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=vr(n)}setAll(e){let n=ve.emptyPath(),r={},s=[];e.forEach((a,o)=>{if(!n.isImmediateParentOf(o)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=o.popLast()}a?r[o.lastSegment()]=vr(a):s.push(o.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Os(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ct(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Os(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){gn(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Me(vr(this.value))}}function Nh(t){const e=[];return gn(t.fields,(n,r)=>{const s=new ve([n]);if(Os(r)){const i=Nh(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new Oe(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e,n,r,s,i,a,o){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Ae(e,0,V.min(),V.min(),V.min(),Me.empty(),0)}static newFoundDocument(e,n,r,s){return new Ae(e,1,n,V.min(),r,s,0)}static newNoDocument(e,n){return new Ae(e,2,n,V.min(),V.min(),Me.empty(),0)}static newUnknownDocument(e,n){return new Ae(e,3,n,V.min(),V.min(),Me.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(V.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Me.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Me.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=V.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ae&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ae(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e,n){this.position=e,this.inclusive=n}}function Cl(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=k.comparator(k.fromName(a.referenceValue),n.key):r=Yn(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function xl(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ct(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e,n="asc"){this.field=e,this.dir=n}}function a_(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{}class ce extends Oh{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new u_(e,n,r):n==="array-contains"?new h_(e,r):n==="in"?new d_(e,r):n==="not-in"?new f_(e,r):n==="array-contains-any"?new m_(e,r):new ce(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new l_(e,r):new c_(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Yn(n,this.value)):n!==null&&hn(this.value)===hn(n)&&this.matchesComparison(Yn(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return C()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ze extends Oh{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Ze(e,n)}matches(e){return Lh(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Lh(t){return t.op==="and"}function Fh(t){return o_(t)&&Lh(t)}function o_(t){for(const e of t.filters)if(e instanceof Ze)return!1;return!0}function Ka(t){if(t instanceof ce)return t.field.canonicalString()+t.op.toString()+$n(t.value);if(Fh(t))return t.filters.map(e=>Ka(e)).join(",");{const e=t.filters.map(n=>Ka(n)).join(",");return`${t.op}(${e})`}}function Uh(t,e){return t instanceof ce?function(r,s){return s instanceof ce&&r.op===s.op&&r.field.isEqual(s.field)&&ct(r.value,s.value)}(t,e):t instanceof Ze?function(r,s){return s instanceof Ze&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,o)=>i&&Uh(a,s.filters[o]),!0):!1}(t,e):void C()}function jh(t){return t instanceof ce?function(n){return`${n.field.canonicalString()} ${n.op} ${$n(n.value)}`}(t):t instanceof Ze?function(n){return n.op.toString()+" {"+n.getFilters().map(jh).join(" ,")+"}"}(t):"Filter"}class u_ extends ce{constructor(e,n,r){super(e,n,r),this.key=k.fromName(r.referenceValue)}matches(e){const n=k.comparator(e.key,this.key);return this.matchesComparison(n)}}class l_ extends ce{constructor(e,n){super(e,"in",n),this.keys=Bh("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class c_ extends ce{constructor(e,n){super(e,"not-in",n),this.keys=Bh("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Bh(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>k.fromName(r.referenceValue))}class h_ extends ce{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Ho(n)&&Lr(n.arrayValue,this.value)}}class d_ extends ce{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Lr(this.value.arrayValue,n)}}class f_ extends ce{constructor(e,n){super(e,"not-in",n)}matches(e){if(Lr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Lr(this.value.arrayValue,n)}}class m_ extends ce{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Ho(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Lr(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(e,n=null,r=[],s=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=o,this.ue=null}}function Ml(t,e=null,n=[],r=[],s=null,i=null,a=null){return new p_(t,e,n,r,s,i,a)}function Go(t){const e=N(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Ka(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Li(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>$n(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>$n(r)).join(",")),e.ue=n}return e.ue}function Zo(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!a_(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Uh(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!xl(t.startAt,e.startAt)&&xl(t.endAt,e.endAt)}function Qa(t){return k.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e,n=null,r=[],s=[],i=null,a="F",o=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function g_(t,e,n,r,s,i,a,o){return new er(t,e,n,r,s,i,a,o)}function Ko(t){return new er(t)}function Vl(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Yh(t){return t.collectionGroup!==null}function wr(t){const e=N(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Te(ve.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(o=o.add(l.field))})}),o})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Fr(i,r))}),n.has(ve.keyField().canonicalString())||e.ce.push(new Fr(ve.keyField(),r))}return e.ce}function it(t){const e=N(t);return e.le||(e.le=__(e,wr(t))),e.le}function __(t,e){if(t.limitType==="F")return Ml(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Fr(s.field,i)});const n=t.endAt?new ti(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ti(t.startAt.position,t.startAt.inclusive):null;return Ml(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Ja(t,e){const n=t.filters.concat([e]);return new er(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function ni(t,e,n){return new er(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Fi(t,e){return Zo(it(t),it(e))&&t.limitType===e.limitType}function $h(t){return`${Go(it(t))}|lt:${t.limitType}`}function In(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>jh(s)).join(", ")}]`),Li(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>$n(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>$n(s)).join(",")),`Target(${r})`}(it(t))}; limitType=${t.limitType})`}function Ui(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):k.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of wr(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,o,u){const l=Cl(a,o,u);return a.inclusive?l<=0:l<0}(r.startAt,wr(r),s)||r.endAt&&!function(a,o,u){const l=Cl(a,o,u);return a.inclusive?l>=0:l>0}(r.endAt,wr(r),s))}(t,e)}function y_(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Wh(t){return(e,n)=>{let r=!1;for(const s of wr(t)){const i=v_(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function v_(t,e,n){const r=t.field.isKeyField()?k.comparator(e.key,n.key):function(i,a,o){const u=a.data.field(i),l=o.data.field(i);return u!==null&&l!==null?Yn(u,l):C()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return C()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){gn(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Mh(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w_=new ie(k.comparator);function kt(){return w_}const qh=new ie(k.comparator);function fr(...t){let e=qh;for(const n of t)e=e.insert(n.key,n);return e}function zh(t){let e=qh;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function nn(){return Tr()}function Hh(){return Tr()}function Tr(){return new tr(t=>t.toString(),(t,e)=>t.isEqual(e))}const T_=new ie(k.comparator),E_=new Te(k.comparator);function j(...t){let e=E_;for(const n of t)e=e.add(n);return e}const I_=new Te(G);function A_(){return I_}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gh(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ei(e)?"-0":e}}function Zh(t){return{integerValue:""+t}}function S_(t,e){return n_(e)?Zh(e):Gh(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(){this._=void 0}}function R_(t,e,n){return t instanceof ri?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&qo(i)&&(i=zo(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(n,e):t instanceof Ur?Qh(t,e):t instanceof jr?Jh(t,e):function(s,i){const a=Kh(s,i),o=Nl(a)+Nl(s.Pe);return Za(a)&&Za(s.Pe)?Zh(o):Gh(s.serializer,o)}(t,e)}function k_(t,e,n){return t instanceof Ur?Qh(t,e):t instanceof jr?Jh(t,e):n}function Kh(t,e){return t instanceof si?function(r){return Za(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ri extends ji{}class Ur extends ji{constructor(e){super(),this.elements=e}}function Qh(t,e){const n=Xh(e);for(const r of t.elements)n.some(s=>ct(s,r))||n.push(r);return{arrayValue:{values:n}}}class jr extends ji{constructor(e){super(),this.elements=e}}function Jh(t,e){let n=Xh(e);for(const r of t.elements)n=n.filter(s=>!ct(s,r));return{arrayValue:{values:n}}}class si extends ji{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Nl(t){return le(t.integerValue||t.doubleValue)}function Xh(t){return Ho(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function D_(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Ur&&s instanceof Ur||r instanceof jr&&s instanceof jr?Bn(r.elements,s.elements,ct):r instanceof si&&s instanceof si?ct(r.Pe,s.Pe):r instanceof ri&&s instanceof ri}(t.transform,e.transform)}class P_{constructor(e,n){this.version=e,this.transformResults=n}}class ze{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ze}static exists(e){return new ze(void 0,e)}static updateTime(e){return new ze(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ls(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Bi{}function ed(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Qo(t.key,ze.none()):new ms(t.key,t.data,ze.none());{const n=t.data,r=Me.empty();let s=new Te(ve.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Qt(t.key,r,new Oe(s.toArray()),ze.none())}}function b_(t,e,n){t instanceof ms?function(s,i,a){const o=s.value.clone(),u=Ll(s.fieldTransforms,i,a.transformResults);o.setAll(u),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,n):t instanceof Qt?function(s,i,a){if(!Ls(s.precondition,i))return void i.convertToUnknownDocument(a.version);const o=Ll(s.fieldTransforms,i,a.transformResults),u=i.data;u.setAll(td(s)),u.setAll(o),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Er(t,e,n,r){return t instanceof ms?function(i,a,o,u){if(!Ls(i.precondition,a))return o;const l=i.value.clone(),c=Fl(i.fieldTransforms,u,a);return l.setAll(c),a.convertToFoundDocument(a.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof Qt?function(i,a,o,u){if(!Ls(i.precondition,a))return o;const l=Fl(i.fieldTransforms,u,a),c=a.data;return c.setAll(td(i)),c.setAll(l),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(i,a,o){return Ls(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,n)}function C_(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Kh(r.transform,s||null);i!=null&&(n===null&&(n=Me.empty()),n.set(r.field,i))}return n||null}function Ol(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Bn(r,s,(i,a)=>D_(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ms extends Bi{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Qt extends Bi{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function td(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Ll(t,e,n){const r=new Map;Q(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,o=e.data.field(i.field);r.set(i.field,k_(a,o,n[s]))}return r}function Fl(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,R_(i,a,e))}return r}class Qo extends Bi{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class x_ extends Bi{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M_{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&b_(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Er(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Er(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Hh();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=n.has(s.key)?null:o;const u=ed(a,o);u!==null&&r.set(s.key,u),a.isValidDocument()||a.convertToNoDocument(V.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),j())}isEqual(e){return this.batchId===e.batchId&&Bn(this.mutations,e.mutations,(n,r)=>Ol(n,r))&&Bn(this.baseMutations,e.baseMutations,(n,r)=>Ol(n,r))}}class Jo{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Q(e.mutations.length===r.length);let s=function(){return T_}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Jo(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ue,Y;function O_(t){switch(t){default:return C();case f.CANCELLED:case f.UNKNOWN:case f.DEADLINE_EXCEEDED:case f.RESOURCE_EXHAUSTED:case f.INTERNAL:case f.UNAVAILABLE:case f.UNAUTHENTICATED:return!1;case f.INVALID_ARGUMENT:case f.NOT_FOUND:case f.ALREADY_EXISTS:case f.PERMISSION_DENIED:case f.FAILED_PRECONDITION:case f.ABORTED:case f.OUT_OF_RANGE:case f.UNIMPLEMENTED:case f.DATA_LOSS:return!0}}function nd(t){if(t===void 0)return Rt("GRPC error has no .code"),f.UNKNOWN;switch(t){case ue.OK:return f.OK;case ue.CANCELLED:return f.CANCELLED;case ue.UNKNOWN:return f.UNKNOWN;case ue.DEADLINE_EXCEEDED:return f.DEADLINE_EXCEEDED;case ue.RESOURCE_EXHAUSTED:return f.RESOURCE_EXHAUSTED;case ue.INTERNAL:return f.INTERNAL;case ue.UNAVAILABLE:return f.UNAVAILABLE;case ue.UNAUTHENTICATED:return f.UNAUTHENTICATED;case ue.INVALID_ARGUMENT:return f.INVALID_ARGUMENT;case ue.NOT_FOUND:return f.NOT_FOUND;case ue.ALREADY_EXISTS:return f.ALREADY_EXISTS;case ue.PERMISSION_DENIED:return f.PERMISSION_DENIED;case ue.FAILED_PRECONDITION:return f.FAILED_PRECONDITION;case ue.ABORTED:return f.ABORTED;case ue.OUT_OF_RANGE:return f.OUT_OF_RANGE;case ue.UNIMPLEMENTED:return f.UNIMPLEMENTED;case ue.DATA_LOSS:return f.DATA_LOSS;default:return C()}}(Y=ue||(ue={}))[Y.OK=0]="OK",Y[Y.CANCELLED=1]="CANCELLED",Y[Y.UNKNOWN=2]="UNKNOWN",Y[Y.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Y[Y.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Y[Y.NOT_FOUND=5]="NOT_FOUND",Y[Y.ALREADY_EXISTS=6]="ALREADY_EXISTS",Y[Y.PERMISSION_DENIED=7]="PERMISSION_DENIED",Y[Y.UNAUTHENTICATED=16]="UNAUTHENTICATED",Y[Y.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Y[Y.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Y[Y.ABORTED=10]="ABORTED",Y[Y.OUT_OF_RANGE=11]="OUT_OF_RANGE",Y[Y.UNIMPLEMENTED=12]="UNIMPLEMENTED",Y[Y.INTERNAL=13]="INTERNAL",Y[Y.UNAVAILABLE=14]="UNAVAILABLE",Y[Y.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_=new Mn([4294967295,4294967295],0);function Ul(t){const e=L_().encode(t),n=new jg;return n.update(e),new Uint8Array(n.digest())}function jl(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Mn([n,r],0),new Mn([s,i],0)]}class Xo{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new mr(`Invalid padding: ${n}`);if(r<0)throw new mr(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new mr(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new mr(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Mn.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Mn.fromNumber(r)));return s.compare(F_)===1&&(s=new Mn([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Ul(e),[r,s]=jl(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);if(!this.de(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Xo(i,s,n);return r.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const n=Ul(e),[r,s]=jl(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class mr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,ps.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Yi(V.min(),s,new ie(G),kt(),j())}}class ps{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new ps(r,n,j(),j(),j())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class rd{constructor(e,n){this.targetId=e,this.me=n}}class sd{constructor(e,n,r=De.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Bl{constructor(){this.fe=0,this.ge=$l(),this.pe=De.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=j(),n=j(),r=j();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:C()}}),new ps(this.pe,this.ye,e,n,r)}ve(){this.we=!1,this.ge=$l()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Q(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class U_{constructor(e){this.Le=e,this.Be=new Map,this.ke=kt(),this.qe=Yl(),this.Qe=new ie(G)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:C()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(Qa(i))if(r===0){const a=new k(i.path);this.Ue(n,a,Ae.newNoDocument(a,V.min()))}else Q(r===1);else{const a=this.Ye(n);if(a!==r){const o=this.Ze(e),u=o?this.Xe(o,e,a):1;if(u!==0){this.je(n);const l=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,l)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,o;try{a=cn(r).toUint8Array()}catch(u){if(u instanceof Vh)return jn("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{o=new Xo(a,s,i)}catch(u){return jn(u instanceof mr?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return o.Ie===0?null:o}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,a)=>{const o=this.Je(a);if(o){if(i.current&&Qa(o.target)){const u=new k(o.target.path);this.ke.get(u)!==null||this.it(a,u)||this.Ue(a,u,Ae.newNoDocument(u,e))}i.be&&(n.set(a,i.Ce()),i.ve())}});let r=j();this.qe.forEach((i,a)=>{let o=!0;a.forEachWhile(u=>{const l=this.Je(u);return!l||l.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(r=r.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new Yi(e,n,this.Qe,this.ke,r);return this.ke=kt(),this.qe=Yl(),this.Qe=new ie(G),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Bl,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Te(G),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||A("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Bl),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Yl(){return new ie(k.comparator)}function $l(){return new ie(k.comparator)}const j_={asc:"ASCENDING",desc:"DESCENDING"},B_={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Y_={and:"AND",or:"OR"};class $_{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Xa(t,e){return t.useProto3Json||Li(e)?e:{value:e}}function ii(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function id(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function W_(t,e){return ii(t,e.toTimestamp())}function at(t){return Q(!!t),V.fromTimestamp(function(n){const r=$t(n);return new he(r.seconds,r.nanos)}(t))}function eu(t,e){return eo(t,e).canonicalString()}function eo(t,e){const n=function(s){return new X(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function ad(t){const e=X.fromString(t);return Q(hd(e)),e}function to(t,e){return eu(t.databaseId,e.path)}function wa(t,e){const n=ad(e);if(n.get(1)!==t.databaseId.projectId)throw new I(f.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new I(f.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new k(ud(n))}function od(t,e){return eu(t.databaseId,e)}function q_(t){const e=ad(t);return e.length===4?X.emptyPath():ud(e)}function no(t){return new X(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ud(t){return Q(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Wl(t,e,n){return{name:to(t,e),fields:n.value.mapValue.fields}}function z_(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:C()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(l,c){return l.useProto3Json?(Q(c===void 0||typeof c=="string"),De.fromBase64String(c||"")):(Q(c===void 0||c instanceof Buffer||c instanceof Uint8Array),De.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(l){const c=l.code===void 0?f.UNKNOWN:nd(l.code);return new I(c,l.message||"")}(a);n=new sd(r,s,i,o||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=wa(t,r.document.name),i=at(r.document.updateTime),a=r.document.createTime?at(r.document.createTime):V.min(),o=new Me({mapValue:{fields:r.document.fields}}),u=Ae.newFoundDocument(s,i,a,o),l=r.targetIds||[],c=r.removedTargetIds||[];n=new Fs(l,c,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=wa(t,r.document),i=r.readTime?at(r.readTime):V.min(),a=Ae.newNoDocument(s,i),o=r.removedTargetIds||[];n=new Fs([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=wa(t,r.document),i=r.removedTargetIds||[];n=new Fs([],i,s,null)}else{if(!("filter"in e))return C();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new N_(s,i),o=r.targetId;n=new rd(o,a)}}return n}function H_(t,e){let n;if(e instanceof ms)n={update:Wl(t,e.key,e.value)};else if(e instanceof Qo)n={delete:to(t,e.key)};else if(e instanceof Qt)n={update:Wl(t,e.key,e.data),updateMask:ny(e.fieldMask)};else{if(!(e instanceof x_))return C();n={verify:to(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const o=a.transform;if(o instanceof ri)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Ur)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof jr)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof si)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw C()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:W_(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:C()}(t,e.precondition)),n}function G_(t,e){return t&&t.length>0?(Q(e!==void 0),t.map(n=>function(s,i){let a=s.updateTime?at(s.updateTime):at(i);return a.isEqual(V.min())&&(a=at(i)),new P_(a,s.transformResults||[])}(n,e))):[]}function Z_(t,e){return{documents:[od(t,e.path)]}}function K_(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=od(t,s);const i=function(l){if(l.length!==0)return cd(Ze.create(l,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(l){if(l.length!==0)return l.map(c=>function(d){return{field:An(d.field),direction:X_(d.dir)}}(c))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const o=Xa(t,e.limit);return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:n,parent:s}}function Q_(t){let e=q_(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Q(r===1);const c=n.from[0];c.allDescendants?s=c.collectionId:e=e.child(c.collectionId)}let i=[];n.where&&(i=function(h){const d=ld(h);return d instanceof Ze&&Fh(d)?d.getFilters():[d]}(n.where));let a=[];n.orderBy&&(a=function(h){return h.map(d=>function(x){return new Fr(Sn(x.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(d))}(n.orderBy));let o=null;n.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,Li(d)?null:d}(n.limit));let u=null;n.startAt&&(u=function(h){const d=!!h.before,m=h.values||[];return new ti(m,d)}(n.startAt));let l=null;return n.endAt&&(l=function(h){const d=!h.before,m=h.values||[];return new ti(m,d)}(n.endAt)),g_(e,s,a,i,o,"F",u,l)}function J_(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return C()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function ld(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Sn(n.unaryFilter.field);return ce.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Sn(n.unaryFilter.field);return ce.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Sn(n.unaryFilter.field);return ce.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Sn(n.unaryFilter.field);return ce.create(a,"!=",{nullValue:"NULL_VALUE"});default:return C()}}(t):t.fieldFilter!==void 0?function(n){return ce.create(Sn(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return C()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ze.create(n.compositeFilter.filters.map(r=>ld(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return C()}}(n.compositeFilter.op))}(t):C()}function X_(t){return j_[t]}function ey(t){return B_[t]}function ty(t){return Y_[t]}function An(t){return{fieldPath:t.canonicalString()}}function Sn(t){return ve.fromServerFormat(t.fieldPath)}function cd(t){return t instanceof ce?function(n){if(n.op==="=="){if(bl(n.value))return{unaryFilter:{field:An(n.field),op:"IS_NAN"}};if(Pl(n.value))return{unaryFilter:{field:An(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(bl(n.value))return{unaryFilter:{field:An(n.field),op:"IS_NOT_NAN"}};if(Pl(n.value))return{unaryFilter:{field:An(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:An(n.field),op:ey(n.op),value:n.value}}}(t):t instanceof Ze?function(n){const r=n.getFilters().map(s=>cd(s));return r.length===1?r[0]:{compositeFilter:{op:ty(n.op),filters:r}}}(t):C()}function ny(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function hd(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e,n,r,s,i=V.min(),a=V.min(),o=De.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=u}withSequenceNumber(e){return new Vt(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Vt(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Vt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Vt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(e){this.ut=e}}function sy(t){const e=Q_({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ni(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(){this.on=new ay}addToCollectionParentIndex(e,n){return this.on.add(n),p.resolve()}getCollectionParents(e,n){return p.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return p.resolve()}deleteFieldIndex(e,n){return p.resolve()}deleteAllFieldIndexes(e){return p.resolve()}createTargetIndexes(e,n){return p.resolve()}getDocumentsMatchingTarget(e,n){return p.resolve(null)}getIndexType(e,n){return p.resolve(0)}getFieldIndexes(e,n){return p.resolve([])}getNextCollectionGroupToUpdate(e){return p.resolve(null)}getMinOffset(e,n){return p.resolve(Yt.min())}getMinOffsetFromCollectionGroup(e,n){return p.resolve(Yt.min())}updateCollectionGroup(e,n,r){return p.resolve()}updateIndexEntries(e,n){return p.resolve()}}class ay{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Te(X.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Te(X.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new Wn(0)}static Nn(){return new Wn(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(){this.changes=new tr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ae.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?p.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uy{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Er(r.mutation,s,Oe.empty(),he.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,j()).next(()=>r))}getLocalViewOfDocuments(e,n,r=j()){const s=nn();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=fr();return i.forEach((o,u)=>{a=a.insert(o,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=nn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,j()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,o)=>{n.set(a,o)})})}computeViews(e,n,r,s){let i=kt();const a=Tr(),o=function(){return Tr()}();return n.forEach((u,l)=>{const c=r.get(l.key);s.has(l.key)&&(c===void 0||c.mutation instanceof Qt)?i=i.insert(l.key,l):c!==void 0?(a.set(l.key,c.mutation.getFieldMask()),Er(c.mutation,l,c.mutation.getFieldMask(),he.now())):a.set(l.key,Oe.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((l,c)=>a.set(l,c)),n.forEach((l,c)=>{var h;return o.set(l,new uy(c,(h=a.get(l))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,n){const r=Tr();let s=new ie((a,o)=>a-o),i=j();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const o of a)o.keys().forEach(u=>{const l=n.get(u);if(l===null)return;let c=r.get(u)||Oe.empty();c=o.applyToLocalView(l,c),r.set(u,c);const h=(s.get(o.batchId)||j()).add(u);s=s.insert(o.batchId,h)})}).next(()=>{const a=[],o=s.getReverseIterator();for(;o.hasNext();){const u=o.getNext(),l=u.key,c=u.value,h=Hh();c.forEach(d=>{if(!i.has(d)){const m=ed(n.get(d),r.get(d));m!==null&&h.set(d,m),i=i.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,l,h))}return p.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return k.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Yh(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):p.resolve(nn());let o=-1,u=i;return a.next(l=>p.forEach(l,(c,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),i.get(c)?p.resolve():this.remoteDocumentCache.getEntry(e,c).next(d=>{u=u.insert(c,d)}))).next(()=>this.populateOverlays(e,l,i)).next(()=>this.computeViews(e,u,l,j())).next(c=>({batchId:o,changes:zh(c)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new k(n)).next(r=>{let s=fr();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let a=fr();return this.indexManager.getCollectionParents(e,i).next(o=>p.forEach(o,u=>{const l=function(h,d){return new er(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,l,r,s).next(c=>{c.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(a=>{i.forEach((u,l)=>{const c=l.getKey();a.get(c)===null&&(a=a.insert(c,Ae.newInvalidDocument(c)))});let o=fr();return a.forEach((u,l)=>{const c=i.get(u);c!==void 0&&Er(c.mutation,l,Oe.empty(),he.now()),Ui(n,l)&&(o=o.insert(u,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return p.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,function(s){return{id:s.id,version:s.version,createTime:at(s.createTime)}}(n)),p.resolve()}getNamedQuery(e,n){return p.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,function(s){return{name:s.name,query:sy(s.bundledQuery),readTime:at(s.readTime)}}(n)),p.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy{constructor(){this.overlays=new ie(k.comparator),this.lr=new Map}getOverlay(e,n){return p.resolve(this.overlays.get(n))}getOverlays(e,n){const r=nn();return p.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.lt(e,n,i)}),p.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.lr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.lr.delete(r)),p.resolve()}getOverlaysForCollection(e,n,r){const s=nn(),i=n.length+1,a=new k(n.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const u=o.getNext().value,l=u.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return p.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ie((l,c)=>l-c);const a=this.overlays.getIterator();for(;a.hasNext();){const l=a.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let c=i.get(l.largestBatchId);c===null&&(c=nn(),i=i.insert(l.largestBatchId,c)),c.set(l.getKey(),l)}}const o=nn(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,c)=>o.set(l,c)),!(o.size()>=s)););return p.resolve(o)}lt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.lr.get(s.largestBatchId).delete(r.key);this.lr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new V_(n,r));let i=this.lr.get(n);i===void 0&&(i=j(),this.lr.set(n,i)),this.lr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(){this.hr=new Te(fe.Pr),this.Ir=new Te(fe.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){const r=new fe(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new fe(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){const n=new k(new X([])),r=new fe(n,e),s=new fe(n,e+1),i=[];return this.Ir.forEachInRange([r,s],a=>{this.dr(a),i.push(a.key)}),i}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const n=new k(new X([])),r=new fe(n,e),s=new fe(n,e+1);let i=j();return this.Ir.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new fe(e,0),r=this.hr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class fe{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return k.comparator(e.key,n.key)||G(e.gr,n.gr)}static Tr(e,n){return G(e.gr,n.gr)||k.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dy{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new Te(fe.Pr)}checkEmpty(e){return p.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new M_(i,n,r,s);this.mutationQueue.push(a);for(const o of s)this.yr=this.yr.add(new fe(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return p.resolve(a)}lookupMutationBatch(e,n){return p.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Sr(r),i=s<0?0:s;return p.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return p.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return p.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new fe(n,0),s=new fe(n,Number.POSITIVE_INFINITY),i=[];return this.yr.forEachInRange([r,s],a=>{const o=this.wr(a.gr);i.push(o)}),p.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Te(G);return n.forEach(s=>{const i=new fe(s,0),a=new fe(s,Number.POSITIVE_INFINITY);this.yr.forEachInRange([i,a],o=>{r=r.add(o.gr)})}),p.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;k.isDocumentKey(i)||(i=i.child(""));const a=new fe(new k(i),0);let o=new Te(G);return this.yr.forEachWhile(u=>{const l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===s&&(o=o.add(u.gr)),!0)},a),p.resolve(this.br(o))}br(e){const n=[];return e.forEach(r=>{const s=this.wr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Q(this.Dr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return p.forEach(n.mutations,s=>{const i=new fe(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){const r=new fe(n,0),s=this.yr.firstAfterOrEqual(r);return p.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,p.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){const n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy{constructor(e){this.Cr=e,this.docs=function(){return new ie(k.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return p.resolve(r?r.document.mutableCopy():Ae.newInvalidDocument(n))}getEntries(e,n){let r=kt();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Ae.newInvalidDocument(s))}),p.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=kt();const a=n.path,o=new k(a.child("")),u=this.docs.getIteratorFrom(o);for(;u.hasNext();){const{key:l,value:{document:c}}=u.getNext();if(!a.isPrefixOf(l.path))break;l.path.length>a.length+1||Jg(Qg(c),r)<=0||(s.has(c.key)||Ui(n,c))&&(i=i.insert(c.key,c.mutableCopy()))}return p.resolve(i)}getAllFromCollectionGroup(e,n,r,s){C()}vr(e,n){return p.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new my(this)}getSize(e){return p.resolve(this.size)}}class my extends oy{constructor(e){super(),this._r=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this._r.addEntry(e,s)):this._r.removeEntry(r)}),p.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py{constructor(e){this.persistence=e,this.Fr=new tr(n=>Go(n),Zo),this.lastRemoteSnapshotVersion=V.min(),this.highestTargetId=0,this.Mr=0,this.Or=new tu,this.targetCount=0,this.Nr=Wn.On()}forEachTarget(e,n){return this.Fr.forEach((r,s)=>n(s)),p.resolve()}getLastRemoteSnapshotVersion(e){return p.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return p.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),p.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),p.resolve()}kn(e){this.Fr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Nr=new Wn(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,p.resolve()}updateTargetData(e,n){return this.kn(n),p.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,p.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Fr.forEach((a,o)=>{o.sequenceNumber<=n&&r.get(o.targetId)===null&&(this.Fr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)}),p.waitFor(i).next(()=>s)}getTargetCount(e){return p.resolve(this.targetCount)}getTargetData(e,n){const r=this.Fr.get(n)||null;return p.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),p.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),p.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),p.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Or.mr(n);return p.resolve(r)}containsKey(e,n){return p.resolve(this.Or.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{constructor(e,n){this.Lr={},this.overlays={},this.Br=new Wo(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new py(this),this.indexManager=new iy,this.remoteDocumentCache=function(s){return new fy(s)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new ry(n),this.Kr=new cy(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new hy,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new dy(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){A("MemoryPersistence","Starting transaction:",e);const s=new _y(this.Br.next());return this.referenceDelegate.$r(),r(s).next(i=>this.referenceDelegate.Ur(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Wr(e,n){return p.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}}class _y extends e_{constructor(e){super(),this.currentSequenceNumber=e}}class nu{constructor(e){this.persistence=e,this.Gr=new tu,this.zr=null}static jr(e){return new nu(e)}get Hr(){if(this.zr)return this.zr;throw C()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),p.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),p.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),p.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(s=>this.Hr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Hr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return p.forEach(this.Hr,r=>{const s=k.fromPath(r);return this.Jr(e,s).next(i=>{i||n.removeEntry(s,V.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return p.or([()=>p.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=s}static Qi(e,n){let r=j(),s=j();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new ru(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vy{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=function(){return _m()?8:t_(pm())>0?6:4}()}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.zi(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.ji(e,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new yy;return this.Hi(e,n,a).next(o=>{if(i.result=o,this.$i)return this.Ji(e,n,a,o.size)})}).next(()=>i.result)}Ji(e,n,r,s){return r.documentReadCount<this.Ui?(ur()<=q.DEBUG&&A("QueryEngine","SDK will not create cache indexes for query:",In(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),p.resolve()):(ur()<=q.DEBUG&&A("QueryEngine","Query:",In(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Wi*s?(ur()<=q.DEBUG&&A("QueryEngine","The SDK decides to create cache indexes for query:",In(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,it(n))):p.resolve())}zi(e,n){if(Vl(n))return p.resolve(null);let r=it(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=ni(n,null,"F"),r=it(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=j(...i);return this.Gi.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,r).next(u=>{const l=this.Yi(n,o);return this.Zi(n,l,a,u.readTime)?this.zi(e,ni(n,null,"F")):this.Xi(e,l,n,u)}))})))}ji(e,n,r,s){return Vl(n)||s.isEqual(V.min())?p.resolve(null):this.Gi.getDocuments(e,r).next(i=>{const a=this.Yi(n,i);return this.Zi(n,a,r,s)?p.resolve(null):(ur()<=q.DEBUG&&A("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),In(n)),this.Xi(e,a,n,Kg(s,-1)).next(o=>o))})}Yi(e,n){let r=new Te(Wh(e));return n.forEach((s,i)=>{Ui(e,i)&&(r=r.add(i))}),r}Zi(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Hi(e,n,r){return ur()<=q.DEBUG&&A("QueryEngine","Using full collection scan to execute query:",In(n)),this.Gi.getDocumentsMatchingQuery(e,n,Yt.min(),r)}Xi(e,n,r,s){return this.Gi.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e,n,r,s){this.persistence=e,this.es=n,this.serializer=s,this.ts=new ie(G),this.ns=new tr(i=>Go(i),Zo),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ly(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}}function Ty(t,e,n,r){return new wy(t,e,n,r)}async function dd(t,e){const n=N(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],o=[];let u=j();for(const l of s){a.push(l.batchId);for(const c of l.mutations)u=u.add(c.key)}for(const l of i){o.push(l.batchId);for(const c of l.mutations)u=u.add(c.key)}return n.localDocuments.getDocuments(r,u).next(l=>({_s:l,removedBatchIds:a,addedBatchIds:o}))})})}function Ey(t,e){const n=N(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.ss.newChangeBuffer({trackRemovals:!0});return function(o,u,l,c){const h=l.batch,d=h.keys();let m=p.resolve();return d.forEach(x=>{m=m.next(()=>c.getEntry(u,x)).next(F=>{const D=l.docVersions.get(x);Q(D!==null),F.version.compareTo(D)<0&&(h.applyToRemoteDocument(F,l),F.isValidDocument()&&(F.setReadTime(l.commitVersion),c.addEntry(F)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(u,h))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let u=j();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(u=u.add(o.batch.mutations[l].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function fd(t){const e=N(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function Iy(t,e){const n=N(t),r=e.snapshotVersion;let s=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.ss.newChangeBuffer({trackRemovals:!0});s=n.ts;const o=[];e.targetChanges.forEach((c,h)=>{const d=s.get(h);if(!d)return;o.push(n.qr.removeMatchingKeys(i,c.removedDocuments,h).next(()=>n.qr.addMatchingKeys(i,c.addedDocuments,h)));let m=d.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(De.EMPTY_BYTE_STRING,V.min()).withLastLimboFreeSnapshotVersion(V.min()):c.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(c.resumeToken,r)),s=s.insert(h,m),function(F,D,ne){return F.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=3e8?!0:ne.addedDocuments.size+ne.modifiedDocuments.size+ne.removedDocuments.size>0}(d,m,c)&&o.push(n.qr.updateTargetData(i,m))});let u=kt(),l=j();if(e.documentUpdates.forEach(c=>{e.resolvedLimboDocuments.has(c)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(i,c))}),o.push(Ay(i,a,e.documentUpdates).next(c=>{u=c.us,l=c.cs})),!r.isEqual(V.min())){const c=n.qr.getLastRemoteSnapshotVersion(i).next(h=>n.qr.setTargetsMetadata(i,i.currentSequenceNumber,r));o.push(c)}return p.waitFor(o).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,l)).next(()=>u)}).then(i=>(n.ts=s,i))}function Ay(t,e,n){let r=j(),s=j();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=kt();return n.forEach((o,u)=>{const l=i.get(o);u.isFoundDocument()!==l.isFoundDocument()&&(s=s.add(o)),u.isNoDocument()&&u.version.isEqual(V.min())?(e.removeEntry(o,u.readTime),a=a.insert(o,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||u.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(u),a=a.insert(o,u)):A("LocalStore","Ignoring outdated watch update for ",o,". Current version:",l.version," Watch version:",u.version)}),{us:a,cs:s}})}function Sy(t,e){const n=N(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ry(t,e){const n=N(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.qr.getTargetData(r,e).next(i=>i?(s=i,p.resolve(s)):n.qr.allocateTargetId(r).next(a=>(s=new Vt(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.ts.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}async function ro(t,e,n){const r=N(t),s=r.ts.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!fs(a))throw a;A("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.ts=r.ts.remove(e),r.ns.delete(s.target)}function ql(t,e,n){const r=N(t);let s=V.min(),i=j();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,l,c){const h=N(u),d=h.ns.get(c);return d!==void 0?p.resolve(h.ts.get(d)):h.qr.getTargetData(l,c)}(r,a,it(e)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(a,o.targetId).next(u=>{i=u})}).next(()=>r.es.getDocumentsMatchingQuery(a,e,n?s:V.min(),n?i:j())).next(o=>(ky(r,y_(e),o),{documents:o,ls:i})))}function ky(t,e,n){let r=t.rs.get(e)||V.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.rs.set(e,r)}class zl{constructor(){this.activeTargetIds=A_()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Dy{constructor(){this.eo=new zl,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new zl,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{ro(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){A("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){A("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ms=null;function Ta(){return Ms===null?Ms=function(){return 268435456+Math.round(2147483648*Math.random())}():Ms++,"0x"+Ms.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const by={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}Eo(e){this.Ao=e}onMessage(e){this.Ro=e}close(){this.lo()}send(e){this.co(e)}Vo(){this.Po()}mo(){this.To()}fo(e){this.Ao(e)}po(e){this.Ro(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ee="WebChannelConnection";class xy extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.yo=r+"://"+n.host,this.wo=`projects/${s}/databases/${i}`,this.So=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get bo(){return!1}Do(n,r,s,i,a){const o=Ta(),u=this.Co(n,r.toUriEncodedString());A("RestConnection",`Sending RPC '${n}' ${o}:`,u,s);const l={"google-cloud-resource-prefix":this.wo,"x-goog-request-params":this.So};return this.vo(l,i,a),this.Fo(n,u,l,s).then(c=>(A("RestConnection",`Received RPC '${n}' ${o}: `,c),c),c=>{throw jn("RestConnection",`RPC '${n}' ${o} failed with error: `,c,"url: ",u,"request:",s),c})}Mo(n,r,s,i,a,o){return this.Do(n,r,s,i,a)}vo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Xn}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>n[a]=i),s&&s.headers.forEach((i,a)=>n[a]=i)}Co(n,r){const s=by[n];return`${this.yo}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Fo(e,n,r,s){const i=Ta();return new Promise((a,o)=>{const u=new Ug;u.setWithCredentials(!0),u.listenOnce(Og.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case va.NO_ERROR:const c=u.getResponseJson();A(Ee,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(c)),a(c);break;case va.TIMEOUT:A(Ee,`RPC '${e}' ${i} timed out`),o(new I(f.DEADLINE_EXCEEDED,"Request time out"));break;case va.HTTP_ERROR:const h=u.getStatus();if(A(Ee,`RPC '${e}' ${i} failed with status:`,h,"response text:",u.getResponseText()),h>0){let d=u.getResponseJson();Array.isArray(d)&&(d=d[0]);const m=d==null?void 0:d.error;if(m&&m.status&&m.message){const x=function(D){const ne=D.toLowerCase().replace(/_/g,"-");return Object.values(f).indexOf(ne)>=0?ne:f.UNKNOWN}(m.status);o(new I(x,m.message))}else o(new I(f.UNKNOWN,"Server responded with status "+u.getStatus()))}else o(new I(f.UNAVAILABLE,"Connection failed."));break;default:C()}}finally{A(Ee,`RPC '${e}' ${i} completed.`)}});const l=JSON.stringify(s);A(Ee,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",l,r,15)})}xo(e,n,r){const s=Ta(),i=[this.yo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Vg(),o=Ng(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.xmlHttpFactory=new Fg({})),this.vo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const c=i.join("");A(Ee,`Creating RPC '${e}' stream ${s}: ${c}`,u);const h=a.createWebChannel(c,u);let d=!1,m=!1;const x=new Cy({co:D=>{m?A(Ee,`Not sending because RPC '${e}' stream ${s} is closed:`,D):(d||(A(Ee,`Opening RPC '${e}' stream ${s} transport.`),h.open(),d=!0),A(Ee,`RPC '${e}' stream ${s} sending:`,D),h.send(D))},lo:()=>h.close()}),F=(D,ne,ge)=>{D.listen(ne,Ne=>{try{ge(Ne)}catch(gt){setTimeout(()=>{throw gt},0)}})};return F(h,bs.EventType.OPEN,()=>{m||(A(Ee,`RPC '${e}' stream ${s} transport opened.`),x.Vo())}),F(h,bs.EventType.CLOSE,()=>{m||(m=!0,A(Ee,`RPC '${e}' stream ${s} transport closed`),x.fo())}),F(h,bs.EventType.ERROR,D=>{m||(m=!0,jn(Ee,`RPC '${e}' stream ${s} transport errored:`,D),x.fo(new I(f.UNAVAILABLE,"The operation could not be completed")))}),F(h,bs.EventType.MESSAGE,D=>{var ne;if(!m){const ge=D.data[0];Q(!!ge);const Ne=ge,gt=Ne.error||((ne=Ne[0])===null||ne===void 0?void 0:ne.error);if(gt){A(Ee,`RPC '${e}' stream ${s} received error:`,gt);const As=gt.status;let vn=function(Xf){const Xu=ue[Xf];if(Xu!==void 0)return nd(Xu)}(As),Ss=gt.message;vn===void 0&&(vn=f.INTERNAL,Ss="Unknown error status: "+As+" with message "+gt.message),m=!0,x.fo(new I(vn,Ss)),h.close()}else A(Ee,`RPC '${e}' stream ${s} received:`,ge),x.po(ge)}}),F(o,Lg.STAT_EVENT,D=>{D.stat===Il.PROXY?A(Ee,`RPC '${e}' stream ${s} detected buffering proxy`):D.stat===Il.NOPROXY&&A(Ee,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.mo()},0),x}}function Ea(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $i(t){return new $_(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(e,n,r=1e3,s=1.5,i=6e4){this.si=e,this.timerId=n,this.Oo=r,this.No=s,this.Lo=i,this.Bo=0,this.ko=null,this.qo=Date.now(),this.reset()}reset(){this.Bo=0}Qo(){this.Bo=this.Lo}Ko(e){this.cancel();const n=Math.floor(this.Bo+this.$o()),r=Math.max(0,Date.now()-this.qo),s=Math.max(0,n-r);s>0&&A("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Bo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.ko=this.si.enqueueAfterDelay(this.timerId,s,()=>(this.qo=Date.now(),e())),this.Bo*=this.No,this.Bo<this.Oo&&(this.Bo=this.Oo),this.Bo>this.Lo&&(this.Bo=this.Lo)}Uo(){this.ko!==null&&(this.ko.skipDelay(),this.ko=null)}cancel(){this.ko!==null&&(this.ko.cancel(),this.ko=null)}$o(){return(Math.random()-.5)*this.Bo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e,n,r,s,i,a,o,u){this.si=e,this.Wo=r,this.Go=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=u,this.state=0,this.zo=0,this.jo=null,this.Ho=null,this.stream=null,this.Jo=new md(e,n)}Yo(){return this.state===1||this.state===5||this.Zo()}Zo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Xo()}async stop(){this.Yo()&&await this.close(0)}e_(){this.state=0,this.Jo.reset()}t_(){this.Zo()&&this.jo===null&&(this.jo=this.si.enqueueAfterDelay(this.Wo,6e4,()=>this.n_()))}r_(e){this.i_(),this.stream.send(e)}async n_(){if(this.Zo())return this.close(0)}i_(){this.jo&&(this.jo.cancel(),this.jo=null)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}async close(e,n){this.i_(),this.s_(),this.Jo.cancel(),this.zo++,e!==4?this.Jo.reset():n&&n.code===f.RESOURCE_EXHAUSTED?(Rt(n.toString()),Rt("Using maximum backoff delay to prevent overloading the backend."),this.Jo.Qo()):n&&n.code===f.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.o_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Eo(n)}o_(){}auth(){this.state=1;const e=this.__(this.zo),n=this.zo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.zo===n&&this.a_(r,s)},r=>{e(()=>{const s=new I(f.UNKNOWN,"Fetching auth token failed: "+r.message);return this.u_(s)})})}a_(e,n){const r=this.__(this.zo);this.stream=this.c_(e,n),this.stream.ho(()=>{r(()=>this.listener.ho())}),this.stream.Io(()=>{r(()=>(this.state=2,this.Ho=this.si.enqueueAfterDelay(this.Go,1e4,()=>(this.Zo()&&(this.state=3),Promise.resolve())),this.listener.Io()))}),this.stream.Eo(s=>{r(()=>this.u_(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Xo(){this.state=5,this.Jo.Ko(async()=>{this.state=0,this.start()})}u_(e){return A("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}__(e){return n=>{this.si.enqueueAndForget(()=>this.zo===e?n():(A("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class My extends pd{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}c_(e,n){return this.connection.xo("Listen",e,n)}onMessage(e){this.Jo.reset();const n=z_(this.serializer,e),r=function(i){if(!("targetChange"in i))return V.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?V.min():a.readTime?at(a.readTime):V.min()}(e);return this.listener.l_(n,r)}h_(e){const n={};n.database=no(this.serializer),n.addTarget=function(i,a){let o;const u=a.target;if(o=Qa(u)?{documents:Z_(i,u)}:{query:K_(i,u)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=id(i,a.resumeToken);const l=Xa(i,a.expectedCount);l!==null&&(o.expectedCount=l)}else if(a.snapshotVersion.compareTo(V.min())>0){o.readTime=ii(i,a.snapshotVersion.toTimestamp());const l=Xa(i,a.expectedCount);l!==null&&(o.expectedCount=l)}return o}(this.serializer,e);const r=J_(this.serializer,e);r&&(n.labels=r),this.r_(n)}P_(e){const n={};n.database=no(this.serializer),n.removeTarget=e,this.r_(n)}}class Vy extends pd{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i,this.I_=!1}get T_(){return this.I_}start(){this.I_=!1,this.lastStreamToken=void 0,super.start()}o_(){this.I_&&this.E_([])}c_(e,n){return this.connection.xo("Write",e,n)}onMessage(e){if(Q(!!e.streamToken),this.lastStreamToken=e.streamToken,this.I_){this.Jo.reset();const n=G_(e.writeResults,e.commitTime),r=at(e.commitTime);return this.listener.d_(r,n)}return Q(!e.writeResults||e.writeResults.length===0),this.I_=!0,this.listener.A_()}R_(){const e={};e.database=no(this.serializer),this.r_(e)}E_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>H_(this.serializer,r))};this.r_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.V_=!1}m_(){if(this.V_)throw new I(f.FAILED_PRECONDITION,"The client has already been terminated.")}Do(e,n,r,s){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Do(e,eo(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===f.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new I(f.UNKNOWN,i.toString())})}Mo(e,n,r,s,i){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Mo(e,eo(n,r),s,a,o,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===f.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new I(f.UNKNOWN,a.toString())})}terminate(){this.V_=!0,this.connection.terminate()}}class Oy{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(Rt(n),this.y_=!1):A("OnlineStateTracker",n)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=i,this.O_.ro(a=>{r.enqueueAndForget(async()=>{_n(this)&&(A("RemoteStore","Restarting streams for network reachability change."),await async function(u){const l=N(u);l.M_.add(4),await gs(l),l.N_.set("Unknown"),l.M_.delete(4),await Wi(l)}(this))})}),this.N_=new Oy(r,s)}}async function Wi(t){if(_n(t))for(const e of t.x_)await e(!0)}async function gs(t){for(const e of t.x_)await e(!1)}function gd(t,e){const n=N(t);n.F_.has(e.targetId)||(n.F_.set(e.targetId,e),ou(n)?au(n):nr(n).Zo()&&iu(n,e))}function su(t,e){const n=N(t),r=nr(n);n.F_.delete(e),r.Zo()&&_d(n,e),n.F_.size===0&&(r.Zo()?r.t_():_n(n)&&n.N_.set("Unknown"))}function iu(t,e){if(t.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(V.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}nr(t).h_(e)}function _d(t,e){t.L_.xe(e),nr(t).P_(e)}function au(t){t.L_=new U_({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.F_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),nr(t).start(),t.N_.w_()}function ou(t){return _n(t)&&!nr(t).Yo()&&t.F_.size>0}function _n(t){return N(t).M_.size===0}function yd(t){t.L_=void 0}async function Fy(t){t.N_.set("Online")}async function Uy(t){t.F_.forEach((e,n)=>{iu(t,e)})}async function jy(t,e){yd(t),ou(t)?(t.N_.D_(e),au(t)):t.N_.set("Unknown")}async function By(t,e,n){if(t.N_.set("Online"),e instanceof sd&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const o of i.targetIds)s.F_.has(o)&&(await s.remoteSyncer.rejectListen(o,a),s.F_.delete(o),s.L_.removeTarget(o))}(t,e)}catch(r){A("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await ai(t,r)}else if(e instanceof Fs?t.L_.Ke(e):e instanceof rd?t.L_.He(e):t.L_.We(e),!n.isEqual(V.min()))try{const r=await fd(t.localStore);n.compareTo(r)>=0&&await function(i,a){const o=i.L_.rt(a);return o.targetChanges.forEach((u,l)=>{if(u.resumeToken.approximateByteSize()>0){const c=i.F_.get(l);c&&i.F_.set(l,c.withResumeToken(u.resumeToken,a))}}),o.targetMismatches.forEach((u,l)=>{const c=i.F_.get(u);if(!c)return;i.F_.set(u,c.withResumeToken(De.EMPTY_BYTE_STRING,c.snapshotVersion)),_d(i,u);const h=new Vt(c.target,u,l,c.sequenceNumber);iu(i,h)}),i.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(r){A("RemoteStore","Failed to raise snapshot:",r),await ai(t,r)}}async function ai(t,e,n){if(!fs(e))throw e;t.M_.add(1),await gs(t),t.N_.set("Offline"),n||(n=()=>fd(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{A("RemoteStore","Retrying IndexedDB access"),await n(),t.M_.delete(1),await Wi(t)})}function vd(t,e){return e().catch(n=>ai(t,n,e))}async function qi(t){const e=N(t),n=Wt(e);let r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;Yy(e);)try{const s=await Sy(e.localStore,r);if(s===null){e.v_.length===0&&n.t_();break}r=s.batchId,$y(e,s)}catch(s){await ai(e,s)}wd(e)&&Td(e)}function Yy(t){return _n(t)&&t.v_.length<10}function $y(t,e){t.v_.push(e);const n=Wt(t);n.Zo()&&n.T_&&n.E_(e.mutations)}function wd(t){return _n(t)&&!Wt(t).Yo()&&t.v_.length>0}function Td(t){Wt(t).start()}async function Wy(t){Wt(t).R_()}async function qy(t){const e=Wt(t);for(const n of t.v_)e.E_(n.mutations)}async function zy(t,e,n){const r=t.v_.shift(),s=Jo.from(r,e,n);await vd(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await qi(t)}async function Hy(t,e){e&&Wt(t).T_&&await async function(r,s){if(function(a){return O_(a)&&a!==f.ABORTED}(s.code)){const i=r.v_.shift();Wt(r).e_(),await vd(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await qi(r)}}(t,e),wd(t)&&Td(t)}async function Gl(t,e){const n=N(t);n.asyncQueue.verifyOperationInProgress(),A("RemoteStore","RemoteStore received new credentials");const r=_n(n);n.M_.add(3),await gs(n),r&&n.N_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.M_.delete(3),await Wi(n)}async function Gy(t,e){const n=N(t);e?(n.M_.delete(2),await Wi(n)):e||(n.M_.add(2),await gs(n),n.N_.set("Unknown"))}function nr(t){return t.B_||(t.B_=function(n,r,s){const i=N(n);return i.m_(),new My(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{ho:Fy.bind(null,t),Io:Uy.bind(null,t),Eo:jy.bind(null,t),l_:By.bind(null,t)}),t.x_.push(async e=>{e?(t.B_.e_(),ou(t)?au(t):t.N_.set("Unknown")):(await t.B_.stop(),yd(t))})),t.B_}function Wt(t){return t.k_||(t.k_=function(n,r,s){const i=N(n);return i.m_(),new Vy(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{ho:()=>Promise.resolve(),Io:Wy.bind(null,t),Eo:Hy.bind(null,t),A_:qy.bind(null,t),d_:zy.bind(null,t)}),t.x_.push(async e=>{e?(t.k_.e_(),await qi(t)):(await t.k_.stop(),t.v_.length>0&&(A("RemoteStore",`Stopping write stream with ${t.v_.length} pending writes`),t.v_=[]))})),t.k_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Ut,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,o=new uu(e,n,a,s,i);return o.start(r),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new I(f.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function lu(t,e){if(Rt("AsyncQueue",`${e}: ${t}`),fs(t))return new I(f.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this.comparator=e?(n,r)=>e(n,r)||k.comparator(n.key,r.key):(n,r)=>k.comparator(n.key,r.key),this.keyedMap=fr(),this.sortedSet=new ie(this.comparator)}static emptySet(e){return new Vn(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Vn)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Vn;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(){this.q_=new ie(k.comparator)}track(e){const n=e.doc.key,r=this.q_.get(n);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(n,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(n):e.type===1&&r.type===2?this.q_=this.q_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(n,{type:2,doc:e.doc}):C():this.q_=this.q_.insert(n,e)}Q_(){const e=[];return this.q_.inorderTraversal((n,r)=>{e.push(r)}),e}}class qn{constructor(e,n,r,s,i,a,o,u,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(o=>{a.push({type:0,doc:o})}),new qn(e,n,Vn.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Fi(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}}class Ky{constructor(){this.queries=new tr(e=>$h(e),Fi),this.onlineState="Unknown",this.z_=new Set}}async function Ed(t,e){const n=N(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.W_()&&e.G_()&&(r=2):(i=new Zy,r=e.G_()?0:1);try{switch(r){case 0:i.K_=await n.onListen(s,!0);break;case 1:i.K_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const o=lu(a,`Initialization of query '${In(e.query)}' failed`);return void e.onError(o)}n.queries.set(s,i),i.U_.push(e),e.j_(n.onlineState),i.K_&&e.H_(i.K_)&&cu(n)}async function Id(t,e){const n=N(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const a=i.U_.indexOf(e);a>=0&&(i.U_.splice(a,1),i.U_.length===0?s=e.G_()?0:1:!i.W_()&&e.G_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Qy(t,e){const n=N(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const o of a.U_)o.H_(s)&&(r=!0);a.K_=s}}r&&cu(n)}function Jy(t,e,n){const r=N(t),s=r.queries.get(e);if(s)for(const i of s.U_)i.onError(n);r.queries.delete(e)}function cu(t){t.z_.forEach(e=>{e.next()})}var so,Kl;(Kl=so||(so={})).J_="default",Kl.Cache="cache";class Ad{constructor(e,n,r){this.query=e,this.Y_=n,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new qn(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),n=!0):this.ta(e,this.onlineState)&&(this.na(e),n=!0),this.X_=e,n}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let n=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),n=!0),n}ta(e,n){if(!e.fromCache||!this.G_())return!0;const r=n!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ea(e){if(e.docChanges.length>0)return!0;const n=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}na(e){e=qn.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==so.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(e){this.key=e}}class Rd{constructor(e){this.key=e}}class Xy{constructor(e,n){this.query=e,this.la=n,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=j(),this.mutatedKeys=j(),this.Ia=Wh(e),this.Ta=new Vn(this.Ia)}get Ea(){return this.la}da(e,n){const r=n?n.Aa:new Zl,s=n?n.Ta:this.Ta;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,o=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,l=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((c,h)=>{const d=s.get(c),m=Ui(this.query,h)?h:null,x=!!d&&this.mutatedKeys.has(d.key),F=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let D=!1;d&&m?d.data.isEqual(m.data)?x!==F&&(r.track({type:3,doc:m}),D=!0):this.Ra(d,m)||(r.track({type:2,doc:m}),D=!0,(u&&this.Ia(m,u)>0||l&&this.Ia(m,l)<0)&&(o=!0)):!d&&m?(r.track({type:0,doc:m}),D=!0):d&&!m&&(r.track({type:1,doc:d}),D=!0,(u||l)&&(o=!0)),D&&(m?(a=a.add(m),i=F?i.add(c):i.delete(c)):(a=a.delete(c),i=i.delete(c)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const c=this.query.limitType==="F"?a.last():a.first();a=a.delete(c.key),i=i.delete(c.key),r.track({type:1,doc:c})}return{Ta:a,Aa:r,Zi:o,mutatedKeys:i}}Ra(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;const a=e.Aa.Q_();a.sort((c,h)=>function(m,x){const F=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return C()}};return F(m)-F(x)}(c.type,h.type)||this.Ia(c.doc,h.doc)),this.Va(r),s=s!=null&&s;const o=n&&!s?this.ma():[],u=this.Pa.size===0&&this.current&&!s?1:0,l=u!==this.ha;return this.ha=u,a.length!==0||l?{snapshot:new qn(this.query,e.Ta,i,a,e.mutatedKeys,u===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:o}:{fa:o}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new Zl,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(n=>this.la=this.la.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.la=this.la.delete(n)),this.current=e.current)}ma(){if(!this.current)return[];const e=this.Pa;this.Pa=j(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});const n=[];return e.forEach(r=>{this.Pa.has(r)||n.push(new Rd(r))}),this.Pa.forEach(r=>{e.has(r)||n.push(new Sd(r))}),n}pa(e){this.la=e.ls,this.Pa=j();const n=this.da(e.documents);return this.applyChanges(n,!0)}ya(){return qn.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}}class ev{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class tv{constructor(e){this.key=e,this.wa=!1}}class nv{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Sa={},this.ba=new tr(o=>$h(o),Fi),this.Da=new Map,this.Ca=new Set,this.va=new ie(k.comparator),this.Fa=new Map,this.Ma=new tu,this.xa={},this.Oa=new Map,this.Na=Wn.Nn(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}}async function rv(t,e,n=!0){const r=xd(t);let s;const i=r.ba.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.ya()):s=await kd(r,e,n,!0),s}async function sv(t,e){const n=xd(t);await kd(n,e,!0,!1)}async function kd(t,e,n,r){const s=await Ry(t.localStore,it(e)),i=s.targetId,a=n?t.sharedClientState.addLocalQueryTarget(i):"not-current";let o;return r&&(o=await iv(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&gd(t.remoteStore,s),o}async function iv(t,e,n,r,s){t.Ba=(h,d,m)=>async function(F,D,ne,ge){let Ne=D.view.da(ne);Ne.Zi&&(Ne=await ql(F.localStore,D.query,!1).then(({documents:Ss})=>D.view.da(Ss,Ne)));const gt=ge&&ge.targetChanges.get(D.targetId),As=ge&&ge.targetMismatches.get(D.targetId)!=null,vn=D.view.applyChanges(Ne,F.isPrimaryClient,gt,As);return Jl(F,D.targetId,vn.fa),vn.snapshot}(t,h,d,m);const i=await ql(t.localStore,e,!0),a=new Xy(e,i.ls),o=a.da(i.documents),u=ps.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),l=a.applyChanges(o,t.isPrimaryClient,u);Jl(t,n,l.fa);const c=new ev(e,n,a);return t.ba.set(e,c),t.Da.has(n)?t.Da.get(n).push(e):t.Da.set(n,[e]),l.snapshot}async function av(t,e,n){const r=N(t),s=r.ba.get(e),i=r.Da.get(s.targetId);if(i.length>1)return r.Da.set(s.targetId,i.filter(a=>!Fi(a,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ro(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&su(r.remoteStore,s.targetId),io(r,s.targetId)}).catch(ds)):(io(r,s.targetId),await ro(r.localStore,s.targetId,!0))}async function ov(t,e){const n=N(t),r=n.ba.get(e),s=n.Da.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),su(n.remoteStore,r.targetId))}async function uv(t,e,n){const r=pv(t);try{const s=await function(a,o){const u=N(a),l=he.now(),c=o.reduce((m,x)=>m.add(x.key),j());let h,d;return u.persistence.runTransaction("Locally write mutations","readwrite",m=>{let x=kt(),F=j();return u.ss.getEntries(m,c).next(D=>{x=D,x.forEach((ne,ge)=>{ge.isValidDocument()||(F=F.add(ne))})}).next(()=>u.localDocuments.getOverlayedDocuments(m,x)).next(D=>{h=D;const ne=[];for(const ge of o){const Ne=C_(ge,h.get(ge.key).overlayedDocument);Ne!=null&&ne.push(new Qt(ge.key,Ne,Nh(Ne.value.mapValue),ze.exists(!0)))}return u.mutationQueue.addMutationBatch(m,l,ne,o)}).next(D=>{d=D;const ne=D.applyToLocalDocumentSet(h,F);return u.documentOverlayCache.saveOverlays(m,D.batchId,ne)})}).then(()=>({batchId:d.batchId,changes:zh(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,o,u){let l=a.xa[a.currentUser.toKey()];l||(l=new ie(G)),l=l.insert(o,u),a.xa[a.currentUser.toKey()]=l}(r,s.batchId,n),await _s(r,s.changes),await qi(r.remoteStore)}catch(s){const i=lu(s,"Failed to persist write");n.reject(i)}}async function Dd(t,e){const n=N(t);try{const r=await Iy(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.Fa.get(i);a&&(Q(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.wa=!0:s.modifiedDocuments.size>0?Q(a.wa):s.removedDocuments.size>0&&(Q(a.wa),a.wa=!1))}),await _s(n,r,e)}catch(r){await ds(r)}}function Ql(t,e,n){const r=N(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.ba.forEach((i,a)=>{const o=a.view.j_(e);o.snapshot&&s.push(o.snapshot)}),function(a,o){const u=N(a);u.onlineState=o;let l=!1;u.queries.forEach((c,h)=>{for(const d of h.U_)d.j_(o)&&(l=!0)}),l&&cu(u)}(r.eventManager,e),s.length&&r.Sa.l_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function lv(t,e,n){const r=N(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Fa.get(e),i=s&&s.key;if(i){let a=new ie(k.comparator);a=a.insert(i,Ae.newNoDocument(i,V.min()));const o=j().add(i),u=new Yi(V.min(),new Map,new ie(G),a,o);await Dd(r,u),r.va=r.va.remove(i),r.Fa.delete(e),hu(r)}else await ro(r.localStore,e,!1).then(()=>io(r,e,n)).catch(ds)}async function cv(t,e){const n=N(t),r=e.batch.batchId;try{const s=await Ey(n.localStore,e);bd(n,r,null),Pd(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await _s(n,s)}catch(s){await ds(s)}}async function hv(t,e,n){const r=N(t);try{const s=await function(a,o){const u=N(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let c;return u.mutationQueue.lookupMutationBatch(l,o).next(h=>(Q(h!==null),c=h.keys(),u.mutationQueue.removeMutationBatch(l,h))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,c,o)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,c)).next(()=>u.localDocuments.getDocuments(l,c))})}(r.localStore,e);bd(r,e,n),Pd(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await _s(r,s)}catch(s){await ds(s)}}function Pd(t,e){(t.Oa.get(e)||[]).forEach(n=>{n.resolve()}),t.Oa.delete(e)}function bd(t,e,n){const r=N(t);let s=r.xa[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.xa[r.currentUser.toKey()]=s}}function io(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Da.get(e))t.ba.delete(r),n&&t.Sa.ka(r,n);t.Da.delete(e),t.isPrimaryClient&&t.Ma.Rr(e).forEach(r=>{t.Ma.containsKey(r)||Cd(t,r)})}function Cd(t,e){t.Ca.delete(e.path.canonicalString());const n=t.va.get(e);n!==null&&(su(t.remoteStore,n),t.va=t.va.remove(e),t.Fa.delete(n),hu(t))}function Jl(t,e,n){for(const r of n)r instanceof Sd?(t.Ma.addReference(r.key,e),dv(t,r)):r instanceof Rd?(A("SyncEngine","Document no longer in limbo: "+r.key),t.Ma.removeReference(r.key,e),t.Ma.containsKey(r.key)||Cd(t,r.key)):C()}function dv(t,e){const n=e.key,r=n.path.canonicalString();t.va.get(n)||t.Ca.has(r)||(A("SyncEngine","New document in limbo: "+n),t.Ca.add(r),hu(t))}function hu(t){for(;t.Ca.size>0&&t.va.size<t.maxConcurrentLimboResolutions;){const e=t.Ca.values().next().value;t.Ca.delete(e);const n=new k(X.fromString(e)),r=t.Na.next();t.Fa.set(r,new tv(n)),t.va=t.va.insert(n,r),gd(t.remoteStore,new Vt(it(Ko(n.path)),r,"TargetPurposeLimboResolution",Wo.oe))}}async function _s(t,e,n){const r=N(t),s=[],i=[],a=[];r.ba.isEmpty()||(r.ba.forEach((o,u)=>{a.push(r.Ba(u,e,n).then(l=>{if((l||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,l!=null&&l.fromCache?"not-current":"current"),l){s.push(l);const c=ru.Qi(u.targetId,l);i.push(c)}}))}),await Promise.all(a),r.Sa.l_(s),await async function(u,l){const c=N(u);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>p.forEach(l,d=>p.forEach(d.ki,m=>c.persistence.referenceDelegate.addReference(h,d.targetId,m)).next(()=>p.forEach(d.qi,m=>c.persistence.referenceDelegate.removeReference(h,d.targetId,m)))))}catch(h){if(!fs(h))throw h;A("LocalStore","Failed to update sequence numbers: "+h)}for(const h of l){const d=h.targetId;if(!h.fromCache){const m=c.ts.get(d),x=m.snapshotVersion,F=m.withLastLimboFreeSnapshotVersion(x);c.ts=c.ts.insert(d,F)}}}(r.localStore,i))}async function fv(t,e){const n=N(t);if(!n.currentUser.isEqual(e)){A("SyncEngine","User change. New user:",e.toKey());const r=await dd(n.localStore,e);n.currentUser=e,function(i,a){i.Oa.forEach(o=>{o.forEach(u=>{u.reject(new I(f.CANCELLED,a))})}),i.Oa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await _s(n,r._s)}}function mv(t,e){const n=N(t),r=n.Fa.get(e);if(r&&r.wa)return j().add(r.key);{let s=j();const i=n.Da.get(e);if(!i)return s;for(const a of i){const o=n.ba.get(a);s=s.unionWith(o.view.Ea)}return s}}function xd(t){const e=N(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Dd.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=mv.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=lv.bind(null,e),e.Sa.l_=Qy.bind(null,e.eventManager),e.Sa.ka=Jy.bind(null,e.eventManager),e}function pv(t){const e=N(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=cv.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=hv.bind(null,e),e}class Xl{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=$i(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return Ty(this.persistence,new vy,e.initialUser,this.serializer)}createPersistence(e){return new gy(nu.jr,this.serializer)}createSharedClientState(e){return new Dy}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class gv{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Ql(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=fv.bind(null,this.syncEngine),await Gy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Ky}()}createDatastore(e){const n=$i(e.databaseInfo.databaseId),r=function(i){return new xy(i)}(e.databaseInfo);return function(i,a,o,u){return new Ny(i,a,o,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,o){return new Ly(r,s,i,a,o)}(this.localStore,this.datastore,e.asyncQueue,n=>Ql(this.syncEngine,n,0),function(){return Hl.D()?new Hl:new Py}())}createSyncEngine(e,n){return function(s,i,a,o,u,l,c){const h=new nv(s,i,a,o,u,l);return c&&(h.La=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e;await async function(r){const s=N(r);A("RemoteStore","RemoteStore shutting down."),s.M_.add(5),await gs(s),s.O_.shutdown(),s.N_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):Rt("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e,n,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Ie.UNAUTHENTICATED,this.clientId=xh.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{A("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(A("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new I(f.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ut;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=lu(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ia(t,e){t.asyncQueue.verifyOperationInProgress(),A("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await dd(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function ec(t,e){t.asyncQueue.verifyOperationInProgress();const n=await vv(t);A("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Gl(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Gl(e.remoteStore,s)),t._onlineComponents=e}function yv(t){return t.name==="FirebaseError"?t.code===f.FAILED_PRECONDITION||t.code===f.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function vv(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){A("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ia(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!yv(n))throw n;jn("Error using user provided cache. Falling back to memory cache: "+n),await Ia(t,new Xl)}}else A("FirestoreClient","Using default OfflineComponentProvider"),await Ia(t,new Xl);return t._offlineComponents}async function Vd(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(A("FirestoreClient","Using user provided OnlineComponentProvider"),await ec(t,t._uninitializedComponentsProvider._online)):(A("FirestoreClient","Using default OnlineComponentProvider"),await ec(t,new gv))),t._onlineComponents}function wv(t){return Vd(t).then(e=>e.syncEngine)}async function ao(t){const e=await Vd(t),n=e.eventManager;return n.onListen=rv.bind(null,e.syncEngine),n.onUnlisten=av.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=sv.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=ov.bind(null,e.syncEngine),n}function Tv(t,e,n={}){const r=new Ut;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,u,l){const c=new Md({next:d=>{a.enqueueAndForget(()=>Id(i,h)),d.fromCache&&u.source==="server"?l.reject(new I(f.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(d)},error:d=>l.reject(d)}),h=new Ad(o,c,{includeMetadataChanges:!0,ra:!0});return Ed(i,h)}(await ao(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nd(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tc=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Od(t,e,n){if(!n)throw new I(f.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Ev(t,e,n,r){if(e===!0&&r===!0)throw new I(f.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function nc(t){if(!k.isDocumentKey(t))throw new I(f.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function rc(t){if(k.isDocumentKey(t))throw new I(f.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function zi(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":C()}function ot(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new I(f.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=zi(t);throw new I(f.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new I(f.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new I(f.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Ev("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Nd((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new I(f.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new I(f.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new I(f.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Hi{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sc({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new I(f.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new I(f.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sc(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Bg;switch(r.type){case"firstParty":return new qg(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new I(f.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=tc.get(n);r&&(A("ComponentProvider","Removing Datastore"),tc.delete(n),r.terminate())}(this),Promise.resolve()}}function Iv(t,e,n,r={}){var s;const i=(t=ot(t,Hi))._getSettings(),a=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&jn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),r.mockUserToken){let o,u;if(typeof r.mockUserToken=="string")o=r.mockUserToken,u=Ie.MOCK_USER;else{o=mm(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new I(f.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Ie(l)}t._authCredentials=new Yg(new Ch(o,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new bt(this.firestore,e,this._query)}}class Ve{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new jt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ve(this.firestore,e,this._key)}}class jt extends bt{constructor(e,n,r){super(e,n,Ko(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ve(this.firestore,null,new k(e))}withConverter(e){return new jt(this.firestore,e,this._path)}}function Av(t,e,...n){if(t=lt(t),Od("collection","path",e),t instanceof Hi){const r=X.fromString(e,...n);return rc(r),new jt(t,null,r)}{if(!(t instanceof Ve||t instanceof jt))throw new I(f.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(X.fromString(e,...n));return rc(r),new jt(t.firestore,null,r)}}function Ld(t,e,...n){if(t=lt(t),arguments.length===1&&(e=xh.newId()),Od("doc","path",e),t instanceof Hi){const r=X.fromString(e,...n);return nc(r),new Ve(t,null,new k(r))}{if(!(t instanceof Ve||t instanceof jt))throw new I(f.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(X.fromString(e,...n));return nc(r),new Ve(t.firestore,t instanceof jt?t.converter:null,new k(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Jo=new md(this,"async_queue_retry"),this.hu=()=>{const n=Ea();n&&A("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Jo.Uo()};const e=Ea();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;const n=Ea();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});const n=new Ut;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}async Tu(){if(this.su.length!==0){try{await this.su[0](),this.su.shift(),this.Jo.reset()}catch(e){if(!fs(e))throw e;A("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Jo.Ko(()=>this.Tu())}}Iu(e){const n=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;const s=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(r);throw Rt("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.uu=!1,r))));return this.iu=n,n}enqueueAfterDelay(e,n,r){this.Pu(),this.lu.indexOf(e)>-1&&(n=0);const s=uu.createAndSchedule(this,e,n,r,i=>this.Eu(i));return this._u.push(s),s}Pu(){this.au&&C()}verifyOperationInProgress(){}async du(){let e;do e=this.iu,await e;while(e!==this.iu)}Au(e){for(const n of this._u)if(n.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this._u)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){const n=this._u.indexOf(e);this._u.splice(n,1)}}function ic(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class dn extends Hi{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=function(){return new Sv}(),this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Fd(this),this._firestoreClient.terminate()}}function Rv(t,e){const n=typeof t=="object"?t:Tp(),r=typeof t=="string"?t:"(default)",s=_p(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=dm("firestore");i&&Iv(s,...i)}return s}function du(t){return t._firestoreClient||Fd(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Fd(t){var e,n,r;const s=t._freezeSettings(),i=function(o,u,l,c){return new s_(o,u,l,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,Nd(c.experimentalLongPollingOptions),c.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._firestoreClient=new _v(t._authCredentials,t._appCheckCredentials,t._queue,i),!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new zn(De.fromBase64String(e))}catch(n){throw new I(f.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new zn(De.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new I(f.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ve(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new I(f.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new I(f.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return G(this._lat,e._lat)||G(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kv=/^__.*__$/;class Dv{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Qt(e,this.data,this.fieldMask,n,this.fieldTransforms):new ms(e,this.data,n,this.fieldTransforms)}}class Ud{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Qt(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function jd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw C()}}class pu{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.mu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new pu(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.gu({path:r,yu:!1});return s.wu(e),s}Su(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.gu({path:r,yu:!1});return s.mu(),s}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return oi(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(jd(this.fu)&&kv.test(e))throw this.Du('Document fields cannot begin and end with "__"')}}class Pv{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||$i(e)}Fu(e,n,r,s=!1){return new pu({fu:e,methodName:n,vu:r,path:ve.emptyPath(),yu:!1,Cu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function gu(t){const e=t._freezeSettings(),n=$i(t._databaseId);return new Pv(t._databaseId,!!e.ignoreUndefinedProperties,n)}function bv(t,e,n,r,s,i={}){const a=t.Fu(i.merge||i.mergeFields?2:0,e,n,s);_u("Data must be an object, but it was:",a,r);const o=Bd(r,a);let u,l;if(i.merge)u=new Oe(a.fieldMask),l=a.fieldTransforms;else if(i.mergeFields){const c=[];for(const h of i.mergeFields){const d=oo(e,h,n);if(!a.contains(d))throw new I(f.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);$d(c,d)||c.push(d)}u=new Oe(c),l=a.fieldTransforms.filter(h=>u.covers(h.field))}else u=null,l=a.fieldTransforms;return new Dv(new Me(o),u,l)}class Zi extends fu{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Zi}}function Cv(t,e,n,r){const s=t.Fu(1,e,n);_u("Data must be an object, but it was:",s,r);const i=[],a=Me.empty();gn(r,(u,l)=>{const c=yu(e,u,n);l=lt(l);const h=s.Su(c);if(l instanceof Zi)i.push(c);else{const d=ys(l,h);d!=null&&(i.push(c),a.set(c,d))}});const o=new Oe(i);return new Ud(a,o,s.fieldTransforms)}function xv(t,e,n,r,s,i){const a=t.Fu(1,e,n),o=[oo(e,r,n)],u=[s];if(i.length%2!=0)throw new I(f.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<i.length;d+=2)o.push(oo(e,i[d])),u.push(i[d+1]);const l=[],c=Me.empty();for(let d=o.length-1;d>=0;--d)if(!$d(l,o[d])){const m=o[d];let x=u[d];x=lt(x);const F=a.Su(m);if(x instanceof Zi)l.push(m);else{const D=ys(x,F);D!=null&&(l.push(m),c.set(m,D))}}const h=new Oe(l);return new Ud(c,h,a.fieldTransforms)}function Mv(t,e,n,r=!1){return ys(n,t.Fu(r?4:3,e))}function ys(t,e){if(Yd(t=lt(t)))return _u("Unsupported field value:",e,t),Bd(t,e);if(t instanceof fu)return function(r,s){if(!jd(s.fu))throw s.Du(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Du(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const o of r){let u=ys(o,s.bu(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=lt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return S_(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=he.fromDate(r);return{timestampValue:ii(s.serializer,i)}}if(r instanceof he){const i=new he(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ii(s.serializer,i)}}if(r instanceof mu)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof zn)return{bytesValue:id(s.serializer,r._byteString)};if(r instanceof Ve){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Du(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:eu(r.firestore._databaseId||s.databaseId,r._key.path)}}throw s.Du(`Unsupported field value: ${zi(r)}`)}(t,e)}function Bd(t,e){const n={};return Mh(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):gn(t,(r,s)=>{const i=ys(s,e.pu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Yd(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof he||t instanceof mu||t instanceof zn||t instanceof Ve||t instanceof fu)}function _u(t,e,n){if(!Yd(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=zi(n);throw r==="an object"?e.Du(t+" a custom object"):e.Du(t+" "+r)}}function oo(t,e,n){if((e=lt(e))instanceof Gi)return e._internalPath;if(typeof e=="string")return yu(t,e);throw oi("Field path arguments must be of type string or ",t,!1,void 0,n)}const Vv=new RegExp("[~\\*/\\[\\]]");function yu(t,e,n){if(e.search(Vv)>=0)throw oi(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Gi(...e.split("."))._internalPath}catch{throw oi(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function oi(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let o=`Function ${e}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${r}`),a&&(u+=` in document ${s}`),u+=")"),new I(f.INVALID_ARGUMENT,o+t+u)}function $d(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ve(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Nv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(vu("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Nv extends Wd{data(){return super.data()}}function vu(t,e){return typeof e=="string"?yu(t,e):e instanceof Gi?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qd(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new I(f.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wu{}class Tu extends wu{}function Ov(t,e,...n){let r=[];e instanceof wu&&r.push(e),r=r.concat(n),function(i){const a=i.filter(u=>u instanceof Iu).length,o=i.filter(u=>u instanceof Eu).length;if(a>1||a>0&&o>0)throw new I(f.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Eu extends Tu{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Eu(e,n,r)}_apply(e){const n=this._parse(e);return zd(e._query,n),new bt(e.firestore,e.converter,Ja(e._query,n))}_parse(e){const n=gu(e.firestore);return function(i,a,o,u,l,c,h){let d;if(l.isKeyField()){if(c==="array-contains"||c==="array-contains-any")throw new I(f.INVALID_ARGUMENT,`Invalid Query. You can't perform '${c}' queries on documentId().`);if(c==="in"||c==="not-in"){oc(h,c);const m=[];for(const x of h)m.push(ac(u,i,x));d={arrayValue:{values:m}}}else d=ac(u,i,h)}else c!=="in"&&c!=="not-in"&&c!=="array-contains-any"||oc(h,c),d=Mv(o,a,h,c==="in"||c==="not-in");return ce.create(l,c,d)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class Iu extends wu{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Iu(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ze.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const o=i.getFlattenedFilters();for(const u of o)zd(a,u),a=Ja(a,u)}(e._query,n),new bt(e.firestore,e.converter,Ja(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Au extends Tu{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Au(e,n)}_apply(e){const n=function(s,i,a){if(s.startAt!==null)throw new I(f.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new I(f.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Fr(i,a)}(e._query,this._field,this._direction);return new bt(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new er(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Lv(t,e="asc"){const n=e,r=vu("orderBy",t);return Au._create(r,n)}class Su extends Tu{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Su(e,n,r)}_apply(e){return new bt(e.firestore,e.converter,ni(e._query,this._limit,this._limitType))}}function Fv(t){return Su._create("limit",t,"F")}function ac(t,e,n){if(typeof(n=lt(n))=="string"){if(n==="")throw new I(f.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Yh(e)&&n.indexOf("/")!==-1)throw new I(f.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(X.fromString(n));if(!k.isDocumentKey(r))throw new I(f.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Dl(t,new k(r))}if(n instanceof Ve)return Dl(t,n._key);throw new I(f.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zi(n)}.`)}function oc(t,e){if(!Array.isArray(t)||t.length===0)throw new I(f.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function zd(t,e){const n=function(s,i){for(const a of s)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new I(f.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new I(f.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Uv{convertValue(e,n="none"){switch(hn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return le(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(cn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw C()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return gn(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(e){return new mu(le(e.latitude),le(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=zo(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Nr(e));default:return null}}convertTimestamp(e){const n=$t(e);return new he(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=X.fromString(e);Q(hd(r));const s=new Or(r.get(1),r.get(3)),i=new k(r.popFirst(5));return s.isEqual(n)||Rt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jv(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Hd extends Wd{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Us(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(vu("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Us extends Hd{data(e={}){return super.data(e)}}class Gd{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new pr(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Us(this._firestore,this._userDataWriter,r.key,r,new pr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new I(f.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(o=>{const u=new Us(s._firestore,s._userDataWriter,o.doc.key,o.doc,new pr(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const u=new Us(s._firestore,s._userDataWriter,o.doc.key,o.doc,new pr(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let l=-1,c=-1;return o.type!==0&&(l=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),c=a.indexOf(o.doc.key)),{type:Bv(o.type),doc:u,oldIndex:l,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function Bv(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return C()}}class Ru extends Uv{constructor(e){super(),this.firestore=e}convertBytes(e){return new zn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ve(this.firestore,null,n)}}function Yv(t){t=ot(t,bt);const e=ot(t.firestore,dn),n=du(e),r=new Ru(e);return qd(t._query),Tv(n,t._query).then(s=>new Gd(e,r,t,s))}function uc(t,e,n,...r){t=ot(t,Ve);const s=ot(t.firestore,dn),i=gu(s);let a;return a=typeof(e=lt(e))=="string"||e instanceof Gi?xv(i,"updateDoc",t._key,e,n,r):Cv(i,"updateDoc",t._key,e),ku(s,[a.toMutation(t._key,ze.exists(!0))])}function $v(t){return ku(ot(t.firestore,dn),[new Qo(t._key,ze.none())])}function Wv(t,e){const n=ot(t.firestore,dn),r=Ld(t),s=jv(t.converter,e);return ku(n,[bv(gu(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,ze.exists(!1))]).then(()=>r)}function qv(t,...e){var n,r,s;t=lt(t);let i={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||ic(e[a])||(i=e[a],a++);const o={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(ic(e[a])){const h=e[a];e[a]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[a+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[a+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let u,l,c;if(t instanceof Ve)l=ot(t.firestore,dn),c=Ko(t._key.path),u={next:h=>{e[a]&&e[a](zv(l,t,h))},error:e[a+1],complete:e[a+2]};else{const h=ot(t,bt);l=ot(h.firestore,dn),c=h._query;const d=new Ru(l);u={next:m=>{e[a]&&e[a](new Gd(l,d,h,m))},error:e[a+1],complete:e[a+2]},qd(t._query)}return function(d,m,x,F){const D=new Md(F),ne=new Ad(m,D,x);return d.asyncQueue.enqueueAndForget(async()=>Ed(await ao(d),ne)),()=>{D.$a(),d.asyncQueue.enqueueAndForget(async()=>Id(await ao(d),ne))}}(du(l),c,o,u)}function ku(t,e){return function(r,s){const i=new Ut;return r.asyncQueue.enqueueAndForget(async()=>uv(await wv(r),s,i)),i.promise}(du(t),e)}function zv(t,e,n){const r=n.docs.get(e._key),s=new Ru(t);return new Hd(t,s,e._key,r,new pr(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){Xn=s})(wp),Hs(new Ar("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),o=new dn(new $g(r.getProvider("auth-internal")),new Hg(r.getProvider("app-check-internal")),function(l,c){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new I(f.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Or(l.options.projectId,c)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Cn(Al,"4.6.1",e),Cn(Al,"4.6.1","esm2017")})();const Du={firebaseConfig:{apiKey:"AIzaSyCd162qJLz2CmpLB5toWZ59U9F2wPsrRao",authDomain:"todo-c2ebc.firebaseapp.com",projectId:"todo-c2ebc",storageBucket:"todo-c2ebc.appspot.com",messagingSenderId:"527036943420",appId:"1:527036943420:web:d392a4d66fb34e6a204739"},name_collection_todo:"todo"},Hv=Rc(Du.firebaseConfig),Zd=Rv(Hv),Pu=Av(Zd,Du.name_collection_todo),Aa=t=>Ld(Zd,Du.name_collection_todo,t);//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var Kd;function v(){return Kd.apply(null,arguments)}function Gv(t){Kd=t}function Ke(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function an(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function z(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function bu(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(z(t,e))return!1;return!0}function xe(t){return t===void 0}function Dt(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function vs(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function Qd(t,e){var n=[],r,s=t.length;for(r=0;r<s;++r)n.push(e(t[r],r));return n}function Nt(t,e){for(var n in e)z(e,n)&&(t[n]=e[n]);return z(e,"toString")&&(t.toString=e.toString),z(e,"valueOf")&&(t.valueOf=e.valueOf),t}function mt(t,e,n,r){return Tf(t,e,n,r,!0).utc()}function Zv(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function L(t){return t._pf==null&&(t._pf=Zv()),t._pf}var uo;Array.prototype.some?uo=Array.prototype.some:uo=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function Cu(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=L(t),n=uo.call(e.parsedDateParts,function(s){return s!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function Ki(t){var e=mt(NaN);return t!=null?Nt(L(e),t):L(e).userInvalidated=!0,e}var lc=v.momentProperties=[],Sa=!1;function xu(t,e){var n,r,s,i=lc.length;if(xe(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),xe(e._i)||(t._i=e._i),xe(e._f)||(t._f=e._f),xe(e._l)||(t._l=e._l),xe(e._strict)||(t._strict=e._strict),xe(e._tzm)||(t._tzm=e._tzm),xe(e._isUTC)||(t._isUTC=e._isUTC),xe(e._offset)||(t._offset=e._offset),xe(e._pf)||(t._pf=L(e)),xe(e._locale)||(t._locale=e._locale),i>0)for(n=0;n<i;n++)r=lc[n],s=e[r],xe(s)||(t[r]=s);return t}function ws(t){xu(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Sa===!1&&(Sa=!0,v.updateOffset(this),Sa=!1)}function Qe(t){return t instanceof ws||t!=null&&t._isAMomentObject!=null}function Jd(t){v.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Ye(t,e){var n=!0;return Nt(function(){if(v.deprecationHandler!=null&&v.deprecationHandler(null,t),n){var r=[],s,i,a,o=arguments.length;for(i=0;i<o;i++){if(s="",typeof arguments[i]=="object"){s+=`
[`+i+"] ";for(a in arguments[0])z(arguments[0],a)&&(s+=a+": "+arguments[0][a]+", ");s=s.slice(0,-2)}else s=arguments[i];r.push(s)}Jd(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var cc={};function Xd(t,e){v.deprecationHandler!=null&&v.deprecationHandler(t,e),cc[t]||(Jd(e),cc[t]=!0)}v.suppressDeprecationWarnings=!1;v.deprecationHandler=null;function pt(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function Kv(t){var e,n;for(n in t)z(t,n)&&(e=t[n],pt(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function lo(t,e){var n=Nt({},t),r;for(r in e)z(e,r)&&(an(t[r])&&an(e[r])?(n[r]={},Nt(n[r],t[r]),Nt(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)z(t,r)&&!z(e,r)&&an(t[r])&&(n[r]=Nt({},n[r]));return n}function Mu(t){t!=null&&this.set(t)}var co;Object.keys?co=Object.keys:co=function(t){var e,n=[];for(e in t)z(t,e)&&n.push(e);return n};var Qv={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Jv(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return pt(r)?r.call(e,n):r}function ht(t,e,n){var r=""+Math.abs(t),s=e-r.length,i=t>=0;return(i?n?"+":"":"-")+Math.pow(10,Math.max(0,s)).toString().substr(1)+r}var Vu=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Vs=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Ra={},Nn={};function R(t,e,n,r){var s=r;typeof r=="string"&&(s=function(){return this[r]()}),t&&(Nn[t]=s),e&&(Nn[e[0]]=function(){return ht(s.apply(this,arguments),e[1],e[2])}),n&&(Nn[n]=function(){return this.localeData().ordinal(s.apply(this,arguments),t)})}function Xv(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function ew(t){var e=t.match(Vu),n,r;for(n=0,r=e.length;n<r;n++)Nn[e[n]]?e[n]=Nn[e[n]]:e[n]=Xv(e[n]);return function(s){var i="",a;for(a=0;a<r;a++)i+=pt(e[a])?e[a].call(s,t):e[a];return i}}function js(t,e){return t.isValid()?(e=ef(e,t.localeData()),Ra[e]=Ra[e]||ew(e),Ra[e](t)):t.localeData().invalidDate()}function ef(t,e){var n=5;function r(s){return e.longDateFormat(s)||s}for(Vs.lastIndex=0;n>=0&&Vs.test(t);)t=t.replace(Vs,r),Vs.lastIndex=0,n-=1;return t}var tw={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function nw(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(Vu).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var rw="Invalid date";function sw(){return this._invalidDate}var iw="%d",aw=/\d{1,2}/;function ow(t){return this._ordinal.replace("%d",t)}var uw={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function lw(t,e,n,r){var s=this._relativeTime[n];return pt(s)?s(t,e,n,r):s.replace(/%d/i,t)}function cw(t,e){var n=this._relativeTime[t>0?"future":"past"];return pt(n)?n(e):n.replace(/%s/i,e)}var hc={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function $e(t){return typeof t=="string"?hc[t]||hc[t.toLowerCase()]:void 0}function Nu(t){var e={},n,r;for(r in t)z(t,r)&&(n=$e(r),n&&(e[n]=t[r]));return e}var hw={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function dw(t){var e=[],n;for(n in t)z(t,n)&&e.push({unit:n,priority:hw[n]});return e.sort(function(r,s){return r.priority-s.priority}),e}var tf=/\d/,Ue=/\d\d/,nf=/\d{3}/,Ou=/\d{4}/,Qi=/[+-]?\d{6}/,te=/\d\d?/,rf=/\d\d\d\d?/,sf=/\d\d\d\d\d\d?/,Ji=/\d{1,3}/,Lu=/\d{1,4}/,Xi=/[+-]?\d{1,6}/,rr=/\d+/,ea=/[+-]?\d+/,fw=/Z|[+-]\d\d:?\d\d/gi,ta=/Z|[+-]\d\d(?::?\d\d)?/gi,mw=/[+-]?\d+(\.\d{1,3})?/,Ts=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,sr=/^[1-9]\d?/,Fu=/^([1-9]\d|\d)/,ui;ui={};function E(t,e,n){ui[t]=pt(e)?e:function(r,s){return r&&n?n:e}}function pw(t,e){return z(ui,t)?ui[t](e._strict,e._locale):new RegExp(gw(t))}function gw(t){return It(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,s,i){return n||r||s||i}))}function It(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function je(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function B(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=je(e)),n}var ho={};function K(t,e){var n,r=e,s;for(typeof t=="string"&&(t=[t]),Dt(e)&&(r=function(i,a){a[e]=B(i)}),s=t.length,n=0;n<s;n++)ho[t[n]]=r}function Es(t,e){K(t,function(n,r,s,i){s._w=s._w||{},e(n,s._w,s,i)})}function _w(t,e,n){e!=null&&z(ho,t)&&ho[t](e,n._a,n,t)}function na(t){return t%4===0&&t%100!==0||t%400===0}var ke=0,Tt=1,tt=2,de=3,We=4,Et=5,rn=6,yw=7,vw=8;R("Y",0,0,function(){var t=this.year();return t<=9999?ht(t,4):"+"+t});R(0,["YY",2],0,function(){return this.year()%100});R(0,["YYYY",4],0,"year");R(0,["YYYYY",5],0,"year");R(0,["YYYYYY",6,!0],0,"year");E("Y",ea);E("YY",te,Ue);E("YYYY",Lu,Ou);E("YYYYY",Xi,Qi);E("YYYYYY",Xi,Qi);K(["YYYYY","YYYYYY"],ke);K("YYYY",function(t,e){e[ke]=t.length===2?v.parseTwoDigitYear(t):B(t)});K("YY",function(t,e){e[ke]=v.parseTwoDigitYear(t)});K("Y",function(t,e){e[ke]=parseInt(t,10)});function Ir(t){return na(t)?366:365}v.parseTwoDigitYear=function(t){return B(t)+(B(t)>68?1900:2e3)};var af=ir("FullYear",!0);function ww(){return na(this.year())}function ir(t,e){return function(n){return n!=null?(of(this,t,n),v.updateOffset(this,e),this):Br(this,t)}}function Br(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function of(t,e,n){var r,s,i,a,o;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,s=t._isUTC,e){case"Milliseconds":return void(s?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(s?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(s?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(s?r.setUTCHours(n):r.setHours(n));case"Date":return void(s?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}i=n,a=t.month(),o=t.date(),o=o===29&&a===1&&!na(i)?28:o,s?r.setUTCFullYear(i,a,o):r.setFullYear(i,a,o)}}function Tw(t){return t=$e(t),pt(this[t])?this[t]():this}function Ew(t,e){if(typeof t=="object"){t=Nu(t);var n=dw(t),r,s=n.length;for(r=0;r<s;r++)this[n[r].unit](t[n[r].unit])}else if(t=$e(t),pt(this[t]))return this[t](e);return this}function Iw(t,e){return(t%e+e)%e}var oe;Array.prototype.indexOf?oe=Array.prototype.indexOf:oe=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Uu(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=Iw(e,12);return t+=(e-n)/12,n===1?na(t)?29:28:31-n%7%2}R("M",["MM",2],"Mo",function(){return this.month()+1});R("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});R("MMMM",0,0,function(t){return this.localeData().months(this,t)});E("M",te,sr);E("MM",te,Ue);E("MMM",function(t,e){return e.monthsShortRegex(t)});E("MMMM",function(t,e){return e.monthsRegex(t)});K(["M","MM"],function(t,e){e[Tt]=B(t)-1});K(["MMM","MMMM"],function(t,e,n,r){var s=n._locale.monthsParse(t,r,n._strict);s!=null?e[Tt]=s:L(n).invalidMonth=t});var Aw="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),uf="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),lf=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Sw=Ts,Rw=Ts;function kw(t,e){return t?Ke(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||lf).test(e)?"format":"standalone"][t.month()]:Ke(this._months)?this._months:this._months.standalone}function Dw(t,e){return t?Ke(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[lf.test(e)?"format":"standalone"][t.month()]:Ke(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Pw(t,e,n){var r,s,i,a=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)i=mt([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(i,"").toLocaleLowerCase();return n?e==="MMM"?(s=oe.call(this._shortMonthsParse,a),s!==-1?s:null):(s=oe.call(this._longMonthsParse,a),s!==-1?s:null):e==="MMM"?(s=oe.call(this._shortMonthsParse,a),s!==-1?s:(s=oe.call(this._longMonthsParse,a),s!==-1?s:null)):(s=oe.call(this._longMonthsParse,a),s!==-1?s:(s=oe.call(this._shortMonthsParse,a),s!==-1?s:null))}function bw(t,e,n){var r,s,i;if(this._monthsParseExact)return Pw.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(s=mt([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(i="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[r]=new RegExp(i.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function cf(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=B(e);else if(e=t.localeData().monthsParse(e),!Dt(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,Uu(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function hf(t){return t!=null?(cf(this,t),v.updateOffset(this,!0),this):Br(this,"Month")}function Cw(){return Uu(this.year(),this.month())}function xw(t){return this._monthsParseExact?(z(this,"_monthsRegex")||df.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(z(this,"_monthsShortRegex")||(this._monthsShortRegex=Sw),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function Mw(t){return this._monthsParseExact?(z(this,"_monthsRegex")||df.call(this),t?this._monthsStrictRegex:this._monthsRegex):(z(this,"_monthsRegex")||(this._monthsRegex=Rw),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function df(){function t(u,l){return l.length-u.length}var e=[],n=[],r=[],s,i,a,o;for(s=0;s<12;s++)i=mt([2e3,s]),a=It(this.monthsShort(i,"")),o=It(this.months(i,"")),e.push(a),n.push(o),r.push(o),r.push(a);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Vw(t,e,n,r,s,i,a){var o;return t<100&&t>=0?(o=new Date(t+400,e,n,r,s,i,a),isFinite(o.getFullYear())&&o.setFullYear(t)):o=new Date(t,e,n,r,s,i,a),o}function Yr(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function li(t,e,n){var r=7+e-n,s=(7+Yr(t,0,r).getUTCDay()-e)%7;return-s+r-1}function ff(t,e,n,r,s){var i=(7+n-r)%7,a=li(t,r,s),o=1+7*(e-1)+i+a,u,l;return o<=0?(u=t-1,l=Ir(u)+o):o>Ir(t)?(u=t+1,l=o-Ir(t)):(u=t,l=o),{year:u,dayOfYear:l}}function $r(t,e,n){var r=li(t.year(),e,n),s=Math.floor((t.dayOfYear()-r-1)/7)+1,i,a;return s<1?(a=t.year()-1,i=s+At(a,e,n)):s>At(t.year(),e,n)?(i=s-At(t.year(),e,n),a=t.year()+1):(a=t.year(),i=s),{week:i,year:a}}function At(t,e,n){var r=li(t,e,n),s=li(t+1,e,n);return(Ir(t)-r+s)/7}R("w",["ww",2],"wo","week");R("W",["WW",2],"Wo","isoWeek");E("w",te,sr);E("ww",te,Ue);E("W",te,sr);E("WW",te,Ue);Es(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=B(t)});function Nw(t){return $r(t,this._week.dow,this._week.doy).week}var Ow={dow:0,doy:6};function Lw(){return this._week.dow}function Fw(){return this._week.doy}function Uw(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function jw(t){var e=$r(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}R("d",0,"do","day");R("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});R("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});R("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});R("e",0,0,"weekday");R("E",0,0,"isoWeekday");E("d",te);E("e",te);E("E",te);E("dd",function(t,e){return e.weekdaysMinRegex(t)});E("ddd",function(t,e){return e.weekdaysShortRegex(t)});E("dddd",function(t,e){return e.weekdaysRegex(t)});Es(["dd","ddd","dddd"],function(t,e,n,r){var s=n._locale.weekdaysParse(t,r,n._strict);s!=null?e.d=s:L(n).invalidWeekday=t});Es(["d","e","E"],function(t,e,n,r){e[r]=B(t)});function Bw(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function Yw(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function ju(t,e){return t.slice(e,7).concat(t.slice(0,e))}var $w="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),mf="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Ww="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),qw=Ts,zw=Ts,Hw=Ts;function Gw(t,e){var n=Ke(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?ju(n,this._week.dow):t?n[t.day()]:n}function Zw(t){return t===!0?ju(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function Kw(t){return t===!0?ju(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function Qw(t,e,n){var r,s,i,a=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)i=mt([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(i,"").toLocaleLowerCase();return n?e==="dddd"?(s=oe.call(this._weekdaysParse,a),s!==-1?s:null):e==="ddd"?(s=oe.call(this._shortWeekdaysParse,a),s!==-1?s:null):(s=oe.call(this._minWeekdaysParse,a),s!==-1?s:null):e==="dddd"?(s=oe.call(this._weekdaysParse,a),s!==-1||(s=oe.call(this._shortWeekdaysParse,a),s!==-1)?s:(s=oe.call(this._minWeekdaysParse,a),s!==-1?s:null)):e==="ddd"?(s=oe.call(this._shortWeekdaysParse,a),s!==-1||(s=oe.call(this._weekdaysParse,a),s!==-1)?s:(s=oe.call(this._minWeekdaysParse,a),s!==-1?s:null)):(s=oe.call(this._minWeekdaysParse,a),s!==-1||(s=oe.call(this._weekdaysParse,a),s!==-1)?s:(s=oe.call(this._shortWeekdaysParse,a),s!==-1?s:null))}function Jw(t,e,n){var r,s,i;if(this._weekdaysParseExact)return Qw.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(s=mt([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(s,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(s,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(s,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(i="^"+this.weekdays(s,"")+"|^"+this.weekdaysShort(s,"")+"|^"+this.weekdaysMin(s,""),this._weekdaysParse[r]=new RegExp(i.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function Xw(t){if(!this.isValid())return t!=null?this:NaN;var e=Br(this,"Day");return t!=null?(t=Bw(t,this.localeData()),this.add(t-e,"d")):e}function eT(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function tT(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=Yw(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function nT(t){return this._weekdaysParseExact?(z(this,"_weekdaysRegex")||Bu.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(z(this,"_weekdaysRegex")||(this._weekdaysRegex=qw),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function rT(t){return this._weekdaysParseExact?(z(this,"_weekdaysRegex")||Bu.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(z(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=zw),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function sT(t){return this._weekdaysParseExact?(z(this,"_weekdaysRegex")||Bu.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(z(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Hw),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Bu(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],s=[],i,a,o,u,l;for(i=0;i<7;i++)a=mt([2e3,1]).day(i),o=It(this.weekdaysMin(a,"")),u=It(this.weekdaysShort(a,"")),l=It(this.weekdays(a,"")),e.push(o),n.push(u),r.push(l),s.push(o),s.push(u),s.push(l);e.sort(t),n.sort(t),r.sort(t),s.sort(t),this._weekdaysRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Yu(){return this.hours()%12||12}function iT(){return this.hours()||24}R("H",["HH",2],0,"hour");R("h",["hh",2],0,Yu);R("k",["kk",2],0,iT);R("hmm",0,0,function(){return""+Yu.apply(this)+ht(this.minutes(),2)});R("hmmss",0,0,function(){return""+Yu.apply(this)+ht(this.minutes(),2)+ht(this.seconds(),2)});R("Hmm",0,0,function(){return""+this.hours()+ht(this.minutes(),2)});R("Hmmss",0,0,function(){return""+this.hours()+ht(this.minutes(),2)+ht(this.seconds(),2)});function pf(t,e){R(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}pf("a",!0);pf("A",!1);function gf(t,e){return e._meridiemParse}E("a",gf);E("A",gf);E("H",te,Fu);E("h",te,sr);E("k",te,sr);E("HH",te,Ue);E("hh",te,Ue);E("kk",te,Ue);E("hmm",rf);E("hmmss",sf);E("Hmm",rf);E("Hmmss",sf);K(["H","HH"],de);K(["k","kk"],function(t,e,n){var r=B(t);e[de]=r===24?0:r});K(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});K(["h","hh"],function(t,e,n){e[de]=B(t),L(n).bigHour=!0});K("hmm",function(t,e,n){var r=t.length-2;e[de]=B(t.substr(0,r)),e[We]=B(t.substr(r)),L(n).bigHour=!0});K("hmmss",function(t,e,n){var r=t.length-4,s=t.length-2;e[de]=B(t.substr(0,r)),e[We]=B(t.substr(r,2)),e[Et]=B(t.substr(s)),L(n).bigHour=!0});K("Hmm",function(t,e,n){var r=t.length-2;e[de]=B(t.substr(0,r)),e[We]=B(t.substr(r))});K("Hmmss",function(t,e,n){var r=t.length-4,s=t.length-2;e[de]=B(t.substr(0,r)),e[We]=B(t.substr(r,2)),e[Et]=B(t.substr(s))});function aT(t){return(t+"").toLowerCase().charAt(0)==="p"}var oT=/[ap]\.?m?\.?/i,uT=ir("Hours",!0);function lT(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var _f={calendar:Qv,longDateFormat:tw,invalidDate:rw,ordinal:iw,dayOfMonthOrdinalParse:aw,relativeTime:uw,months:Aw,monthsShort:uf,week:Ow,weekdays:$w,weekdaysMin:Ww,weekdaysShort:mf,meridiemParse:oT},re={},lr={},Wr;function cT(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function dc(t){return t&&t.toLowerCase().replace("_","-")}function hT(t){for(var e=0,n,r,s,i;e<t.length;){for(i=dc(t[e]).split("-"),n=i.length,r=dc(t[e+1]),r=r?r.split("-"):null;n>0;){if(s=ra(i.slice(0,n).join("-")),s)return s;if(r&&r.length>=n&&cT(i,r)>=n-1)break;n--}e++}return Wr}function dT(t){return!!(t&&t.match("^[^/\\\\]*$"))}function ra(t){var e=null,n;if(re[t]===void 0&&typeof Ws<"u"&&Ws&&Ws.exports&&dT(t))try{e=Wr._abbr,n=require,n("./locale/"+t),Bt(e)}catch{re[t]=null}return re[t]}function Bt(t,e){var n;return t&&(xe(e)?n=Ct(t):n=$u(t,e),n?Wr=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Wr._abbr}function $u(t,e){if(e!==null){var n,r=_f;if(e.abbr=t,re[t]!=null)Xd("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=re[t]._config;else if(e.parentLocale!=null)if(re[e.parentLocale]!=null)r=re[e.parentLocale]._config;else if(n=ra(e.parentLocale),n!=null)r=n._config;else return lr[e.parentLocale]||(lr[e.parentLocale]=[]),lr[e.parentLocale].push({name:t,config:e}),null;return re[t]=new Mu(lo(r,e)),lr[t]&&lr[t].forEach(function(s){$u(s.name,s.config)}),Bt(t),re[t]}else return delete re[t],null}function fT(t,e){if(e!=null){var n,r,s=_f;re[t]!=null&&re[t].parentLocale!=null?re[t].set(lo(re[t]._config,e)):(r=ra(t),r!=null&&(s=r._config),e=lo(s,e),r==null&&(e.abbr=t),n=new Mu(e),n.parentLocale=re[t],re[t]=n),Bt(t)}else re[t]!=null&&(re[t].parentLocale!=null?(re[t]=re[t].parentLocale,t===Bt()&&Bt(t)):re[t]!=null&&delete re[t]);return re[t]}function Ct(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Wr;if(!Ke(t)){if(e=ra(t),e)return e;t=[t]}return hT(t)}function mT(){return co(re)}function Wu(t){var e,n=t._a;return n&&L(t).overflow===-2&&(e=n[Tt]<0||n[Tt]>11?Tt:n[tt]<1||n[tt]>Uu(n[ke],n[Tt])?tt:n[de]<0||n[de]>24||n[de]===24&&(n[We]!==0||n[Et]!==0||n[rn]!==0)?de:n[We]<0||n[We]>59?We:n[Et]<0||n[Et]>59?Et:n[rn]<0||n[rn]>999?rn:-1,L(t)._overflowDayOfYear&&(e<ke||e>tt)&&(e=tt),L(t)._overflowWeeks&&e===-1&&(e=yw),L(t)._overflowWeekday&&e===-1&&(e=vw),L(t).overflow=e),t}var pT=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gT=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,_T=/Z|[+-]\d\d(?::?\d\d)?/,Ns=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],ka=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],yT=/^\/?Date\((-?\d+)/i,vT=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,wT={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function yf(t){var e,n,r=t._i,s=pT.exec(r)||gT.exec(r),i,a,o,u,l=Ns.length,c=ka.length;if(s){for(L(t).iso=!0,e=0,n=l;e<n;e++)if(Ns[e][1].exec(s[1])){a=Ns[e][0],i=Ns[e][2]!==!1;break}if(a==null){t._isValid=!1;return}if(s[3]){for(e=0,n=c;e<n;e++)if(ka[e][1].exec(s[3])){o=(s[2]||" ")+ka[e][0];break}if(o==null){t._isValid=!1;return}}if(!i&&o!=null){t._isValid=!1;return}if(s[4])if(_T.exec(s[4]))u="Z";else{t._isValid=!1;return}t._f=a+(o||"")+(u||""),zu(t)}else t._isValid=!1}function TT(t,e,n,r,s,i){var a=[ET(t),uf.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(s,10)];return i&&a.push(parseInt(i,10)),a}function ET(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function IT(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function AT(t,e,n){if(t){var r=mf.indexOf(t),s=new Date(e[0],e[1],e[2]).getDay();if(r!==s)return L(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function ST(t,e,n){if(t)return wT[t];if(e)return 0;var r=parseInt(n,10),s=r%100,i=(r-s)/100;return i*60+s}function vf(t){var e=vT.exec(IT(t._i)),n;if(e){if(n=TT(e[4],e[3],e[2],e[5],e[6],e[7]),!AT(e[1],n,t))return;t._a=n,t._tzm=ST(e[8],e[9],e[10]),t._d=Yr.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),L(t).rfc2822=!0}else t._isValid=!1}function RT(t){var e=yT.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(yf(t),t._isValid===!1)delete t._isValid;else return;if(vf(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:v.createFromInputFallback(t)}v.createFromInputFallback=Ye("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Rn(t,e,n){return t??e??n}function kT(t){var e=new Date(v.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function qu(t){var e,n,r=[],s,i,a;if(!t._d){for(s=kT(t),t._w&&t._a[tt]==null&&t._a[Tt]==null&&DT(t),t._dayOfYear!=null&&(a=Rn(t._a[ke],s[ke]),(t._dayOfYear>Ir(a)||t._dayOfYear===0)&&(L(t)._overflowDayOfYear=!0),n=Yr(a,0,t._dayOfYear),t._a[Tt]=n.getUTCMonth(),t._a[tt]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=s[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[de]===24&&t._a[We]===0&&t._a[Et]===0&&t._a[rn]===0&&(t._nextDay=!0,t._a[de]=0),t._d=(t._useUTC?Yr:Vw).apply(null,r),i=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[de]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==i&&(L(t).weekdayMismatch=!0)}}function DT(t){var e,n,r,s,i,a,o,u,l;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(i=1,a=4,n=Rn(e.GG,t._a[ke],$r(ee(),1,4).year),r=Rn(e.W,1),s=Rn(e.E,1),(s<1||s>7)&&(u=!0)):(i=t._locale._week.dow,a=t._locale._week.doy,l=$r(ee(),i,a),n=Rn(e.gg,t._a[ke],l.year),r=Rn(e.w,l.week),e.d!=null?(s=e.d,(s<0||s>6)&&(u=!0)):e.e!=null?(s=e.e+i,(e.e<0||e.e>6)&&(u=!0)):s=i),r<1||r>At(n,i,a)?L(t)._overflowWeeks=!0:u!=null?L(t)._overflowWeekday=!0:(o=ff(n,r,s,i,a),t._a[ke]=o.year,t._dayOfYear=o.dayOfYear)}v.ISO_8601=function(){};v.RFC_2822=function(){};function zu(t){if(t._f===v.ISO_8601){yf(t);return}if(t._f===v.RFC_2822){vf(t);return}t._a=[],L(t).empty=!0;var e=""+t._i,n,r,s,i,a,o=e.length,u=0,l,c;for(s=ef(t._f,t._locale).match(Vu)||[],c=s.length,n=0;n<c;n++)i=s[n],r=(e.match(pw(i,t))||[])[0],r&&(a=e.substr(0,e.indexOf(r)),a.length>0&&L(t).unusedInput.push(a),e=e.slice(e.indexOf(r)+r.length),u+=r.length),Nn[i]?(r?L(t).empty=!1:L(t).unusedTokens.push(i),_w(i,r,t)):t._strict&&!r&&L(t).unusedTokens.push(i);L(t).charsLeftOver=o-u,e.length>0&&L(t).unusedInput.push(e),t._a[de]<=12&&L(t).bigHour===!0&&t._a[de]>0&&(L(t).bigHour=void 0),L(t).parsedDateParts=t._a.slice(0),L(t).meridiem=t._meridiem,t._a[de]=PT(t._locale,t._a[de],t._meridiem),l=L(t).era,l!==null&&(t._a[ke]=t._locale.erasConvertYear(l,t._a[ke])),qu(t),Wu(t)}function PT(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function bT(t){var e,n,r,s,i,a,o=!1,u=t._f.length;if(u===0){L(t).invalidFormat=!0,t._d=new Date(NaN);return}for(s=0;s<u;s++)i=0,a=!1,e=xu({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[s],zu(e),Cu(e)&&(a=!0),i+=L(e).charsLeftOver,i+=L(e).unusedTokens.length*10,L(e).score=i,o?i<r&&(r=i,n=e):(r==null||i<r||a)&&(r=i,n=e,a&&(o=!0));Nt(t,n||e)}function CT(t){if(!t._d){var e=Nu(t._i),n=e.day===void 0?e.date:e.day;t._a=Qd([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),qu(t)}}function xT(t){var e=new ws(Wu(wf(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function wf(t){var e=t._i,n=t._f;return t._locale=t._locale||Ct(t._l),e===null||n===void 0&&e===""?Ki({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Qe(e)?new ws(Wu(e)):(vs(e)?t._d=e:Ke(n)?bT(t):n?zu(t):MT(t),Cu(t)||(t._d=null),t))}function MT(t){var e=t._i;xe(e)?t._d=new Date(v.now()):vs(e)?t._d=new Date(e.valueOf()):typeof e=="string"?RT(t):Ke(e)?(t._a=Qd(e.slice(0),function(n){return parseInt(n,10)}),qu(t)):an(e)?CT(t):Dt(e)?t._d=new Date(e):v.createFromInputFallback(t)}function Tf(t,e,n,r,s){var i={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(an(t)&&bu(t)||Ke(t)&&t.length===0)&&(t=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=s,i._l=n,i._i=t,i._f=e,i._strict=r,xT(i)}function ee(t,e,n,r){return Tf(t,e,n,r,!1)}var VT=Ye("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=ee.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Ki()}),NT=Ye("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=ee.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Ki()});function Ef(t,e){var n,r;if(e.length===1&&Ke(e[0])&&(e=e[0]),!e.length)return ee();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function OT(){var t=[].slice.call(arguments,0);return Ef("isBefore",t)}function LT(){var t=[].slice.call(arguments,0);return Ef("isAfter",t)}var FT=function(){return Date.now?Date.now():+new Date},cr=["year","quarter","month","week","day","hour","minute","second","millisecond"];function UT(t){var e,n=!1,r,s=cr.length;for(e in t)if(z(t,e)&&!(oe.call(cr,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<s;++r)if(t[cr[r]]){if(n)return!1;parseFloat(t[cr[r]])!==B(t[cr[r]])&&(n=!0)}return!0}function jT(){return this._isValid}function BT(){return Xe(NaN)}function sa(t){var e=Nu(t),n=e.year||0,r=e.quarter||0,s=e.month||0,i=e.week||e.isoWeek||0,a=e.day||0,o=e.hour||0,u=e.minute||0,l=e.second||0,c=e.millisecond||0;this._isValid=UT(e),this._milliseconds=+c+l*1e3+u*6e4+o*1e3*60*60,this._days=+a+i*7,this._months=+s+r*3+n*12,this._data={},this._locale=Ct(),this._bubble()}function Bs(t){return t instanceof sa}function fo(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function YT(t,e,n){var r=Math.min(t.length,e.length),s=Math.abs(t.length-e.length),i=0,a;for(a=0;a<r;a++)B(t[a])!==B(e[a])&&i++;return i+s}function If(t,e){R(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+ht(~~(n/60),2)+e+ht(~~n%60,2)})}If("Z",":");If("ZZ","");E("Z",ta);E("ZZ",ta);K(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=Hu(ta,t)});var $T=/([\+\-]|\d\d)/gi;function Hu(t,e){var n=(e||"").match(t),r,s,i;return n===null?null:(r=n[n.length-1]||[],s=(r+"").match($T)||["-",0,0],i=+(s[1]*60)+B(s[2]),i===0?0:s[0]==="+"?i:-i)}function Gu(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(Qe(t)||vs(t)?t.valueOf():ee(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),v.updateOffset(n,!1),n):ee(t).local()}function mo(t){return-Math.round(t._d.getTimezoneOffset())}v.updateOffset=function(){};function WT(t,e,n){var r=this._offset||0,s;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=Hu(ta,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(s=mo(this)),this._offset=t,this._isUTC=!0,s!=null&&this.add(s,"m"),r!==t&&(!e||this._changeInProgress?Rf(this,Xe(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,v.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:mo(this)}function qT(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function zT(t){return this.utcOffset(0,t)}function HT(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(mo(this),"m")),this}function GT(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=Hu(fw,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function ZT(t){return this.isValid()?(t=t?ee(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function KT(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function QT(){if(!xe(this._isDSTShifted))return this._isDSTShifted;var t={},e;return xu(t,this),t=wf(t),t._a?(e=t._isUTC?mt(t._a):ee(t._a),this._isDSTShifted=this.isValid()&&YT(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function JT(){return this.isValid()?!this._isUTC:!1}function XT(){return this.isValid()?this._isUTC:!1}function Af(){return this.isValid()?this._isUTC&&this._offset===0:!1}var e0=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,t0=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Xe(t,e){var n=t,r=null,s,i,a;return Bs(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Dt(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=e0.exec(t))?(s=r[1]==="-"?-1:1,n={y:0,d:B(r[tt])*s,h:B(r[de])*s,m:B(r[We])*s,s:B(r[Et])*s,ms:B(fo(r[rn]*1e3))*s}):(r=t0.exec(t))?(s=r[1]==="-"?-1:1,n={y:Jt(r[2],s),M:Jt(r[3],s),w:Jt(r[4],s),d:Jt(r[5],s),h:Jt(r[6],s),m:Jt(r[7],s),s:Jt(r[8],s)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(a=n0(ee(n.from),ee(n.to)),n={},n.ms=a.milliseconds,n.M=a.months),i=new sa(n),Bs(t)&&z(t,"_locale")&&(i._locale=t._locale),Bs(t)&&z(t,"_isValid")&&(i._isValid=t._isValid),i}Xe.fn=sa.prototype;Xe.invalid=BT;function Jt(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function fc(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function n0(t,e){var n;return t.isValid()&&e.isValid()?(e=Gu(e,t),t.isBefore(e)?n=fc(t,e):(n=fc(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function Sf(t,e){return function(n,r){var s,i;return r!==null&&!isNaN(+r)&&(Xd(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=r,r=i),s=Xe(n,r),Rf(this,s,t),this}}function Rf(t,e,n,r){var s=e._milliseconds,i=fo(e._days),a=fo(e._months);t.isValid()&&(r=r??!0,a&&cf(t,Br(t,"Month")+a*n),i&&of(t,"Date",Br(t,"Date")+i*n),s&&t._d.setTime(t._d.valueOf()+s*n),r&&v.updateOffset(t,i||a))}var r0=Sf(1,"add"),s0=Sf(-1,"subtract");function kf(t){return typeof t=="string"||t instanceof String}function i0(t){return Qe(t)||vs(t)||kf(t)||Dt(t)||o0(t)||a0(t)||t===null||t===void 0}function a0(t){var e=an(t)&&!bu(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],s,i,a=r.length;for(s=0;s<a;s+=1)i=r[s],n=n||z(t,i);return e&&n}function o0(t){var e=Ke(t),n=!1;return e&&(n=t.filter(function(r){return!Dt(r)&&kf(t)}).length===0),e&&n}function u0(t){var e=an(t)&&!bu(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],s,i;for(s=0;s<r.length;s+=1)i=r[s],n=n||z(t,i);return e&&n}function l0(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function c0(t,e){arguments.length===1&&(arguments[0]?i0(arguments[0])?(t=arguments[0],e=void 0):u0(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||ee(),r=Gu(n,this).startOf("day"),s=v.calendarFormat(this,r)||"sameElse",i=e&&(pt(e[s])?e[s].call(this,n):e[s]);return this.format(i||this.localeData().calendar(s,this,ee(n)))}function h0(){return new ws(this)}function d0(t,e){var n=Qe(t)?t:ee(t);return this.isValid()&&n.isValid()?(e=$e(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function f0(t,e){var n=Qe(t)?t:ee(t);return this.isValid()&&n.isValid()?(e=$e(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function m0(t,e,n,r){var s=Qe(t)?t:ee(t),i=Qe(e)?e:ee(e);return this.isValid()&&s.isValid()&&i.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(s,n):!this.isBefore(s,n))&&(r[1]===")"?this.isBefore(i,n):!this.isAfter(i,n))):!1}function p0(t,e){var n=Qe(t)?t:ee(t),r;return this.isValid()&&n.isValid()?(e=$e(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function g0(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function _0(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function y0(t,e,n){var r,s,i;if(!this.isValid())return NaN;if(r=Gu(t,this),!r.isValid())return NaN;switch(s=(r.utcOffset()-this.utcOffset())*6e4,e=$e(e),e){case"year":i=Ys(this,r)/12;break;case"month":i=Ys(this,r);break;case"quarter":i=Ys(this,r)/3;break;case"second":i=(this-r)/1e3;break;case"minute":i=(this-r)/6e4;break;case"hour":i=(this-r)/36e5;break;case"day":i=(this-r-s)/864e5;break;case"week":i=(this-r-s)/6048e5;break;default:i=this-r}return n?i:je(i)}function Ys(t,e){if(t.date()<e.date())return-Ys(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),s,i;return e-r<0?(s=t.clone().add(n-1,"months"),i=(e-r)/(r-s)):(s=t.clone().add(n+1,"months"),i=(e-r)/(s-r)),-(n+i)||0}v.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";v.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function v0(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function w0(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?js(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):pt(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",js(n,"Z")):js(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function T0(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,s,i;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",s="-MM-DD[T]HH:mm:ss.SSS",i=e+'[")]',this.format(n+r+s+i)}function E0(t){t||(t=this.isUtc()?v.defaultFormatUtc:v.defaultFormat);var e=js(this,t);return this.localeData().postformat(e)}function I0(t,e){return this.isValid()&&(Qe(t)&&t.isValid()||ee(t).isValid())?Xe({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function A0(t){return this.from(ee(),t)}function S0(t,e){return this.isValid()&&(Qe(t)&&t.isValid()||ee(t).isValid())?Xe({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function R0(t){return this.to(ee(),t)}function Df(t){var e;return t===void 0?this._locale._abbr:(e=Ct(t),e!=null&&(this._locale=e),this)}var Pf=Ye("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function bf(){return this._locale}var ci=1e3,On=60*ci,hi=60*On,Cf=(365*400+97)*24*hi;function Ln(t,e){return(t%e+e)%e}function xf(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-Cf:new Date(t,e,n).valueOf()}function Mf(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-Cf:Date.UTC(t,e,n)}function k0(t){var e,n;if(t=$e(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?Mf:xf,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Ln(e+(this._isUTC?0:this.utcOffset()*On),hi);break;case"minute":e=this._d.valueOf(),e-=Ln(e,On);break;case"second":e=this._d.valueOf(),e-=Ln(e,ci);break}return this._d.setTime(e),v.updateOffset(this,!0),this}function D0(t){var e,n;if(t=$e(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?Mf:xf,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=hi-Ln(e+(this._isUTC?0:this.utcOffset()*On),hi)-1;break;case"minute":e=this._d.valueOf(),e+=On-Ln(e,On)-1;break;case"second":e=this._d.valueOf(),e+=ci-Ln(e,ci)-1;break}return this._d.setTime(e),v.updateOffset(this,!0),this}function P0(){return this._d.valueOf()-(this._offset||0)*6e4}function b0(){return Math.floor(this.valueOf()/1e3)}function C0(){return new Date(this.valueOf())}function x0(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function M0(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function V0(){return this.isValid()?this.toISOString():null}function N0(){return Cu(this)}function O0(){return Nt({},L(this))}function L0(){return L(this).overflow}function F0(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}R("N",0,0,"eraAbbr");R("NN",0,0,"eraAbbr");R("NNN",0,0,"eraAbbr");R("NNNN",0,0,"eraName");R("NNNNN",0,0,"eraNarrow");R("y",["y",1],"yo","eraYear");R("y",["yy",2],0,"eraYear");R("y",["yyy",3],0,"eraYear");R("y",["yyyy",4],0,"eraYear");E("N",Zu);E("NN",Zu);E("NNN",Zu);E("NNNN",Z0);E("NNNNN",K0);K(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var s=n._locale.erasParse(t,r,n._strict);s?L(n).era=s:L(n).invalidEra=t});E("y",rr);E("yy",rr);E("yyy",rr);E("yyyy",rr);E("yo",Q0);K(["y","yy","yyy","yyyy"],ke);K(["yo"],function(t,e,n,r){var s;n._locale._eraYearOrdinalRegex&&(s=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[ke]=n._locale.eraYearOrdinalParse(t,s):e[ke]=parseInt(t,10)});function U0(t,e){var n,r,s,i=this._eras||Ct("en")._eras;for(n=0,r=i.length;n<r;++n){switch(typeof i[n].since){case"string":s=v(i[n].since).startOf("day"),i[n].since=s.valueOf();break}switch(typeof i[n].until){case"undefined":i[n].until=1/0;break;case"string":s=v(i[n].until).startOf("day").valueOf(),i[n].until=s.valueOf();break}}return i}function j0(t,e,n){var r,s,i=this.eras(),a,o,u;for(t=t.toUpperCase(),r=0,s=i.length;r<s;++r)if(a=i[r].name.toUpperCase(),o=i[r].abbr.toUpperCase(),u=i[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(o===t)return i[r];break;case"NNNN":if(a===t)return i[r];break;case"NNNNN":if(u===t)return i[r];break}else if([a,o,u].indexOf(t)>=0)return i[r]}function B0(t,e){var n=t.since<=t.until?1:-1;return e===void 0?v(t.since).year():v(t.since).year()+(e-t.offset)*n}function Y0(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function $0(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function W0(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function q0(){var t,e,n,r,s=this.localeData().eras();for(t=0,e=s.length;t<e;++t)if(n=s[t].since<=s[t].until?1:-1,r=this.clone().startOf("day").valueOf(),s[t].since<=r&&r<=s[t].until||s[t].until<=r&&r<=s[t].since)return(this.year()-v(s[t].since).year())*n+s[t].offset;return this.year()}function z0(t){return z(this,"_erasNameRegex")||Ku.call(this),t?this._erasNameRegex:this._erasRegex}function H0(t){return z(this,"_erasAbbrRegex")||Ku.call(this),t?this._erasAbbrRegex:this._erasRegex}function G0(t){return z(this,"_erasNarrowRegex")||Ku.call(this),t?this._erasNarrowRegex:this._erasRegex}function Zu(t,e){return e.erasAbbrRegex(t)}function Z0(t,e){return e.erasNameRegex(t)}function K0(t,e){return e.erasNarrowRegex(t)}function Q0(t,e){return e._eraYearOrdinalRegex||rr}function Ku(){var t=[],e=[],n=[],r=[],s,i,a,o,u,l=this.eras();for(s=0,i=l.length;s<i;++s)a=It(l[s].name),o=It(l[s].abbr),u=It(l[s].narrow),e.push(a),t.push(o),n.push(u),r.push(a),r.push(o),r.push(u);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}R(0,["gg",2],0,function(){return this.weekYear()%100});R(0,["GG",2],0,function(){return this.isoWeekYear()%100});function ia(t,e){R(0,[t,t.length],0,e)}ia("gggg","weekYear");ia("ggggg","weekYear");ia("GGGG","isoWeekYear");ia("GGGGG","isoWeekYear");E("G",ea);E("g",ea);E("GG",te,Ue);E("gg",te,Ue);E("GGGG",Lu,Ou);E("gggg",Lu,Ou);E("GGGGG",Xi,Qi);E("ggggg",Xi,Qi);Es(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=B(t)});Es(["gg","GG"],function(t,e,n,r){e[r]=v.parseTwoDigitYear(t)});function J0(t){return Vf.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function X0(t){return Vf.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function eE(){return At(this.year(),1,4)}function tE(){return At(this.isoWeekYear(),1,4)}function nE(){var t=this.localeData()._week;return At(this.year(),t.dow,t.doy)}function rE(){var t=this.localeData()._week;return At(this.weekYear(),t.dow,t.doy)}function Vf(t,e,n,r,s){var i;return t==null?$r(this,r,s).year:(i=At(t,r,s),e>i&&(e=i),sE.call(this,t,e,n,r,s))}function sE(t,e,n,r,s){var i=ff(t,e,n,r,s),a=Yr(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}R("Q",0,"Qo","quarter");E("Q",tf);K("Q",function(t,e){e[Tt]=(B(t)-1)*3});function iE(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}R("D",["DD",2],"Do","date");E("D",te,sr);E("DD",te,Ue);E("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});K(["D","DD"],tt);K("Do",function(t,e){e[tt]=B(t.match(te)[0])});var Nf=ir("Date",!0);R("DDD",["DDDD",3],"DDDo","dayOfYear");E("DDD",Ji);E("DDDD",nf);K(["DDD","DDDD"],function(t,e,n){n._dayOfYear=B(t)});function aE(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}R("m",["mm",2],0,"minute");E("m",te,Fu);E("mm",te,Ue);K(["m","mm"],We);var oE=ir("Minutes",!1);R("s",["ss",2],0,"second");E("s",te,Fu);E("ss",te,Ue);K(["s","ss"],Et);var uE=ir("Seconds",!1);R("S",0,0,function(){return~~(this.millisecond()/100)});R(0,["SS",2],0,function(){return~~(this.millisecond()/10)});R(0,["SSS",3],0,"millisecond");R(0,["SSSS",4],0,function(){return this.millisecond()*10});R(0,["SSSSS",5],0,function(){return this.millisecond()*100});R(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});R(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});R(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});R(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});E("S",Ji,tf);E("SS",Ji,Ue);E("SSS",Ji,nf);var Ot,Of;for(Ot="SSSS";Ot.length<=9;Ot+="S")E(Ot,rr);function lE(t,e){e[rn]=B(("0."+t)*1e3)}for(Ot="S";Ot.length<=9;Ot+="S")K(Ot,lE);Of=ir("Milliseconds",!1);R("z",0,0,"zoneAbbr");R("zz",0,0,"zoneName");function cE(){return this._isUTC?"UTC":""}function hE(){return this._isUTC?"Coordinated Universal Time":""}var _=ws.prototype;_.add=r0;_.calendar=c0;_.clone=h0;_.diff=y0;_.endOf=D0;_.format=E0;_.from=I0;_.fromNow=A0;_.to=S0;_.toNow=R0;_.get=Tw;_.invalidAt=L0;_.isAfter=d0;_.isBefore=f0;_.isBetween=m0;_.isSame=p0;_.isSameOrAfter=g0;_.isSameOrBefore=_0;_.isValid=N0;_.lang=Pf;_.locale=Df;_.localeData=bf;_.max=NT;_.min=VT;_.parsingFlags=O0;_.set=Ew;_.startOf=k0;_.subtract=s0;_.toArray=x0;_.toObject=M0;_.toDate=C0;_.toISOString=w0;_.inspect=T0;typeof Symbol<"u"&&Symbol.for!=null&&(_[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});_.toJSON=V0;_.toString=v0;_.unix=b0;_.valueOf=P0;_.creationData=F0;_.eraName=Y0;_.eraNarrow=$0;_.eraAbbr=W0;_.eraYear=q0;_.year=af;_.isLeapYear=ww;_.weekYear=J0;_.isoWeekYear=X0;_.quarter=_.quarters=iE;_.month=hf;_.daysInMonth=Cw;_.week=_.weeks=Uw;_.isoWeek=_.isoWeeks=jw;_.weeksInYear=nE;_.weeksInWeekYear=rE;_.isoWeeksInYear=eE;_.isoWeeksInISOWeekYear=tE;_.date=Nf;_.day=_.days=Xw;_.weekday=eT;_.isoWeekday=tT;_.dayOfYear=aE;_.hour=_.hours=uT;_.minute=_.minutes=oE;_.second=_.seconds=uE;_.millisecond=_.milliseconds=Of;_.utcOffset=WT;_.utc=zT;_.local=HT;_.parseZone=GT;_.hasAlignedHourOffset=ZT;_.isDST=KT;_.isLocal=JT;_.isUtcOffset=XT;_.isUtc=Af;_.isUTC=Af;_.zoneAbbr=cE;_.zoneName=hE;_.dates=Ye("dates accessor is deprecated. Use date instead.",Nf);_.months=Ye("months accessor is deprecated. Use month instead",hf);_.years=Ye("years accessor is deprecated. Use year instead",af);_.zone=Ye("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",qT);_.isDSTShifted=Ye("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",QT);function dE(t){return ee(t*1e3)}function fE(){return ee.apply(null,arguments).parseZone()}function Lf(t){return t}var H=Mu.prototype;H.calendar=Jv;H.longDateFormat=nw;H.invalidDate=sw;H.ordinal=ow;H.preparse=Lf;H.postformat=Lf;H.relativeTime=lw;H.pastFuture=cw;H.set=Kv;H.eras=U0;H.erasParse=j0;H.erasConvertYear=B0;H.erasAbbrRegex=H0;H.erasNameRegex=z0;H.erasNarrowRegex=G0;H.months=kw;H.monthsShort=Dw;H.monthsParse=bw;H.monthsRegex=Mw;H.monthsShortRegex=xw;H.week=Nw;H.firstDayOfYear=Fw;H.firstDayOfWeek=Lw;H.weekdays=Gw;H.weekdaysMin=Kw;H.weekdaysShort=Zw;H.weekdaysParse=Jw;H.weekdaysRegex=nT;H.weekdaysShortRegex=rT;H.weekdaysMinRegex=sT;H.isPM=aT;H.meridiem=lT;function di(t,e,n,r){var s=Ct(),i=mt().set(r,e);return s[n](i,t)}function Ff(t,e,n){if(Dt(t)&&(e=t,t=void 0),t=t||"",e!=null)return di(t,e,n,"month");var r,s=[];for(r=0;r<12;r++)s[r]=di(t,r,n,"month");return s}function Qu(t,e,n,r){typeof t=="boolean"?(Dt(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Dt(e)&&(n=e,e=void 0),e=e||"");var s=Ct(),i=t?s._week.dow:0,a,o=[];if(n!=null)return di(e,(n+i)%7,r,"day");for(a=0;a<7;a++)o[a]=di(e,(a+i)%7,r,"day");return o}function mE(t,e){return Ff(t,e,"months")}function pE(t,e){return Ff(t,e,"monthsShort")}function gE(t,e,n){return Qu(t,e,n,"weekdays")}function _E(t,e,n){return Qu(t,e,n,"weekdaysShort")}function yE(t,e,n){return Qu(t,e,n,"weekdaysMin")}Bt("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=B(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});v.lang=Ye("moment.lang is deprecated. Use moment.locale instead.",Bt);v.langData=Ye("moment.langData is deprecated. Use moment.localeData instead.",Ct);var _t=Math.abs;function vE(){var t=this._data;return this._milliseconds=_t(this._milliseconds),this._days=_t(this._days),this._months=_t(this._months),t.milliseconds=_t(t.milliseconds),t.seconds=_t(t.seconds),t.minutes=_t(t.minutes),t.hours=_t(t.hours),t.months=_t(t.months),t.years=_t(t.years),this}function Uf(t,e,n,r){var s=Xe(e,n);return t._milliseconds+=r*s._milliseconds,t._days+=r*s._days,t._months+=r*s._months,t._bubble()}function wE(t,e){return Uf(this,t,e,1)}function TE(t,e){return Uf(this,t,e,-1)}function mc(t){return t<0?Math.floor(t):Math.ceil(t)}function EE(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,s,i,a,o,u;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=mc(po(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,s=je(t/1e3),r.seconds=s%60,i=je(s/60),r.minutes=i%60,a=je(i/60),r.hours=a%24,e+=je(a/24),u=je(jf(e)),n+=u,e-=mc(po(u)),o=je(n/12),n%=12,r.days=e,r.months=n,r.years=o,this}function jf(t){return t*4800/146097}function po(t){return t*146097/4800}function IE(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=$e(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+jf(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(po(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function xt(t){return function(){return this.as(t)}}var Bf=xt("ms"),AE=xt("s"),SE=xt("m"),RE=xt("h"),kE=xt("d"),DE=xt("w"),PE=xt("M"),bE=xt("Q"),CE=xt("y"),xE=Bf;function ME(){return Xe(this)}function VE(t){return t=$e(t),this.isValid()?this[t+"s"]():NaN}function yn(t){return function(){return this.isValid()?this._data[t]:NaN}}var NE=yn("milliseconds"),OE=yn("seconds"),LE=yn("minutes"),FE=yn("hours"),UE=yn("days"),jE=yn("months"),BE=yn("years");function YE(){return je(this.days()/7)}var vt=Math.round,Pn={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function $E(t,e,n,r,s){return s.relativeTime(e||1,!!n,t,r)}function WE(t,e,n,r){var s=Xe(t).abs(),i=vt(s.as("s")),a=vt(s.as("m")),o=vt(s.as("h")),u=vt(s.as("d")),l=vt(s.as("M")),c=vt(s.as("w")),h=vt(s.as("y")),d=i<=n.ss&&["s",i]||i<n.s&&["ss",i]||a<=1&&["m"]||a<n.m&&["mm",a]||o<=1&&["h"]||o<n.h&&["hh",o]||u<=1&&["d"]||u<n.d&&["dd",u];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||l<=1&&["M"]||l<n.M&&["MM",l]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,$E.apply(null,d)}function qE(t){return t===void 0?vt:typeof t=="function"?(vt=t,!0):!1}function zE(t,e){return Pn[t]===void 0?!1:e===void 0?Pn[t]:(Pn[t]=e,t==="s"&&(Pn.ss=e-1),!0)}function HE(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Pn,s,i;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Pn,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),s=this.localeData(),i=WE(this,!n,r,s),n&&(i=s.pastFuture(+this,i)),s.postformat(i)}var Da=Math.abs;function En(t){return(t>0)-(t<0)||+t}function aa(){if(!this.isValid())return this.localeData().invalidDate();var t=Da(this._milliseconds)/1e3,e=Da(this._days),n=Da(this._months),r,s,i,a,o=this.asSeconds(),u,l,c,h;return o?(r=je(t/60),s=je(r/60),t%=60,r%=60,i=je(n/12),n%=12,a=t?t.toFixed(3).replace(/\.?0+$/,""):"",u=o<0?"-":"",l=En(this._months)!==En(o)?"-":"",c=En(this._days)!==En(o)?"-":"",h=En(this._milliseconds)!==En(o)?"-":"",u+"P"+(i?l+i+"Y":"")+(n?l+n+"M":"")+(e?c+e+"D":"")+(s||r||t?"T":"")+(s?h+s+"H":"")+(r?h+r+"M":"")+(t?h+a+"S":"")):"P0D"}var W=sa.prototype;W.isValid=jT;W.abs=vE;W.add=wE;W.subtract=TE;W.as=IE;W.asMilliseconds=Bf;W.asSeconds=AE;W.asMinutes=SE;W.asHours=RE;W.asDays=kE;W.asWeeks=DE;W.asMonths=PE;W.asQuarters=bE;W.asYears=CE;W.valueOf=xE;W._bubble=EE;W.clone=ME;W.get=VE;W.milliseconds=NE;W.seconds=OE;W.minutes=LE;W.hours=FE;W.days=UE;W.weeks=YE;W.months=jE;W.years=BE;W.humanize=HE;W.toISOString=aa;W.toString=aa;W.toJSON=aa;W.locale=Df;W.localeData=bf;W.toIsoString=Ye("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",aa);W.lang=Pf;R("X",0,0,"unix");R("x",0,0,"valueOf");E("x",ea);E("X",mw);K("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});K("x",function(t,e,n){n._d=new Date(B(t))});//! moment.js
v.version="2.30.1";Gv(ee);v.fn=_;v.min=OT;v.max=LT;v.now=FT;v.utc=mt;v.unix=dE;v.months=mE;v.isDate=vs;v.locale=Bt;v.invalid=Ki;v.duration=Xe;v.isMoment=Qe;v.weekdays=gE;v.parseZone=fE;v.localeData=Ct;v.isDuration=Bs;v.monthsShort=pE;v.weekdaysMin=yE;v.defineLocale=$u;v.updateLocale=fT;v.locales=mT;v.weekdaysShort=_E;v.normalizeUnits=$e;v.relativeTimeRounding=qE;v.relativeTimeThreshold=zE;v.calendarFormat=l0;v.prototype=_;v.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function GE(t){return`<li class="li_list">
            
            <div class="${t.done?"date_todo done":"date_todo"}">
            
            <span>${t.date}</span>
            </div>
            <div class="content">
                <button class="${t.done?"done_todo active":"done_todo"}" data-done="${t.done}" data-id="${t.id}">
                    <i class="material-symbols-outlined">${t.done?"check_box":"check_box_outline_blank"}</i>
                </button>
                <input type="text" data-id="${t.id}" value="${t.content}" class="${t.done?"done input_content_show":"input_content_show"}" readonly>
                
  </div>
  <div class="time">
    <span>${v(t.date).format("HH:mm:ss")}</span>
  </div>
  <div class="actions">
      <button class="delete_todo" data-id="${t.id}">
        <i class="material-symbols-outlined"> delete </i>
      </button>
      <button class="show_todo" data-content="${t.content}" data-date="${t.date}">
        <i class="material-symbols-outlined"> calendar_month </i>
      </button>
      <button class="update_todo_btn" data-id="${t.id}" data-content="${t.content}">
          <i class="material-symbols-outlined"> edit_square </i>
      </button>
  </div>
</li>

`}var $;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),a={};for(const o of i)a[o]=s[o];return t.objectValues(a)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},t.find=(s,i)=>{for(const a of s)if(i(a))return a},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})($||($={}));var go;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(go||(go={}));const T=$.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Mt=t=>{switch(typeof t){case"undefined":return T.undefined;case"string":return T.string;case"number":return isNaN(t)?T.nan:T.number;case"boolean":return T.boolean;case"function":return T.function;case"bigint":return T.bigint;case"symbol":return T.symbol;case"object":return Array.isArray(t)?T.array:t===null?T.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?T.promise:typeof Map<"u"&&t instanceof Map?T.map:typeof Set<"u"&&t instanceof Set?T.set:typeof Date<"u"&&t instanceof Date?T.date:T.object;default:return T.unknown}},g=$.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),ZE=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class Le extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let o=r,u=0;for(;u<a.path.length;){const l=a.path[u];u===a.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(n(a))):o[l]=o[l]||{_errors:[]},o=o[l],u++}}};return s(this),r}static assert(e){if(!(e instanceof Le))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,$.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Le.create=t=>new Le(t);const Hn=(t,e)=>{let n;switch(t.code){case g.invalid_type:t.received===T.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case g.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,$.jsonStringifyReplacer)}`;break;case g.unrecognized_keys:n=`Unrecognized key(s) in object: ${$.joinValues(t.keys,", ")}`;break;case g.invalid_union:n="Invalid input";break;case g.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${$.joinValues(t.options)}`;break;case g.invalid_enum_value:n=`Invalid enum value. Expected ${$.joinValues(t.options)}, received '${t.received}'`;break;case g.invalid_arguments:n="Invalid function arguments";break;case g.invalid_return_type:n="Invalid function return type";break;case g.invalid_date:n="Invalid date";break;case g.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:$.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case g.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case g.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case g.custom:n="Invalid input";break;case g.invalid_intersection_types:n="Intersection results could not be merged";break;case g.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case g.not_finite:n="Number must be finite";break;default:n=e.defaultError,$.assertNever(t)}return{message:n}};let Yf=Hn;function KE(t){Yf=t}function fi(){return Yf}const mi=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,i=[...n,...s.path||[]],a={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="";const u=r.filter(l=>!!l).slice().reverse();for(const l of u)o=l(a,{data:e,defaultError:o}).message;return{...s,path:i,message:o}},QE=[];function w(t,e){const n=fi(),r=mi({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===Hn?void 0:Hn].filter(s=>!!s)});t.common.issues.push(r)}class Pe{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return b;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n){const i=await s.key,a=await s.value;r.push({key:i,value:a})}return Pe.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return b;i.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(r[i.value]=a.value)}return{status:e.value,value:r}}}const b=Object.freeze({status:"aborted"}),bn=t=>({status:"dirty",value:t}),Ce=t=>({status:"valid",value:t}),_o=t=>t.status==="aborted",yo=t=>t.status==="dirty",qr=t=>t.status==="valid",zr=t=>typeof Promise<"u"&&t instanceof Promise;function pi(t,e,n,r){if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function $f(t,e,n,r,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}var S;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(S||(S={}));var gr,_r;class dt{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const pc=(t,e)=>{if(qr(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Le(t.common.issues);return this._error=n,this._error}}};function O(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(a,o)=>{var u,l;const{message:c}=t;return a.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:(u=c??r)!==null&&u!==void 0?u:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(l=c??n)!==null&&l!==void 0?l:o.defaultError}},description:s}}class U{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Mt(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Mt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Pe,ctx:{common:e.parent.common,data:e.data,parsedType:Mt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(zr(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const s={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Mt(e)},i=this._parseSync({data:e,path:s.path,parent:s});return pc(s,i)}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Mt(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(zr(s)?s:Promise.resolve(s));return pc(r,i)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const a=e(s),o=()=>i.addIssue({code:g.custom,...r(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(u=>u?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new Je({schema:this,typeName:P.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return ut.create(this,this._def)}nullable(){return Gt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return He.create(this,this._def)}promise(){return Zn.create(this,this._def)}or(e){return Kr.create([this,e],this._def)}and(e){return Qr.create(this,e,this._def)}transform(e){return new Je({...O(this._def),schema:this,typeName:P.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new ns({...O(this._def),innerType:this,defaultValue:n,typeName:P.ZodDefault})}brand(){return new Ju({typeName:P.ZodBranded,type:this,...O(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new rs({...O(this._def),innerType:this,catchValue:n,typeName:P.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return Is.create(this,e)}readonly(){return ss.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const JE=/^c[^\s-]{8,}$/i,XE=/^[0-9a-z]+$/,eI=/^[0-9A-HJKMNP-TV-Z]{26}$/,tI=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,nI=/^[a-z0-9_-]{21}$/i,rI=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,sI=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,iI="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Pa;const aI=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,oI=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,uI=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Wf="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",lI=new RegExp(`^${Wf}$`);function qf(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function cI(t){return new RegExp(`^${qf(t)}$`)}function zf(t){let e=`${Wf}T${qf(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function hI(t,e){return!!((e==="v4"||!e)&&aI.test(t)||(e==="v6"||!e)&&oI.test(t))}class qe extends U{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==T.string){const i=this._getOrReturnCtx(e);return w(i,{code:g.invalid_type,expected:T.string,received:i.parsedType}),b}const r=new Pe;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),w(s,{code:g.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),w(s,{code:g.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const a=e.data.length>i.value,o=e.data.length<i.value;(a||o)&&(s=this._getOrReturnCtx(e,s),a?w(s,{code:g.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&w(s,{code:g.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")sI.test(e.data)||(s=this._getOrReturnCtx(e,s),w(s,{validation:"email",code:g.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")Pa||(Pa=new RegExp(iI,"u")),Pa.test(e.data)||(s=this._getOrReturnCtx(e,s),w(s,{validation:"emoji",code:g.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")tI.test(e.data)||(s=this._getOrReturnCtx(e,s),w(s,{validation:"uuid",code:g.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")nI.test(e.data)||(s=this._getOrReturnCtx(e,s),w(s,{validation:"nanoid",code:g.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")JE.test(e.data)||(s=this._getOrReturnCtx(e,s),w(s,{validation:"cuid",code:g.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")XE.test(e.data)||(s=this._getOrReturnCtx(e,s),w(s,{validation:"cuid2",code:g.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")eI.test(e.data)||(s=this._getOrReturnCtx(e,s),w(s,{validation:"ulid",code:g.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),w(s,{validation:"url",code:g.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),w(s,{validation:"regex",code:g.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),w(s,{code:g.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),w(s,{code:g.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),w(s,{code:g.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?zf(i).test(e.data)||(s=this._getOrReturnCtx(e,s),w(s,{code:g.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?lI.test(e.data)||(s=this._getOrReturnCtx(e,s),w(s,{code:g.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?cI(i).test(e.data)||(s=this._getOrReturnCtx(e,s),w(s,{code:g.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?rI.test(e.data)||(s=this._getOrReturnCtx(e,s),w(s,{validation:"duration",code:g.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?hI(e.data,i.version)||(s=this._getOrReturnCtx(e,s),w(s,{validation:"ip",code:g.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?uI.test(e.data)||(s=this._getOrReturnCtx(e,s),w(s,{validation:"base64",code:g.invalid_string,message:i.message}),r.dirty()):$.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:g.invalid_string,...S.errToObj(r)})}_addCheck(e){return new qe({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...S.errToObj(e)})}url(e){return this._addCheck({kind:"url",...S.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...S.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...S.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...S.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...S.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...S.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...S.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...S.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...S.errToObj(e)})}datetime(e){var n,r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,local:(r=e==null?void 0:e.local)!==null&&r!==void 0?r:!1,...S.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...S.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...S.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...S.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...S.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...S.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...S.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...S.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...S.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...S.errToObj(n)})}nonempty(e){return this.min(1,S.errToObj(e))}trim(){return new qe({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new qe({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new qe({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}qe.create=t=>{var e;return new qe({checks:[],typeName:P.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...O(t)})};function dI(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,i=parseInt(t.toFixed(s).replace(".","")),a=parseInt(e.toFixed(s).replace(".",""));return i%a/Math.pow(10,s)}class qt extends U{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==T.number){const i=this._getOrReturnCtx(e);return w(i,{code:g.invalid_type,expected:T.number,received:i.parsedType}),b}let r;const s=new Pe;for(const i of this._def.checks)i.kind==="int"?$.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{code:g.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),w(r,{code:g.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),w(r,{code:g.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?dI(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),w(r,{code:g.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{code:g.not_finite,message:i.message}),s.dirty()):$.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,S.toString(n))}gt(e,n){return this.setLimit("min",e,!1,S.toString(n))}lte(e,n){return this.setLimit("max",e,!0,S.toString(n))}lt(e,n){return this.setLimit("max",e,!1,S.toString(n))}setLimit(e,n,r,s){return new qt({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:S.toString(s)}]})}_addCheck(e){return new qt({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:S.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:S.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:S.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:S.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:S.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:S.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:S.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:S.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:S.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&$.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}qt.create=t=>new qt({checks:[],typeName:P.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...O(t)});class zt extends U{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==T.bigint){const i=this._getOrReturnCtx(e);return w(i,{code:g.invalid_type,expected:T.bigint,received:i.parsedType}),b}let r;const s=new Pe;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),w(r,{code:g.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),w(r,{code:g.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),w(r,{code:g.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):$.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,S.toString(n))}gt(e,n){return this.setLimit("min",e,!1,S.toString(n))}lte(e,n){return this.setLimit("max",e,!0,S.toString(n))}lt(e,n){return this.setLimit("max",e,!1,S.toString(n))}setLimit(e,n,r,s){return new zt({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:S.toString(s)}]})}_addCheck(e){return new zt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:S.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:S.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:S.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:S.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:S.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}zt.create=t=>{var e;return new zt({checks:[],typeName:P.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...O(t)})};class Hr extends U{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==T.boolean){const r=this._getOrReturnCtx(e);return w(r,{code:g.invalid_type,expected:T.boolean,received:r.parsedType}),b}return Ce(e.data)}}Hr.create=t=>new Hr({typeName:P.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...O(t)});class fn extends U{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==T.date){const i=this._getOrReturnCtx(e);return w(i,{code:g.invalid_type,expected:T.date,received:i.parsedType}),b}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return w(i,{code:g.invalid_date}),b}const r=new Pe;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),w(s,{code:g.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),w(s,{code:g.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):$.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new fn({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:S.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:S.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}fn.create=t=>new fn({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:P.ZodDate,...O(t)});class gi extends U{_parse(e){if(this._getType(e)!==T.symbol){const r=this._getOrReturnCtx(e);return w(r,{code:g.invalid_type,expected:T.symbol,received:r.parsedType}),b}return Ce(e.data)}}gi.create=t=>new gi({typeName:P.ZodSymbol,...O(t)});class Gr extends U{_parse(e){if(this._getType(e)!==T.undefined){const r=this._getOrReturnCtx(e);return w(r,{code:g.invalid_type,expected:T.undefined,received:r.parsedType}),b}return Ce(e.data)}}Gr.create=t=>new Gr({typeName:P.ZodUndefined,...O(t)});class Zr extends U{_parse(e){if(this._getType(e)!==T.null){const r=this._getOrReturnCtx(e);return w(r,{code:g.invalid_type,expected:T.null,received:r.parsedType}),b}return Ce(e.data)}}Zr.create=t=>new Zr({typeName:P.ZodNull,...O(t)});class Gn extends U{constructor(){super(...arguments),this._any=!0}_parse(e){return Ce(e.data)}}Gn.create=t=>new Gn({typeName:P.ZodAny,...O(t)});class on extends U{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ce(e.data)}}on.create=t=>new on({typeName:P.ZodUnknown,...O(t)});class Pt extends U{_parse(e){const n=this._getOrReturnCtx(e);return w(n,{code:g.invalid_type,expected:T.never,received:n.parsedType}),b}}Pt.create=t=>new Pt({typeName:P.ZodNever,...O(t)});class _i extends U{_parse(e){if(this._getType(e)!==T.undefined){const r=this._getOrReturnCtx(e);return w(r,{code:g.invalid_type,expected:T.void,received:r.parsedType}),b}return Ce(e.data)}}_i.create=t=>new _i({typeName:P.ZodVoid,...O(t)});class He extends U{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==T.array)return w(n,{code:g.invalid_type,expected:T.array,received:n.parsedType}),b;if(s.exactLength!==null){const a=n.data.length>s.exactLength.value,o=n.data.length<s.exactLength.value;(a||o)&&(w(n,{code:a?g.too_big:g.too_small,minimum:o?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(w(n,{code:g.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(w(n,{code:g.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,o)=>s.type._parseAsync(new dt(n,a,n.path,o)))).then(a=>Pe.mergeArray(r,a));const i=[...n.data].map((a,o)=>s.type._parseSync(new dt(n,a,n.path,o)));return Pe.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new He({...this._def,minLength:{value:e,message:S.toString(n)}})}max(e,n){return new He({...this._def,maxLength:{value:e,message:S.toString(n)}})}length(e,n){return new He({...this._def,exactLength:{value:e,message:S.toString(n)}})}nonempty(e){return this.min(1,e)}}He.create=(t,e)=>new He({type:t,minLength:null,maxLength:null,exactLength:null,typeName:P.ZodArray,...O(e)});function kn(t){if(t instanceof se){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=ut.create(kn(r))}return new se({...t._def,shape:()=>e})}else return t instanceof He?new He({...t._def,type:kn(t.element)}):t instanceof ut?ut.create(kn(t.unwrap())):t instanceof Gt?Gt.create(kn(t.unwrap())):t instanceof ft?ft.create(t.items.map(e=>kn(e))):t}class se extends U{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=$.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==T.object){const l=this._getOrReturnCtx(e);return w(l,{code:g.invalid_type,expected:T.object,received:l.parsedType}),b}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof Pt&&this._def.unknownKeys==="strip"))for(const l in s.data)a.includes(l)||o.push(l);const u=[];for(const l of a){const c=i[l],h=s.data[l];u.push({key:{status:"valid",value:l},value:c._parse(new dt(s,h,s.path,l)),alwaysSet:l in s.data})}if(this._def.catchall instanceof Pt){const l=this._def.unknownKeys;if(l==="passthrough")for(const c of o)u.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(l==="strict")o.length>0&&(w(s,{code:g.unrecognized_keys,keys:o}),r.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const c of o){const h=s.data[c];u.push({key:{status:"valid",value:c},value:l._parse(new dt(s,h,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const l=[];for(const c of u){const h=await c.key,d=await c.value;l.push({key:h,value:d,alwaysSet:c.alwaysSet})}return l}).then(l=>Pe.mergeObjectSync(r,l)):Pe.mergeObjectSync(r,u)}get shape(){return this._def.shape()}strict(e){return S.errToObj,new se({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var s,i,a,o;const u=(a=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,n,r).message)!==null&&a!==void 0?a:r.defaultError;return n.code==="unrecognized_keys"?{message:(o=S.errToObj(e).message)!==null&&o!==void 0?o:u}:{message:u}}}:{}})}strip(){return new se({...this._def,unknownKeys:"strip"})}passthrough(){return new se({...this._def,unknownKeys:"passthrough"})}extend(e){return new se({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new se({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:P.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new se({...this._def,catchall:e})}pick(e){const n={};return $.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new se({...this._def,shape:()=>n})}omit(e){const n={};return $.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new se({...this._def,shape:()=>n})}deepPartial(){return kn(this)}partial(e){const n={};return $.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}),new se({...this._def,shape:()=>n})}required(e){const n={};return $.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof ut;)i=i._def.innerType;n[r]=i}}),new se({...this._def,shape:()=>n})}keyof(){return Hf($.objectKeys(this.shape))}}se.create=(t,e)=>new se({shape:()=>t,unknownKeys:"strip",catchall:Pt.create(),typeName:P.ZodObject,...O(e)});se.strictCreate=(t,e)=>new se({shape:()=>t,unknownKeys:"strict",catchall:Pt.create(),typeName:P.ZodObject,...O(e)});se.lazycreate=(t,e)=>new se({shape:t,unknownKeys:"strip",catchall:Pt.create(),typeName:P.ZodObject,...O(e)});class Kr extends U{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new Le(o.ctx.common.issues));return w(n,{code:g.invalid_union,unionErrors:a}),b}if(n.common.async)return Promise.all(r.map(async i=>{const a={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const u of r){const l={...n,common:{...n.common,issues:[]},parent:null},c=u._parseSync({data:n.data,path:n.path,parent:l});if(c.status==="valid")return c;c.status==="dirty"&&!i&&(i={result:c,ctx:l}),l.common.issues.length&&a.push(l.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(u=>new Le(u));return w(n,{code:g.invalid_union,unionErrors:o}),b}}get options(){return this._def.options}}Kr.create=(t,e)=>new Kr({options:t,typeName:P.ZodUnion,...O(e)});const yt=t=>t instanceof Xr?yt(t.schema):t instanceof Je?yt(t.innerType()):t instanceof es?[t.value]:t instanceof Ht?t.options:t instanceof ts?$.objectValues(t.enum):t instanceof ns?yt(t._def.innerType):t instanceof Gr?[void 0]:t instanceof Zr?[null]:t instanceof ut?[void 0,...yt(t.unwrap())]:t instanceof Gt?[null,...yt(t.unwrap())]:t instanceof Ju||t instanceof ss?yt(t.unwrap()):t instanceof rs?yt(t._def.innerType):[];class oa extends U{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==T.object)return w(n,{code:g.invalid_type,expected:T.object,received:n.parsedType}),b;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(w(n,{code:g.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),b)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const s=new Map;for(const i of n){const a=yt(i.shape[e]);if(!a.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of a){if(s.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);s.set(o,i)}}return new oa({typeName:P.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:s,...O(r)})}}function vo(t,e){const n=Mt(t),r=Mt(e);if(t===e)return{valid:!0,data:t};if(n===T.object&&r===T.object){const s=$.objectKeys(e),i=$.objectKeys(t).filter(o=>s.indexOf(o)!==-1),a={...t,...e};for(const o of i){const u=vo(t[o],e[o]);if(!u.valid)return{valid:!1};a[o]=u.data}return{valid:!0,data:a}}else if(n===T.array&&r===T.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const a=t[i],o=e[i],u=vo(a,o);if(!u.valid)return{valid:!1};s.push(u.data)}return{valid:!0,data:s}}else return n===T.date&&r===T.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Qr extends U{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(i,a)=>{if(_o(i)||_o(a))return b;const o=vo(i.value,a.value);return o.valid?((yo(i)||yo(a))&&n.dirty(),{status:n.value,value:o.data}):(w(r,{code:g.invalid_intersection_types}),b)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Qr.create=(t,e,n)=>new Qr({left:t,right:e,typeName:P.ZodIntersection,...O(n)});class ft extends U{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==T.array)return w(r,{code:g.invalid_type,expected:T.array,received:r.parsedType}),b;if(r.data.length<this._def.items.length)return w(r,{code:g.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),b;!this._def.rest&&r.data.length>this._def.items.length&&(w(r,{code:g.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((a,o)=>{const u=this._def.items[o]||this._def.rest;return u?u._parse(new dt(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(i).then(a=>Pe.mergeArray(n,a)):Pe.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new ft({...this._def,rest:e})}}ft.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ft({items:t,typeName:P.ZodTuple,rest:null,...O(e)})};class Jr extends U{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==T.object)return w(r,{code:g.invalid_type,expected:T.object,received:r.parsedType}),b;const s=[],i=this._def.keyType,a=this._def.valueType;for(const o in r.data)s.push({key:i._parse(new dt(r,o,r.path,o)),value:a._parse(new dt(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?Pe.mergeObjectAsync(n,s):Pe.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof U?new Jr({keyType:e,valueType:n,typeName:P.ZodRecord,...O(r)}):new Jr({keyType:qe.create(),valueType:e,typeName:P.ZodRecord,...O(n)})}}class yi extends U{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==T.map)return w(r,{code:g.invalid_type,expected:T.map,received:r.parsedType}),b;const s=this._def.keyType,i=this._def.valueType,a=[...r.data.entries()].map(([o,u],l)=>({key:s._parse(new dt(r,o,r.path,[l,"key"])),value:i._parse(new dt(r,u,r.path,[l,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const u of a){const l=await u.key,c=await u.value;if(l.status==="aborted"||c.status==="aborted")return b;(l.status==="dirty"||c.status==="dirty")&&n.dirty(),o.set(l.value,c.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const u of a){const l=u.key,c=u.value;if(l.status==="aborted"||c.status==="aborted")return b;(l.status==="dirty"||c.status==="dirty")&&n.dirty(),o.set(l.value,c.value)}return{status:n.value,value:o}}}}yi.create=(t,e,n)=>new yi({valueType:e,keyType:t,typeName:P.ZodMap,...O(n)});class mn extends U{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==T.set)return w(r,{code:g.invalid_type,expected:T.set,received:r.parsedType}),b;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(w(r,{code:g.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(w(r,{code:g.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function a(u){const l=new Set;for(const c of u){if(c.status==="aborted")return b;c.status==="dirty"&&n.dirty(),l.add(c.value)}return{status:n.value,value:l}}const o=[...r.data.values()].map((u,l)=>i._parse(new dt(r,u,r.path,l)));return r.common.async?Promise.all(o).then(u=>a(u)):a(o)}min(e,n){return new mn({...this._def,minSize:{value:e,message:S.toString(n)}})}max(e,n){return new mn({...this._def,maxSize:{value:e,message:S.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}mn.create=(t,e)=>new mn({valueType:t,minSize:null,maxSize:null,typeName:P.ZodSet,...O(e)});class Fn extends U{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==T.function)return w(n,{code:g.invalid_type,expected:T.function,received:n.parsedType}),b;function r(o,u){return mi({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,fi(),Hn].filter(l=>!!l),issueData:{code:g.invalid_arguments,argumentsError:u}})}function s(o,u){return mi({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,fi(),Hn].filter(l=>!!l),issueData:{code:g.invalid_return_type,returnTypeError:u}})}const i={errorMap:n.common.contextualErrorMap},a=n.data;if(this._def.returns instanceof Zn){const o=this;return Ce(async function(...u){const l=new Le([]),c=await o._def.args.parseAsync(u,i).catch(m=>{throw l.addIssue(r(u,m)),l}),h=await Reflect.apply(a,this,c);return await o._def.returns._def.type.parseAsync(h,i).catch(m=>{throw l.addIssue(s(h,m)),l})})}else{const o=this;return Ce(function(...u){const l=o._def.args.safeParse(u,i);if(!l.success)throw new Le([r(u,l.error)]);const c=Reflect.apply(a,this,l.data),h=o._def.returns.safeParse(c,i);if(!h.success)throw new Le([s(c,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Fn({...this._def,args:ft.create(e).rest(on.create())})}returns(e){return new Fn({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new Fn({args:e||ft.create([]).rest(on.create()),returns:n||on.create(),typeName:P.ZodFunction,...O(r)})}}class Xr extends U{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Xr.create=(t,e)=>new Xr({getter:t,typeName:P.ZodLazy,...O(e)});class es extends U{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return w(n,{received:n.data,code:g.invalid_literal,expected:this._def.value}),b}return{status:"valid",value:e.data}}get value(){return this._def.value}}es.create=(t,e)=>new es({value:t,typeName:P.ZodLiteral,...O(e)});function Hf(t,e){return new Ht({values:t,typeName:P.ZodEnum,...O(e)})}class Ht extends U{constructor(){super(...arguments),gr.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return w(n,{expected:$.joinValues(r),received:n.parsedType,code:g.invalid_type}),b}if(pi(this,gr)||$f(this,gr,new Set(this._def.values)),!pi(this,gr).has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return w(n,{received:n.data,code:g.invalid_enum_value,options:r}),b}return Ce(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return Ht.create(e,{...this._def,...n})}exclude(e,n=this._def){return Ht.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}gr=new WeakMap;Ht.create=Hf;class ts extends U{constructor(){super(...arguments),_r.set(this,void 0)}_parse(e){const n=$.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==T.string&&r.parsedType!==T.number){const s=$.objectValues(n);return w(r,{expected:$.joinValues(s),received:r.parsedType,code:g.invalid_type}),b}if(pi(this,_r)||$f(this,_r,new Set($.getValidEnumValues(this._def.values))),!pi(this,_r).has(e.data)){const s=$.objectValues(n);return w(r,{received:r.data,code:g.invalid_enum_value,options:s}),b}return Ce(e.data)}get enum(){return this._def.values}}_r=new WeakMap;ts.create=(t,e)=>new ts({values:t,typeName:P.ZodNativeEnum,...O(e)});class Zn extends U{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==T.promise&&n.common.async===!1)return w(n,{code:g.invalid_type,expected:T.promise,received:n.parsedType}),b;const r=n.parsedType===T.promise?n.data:Promise.resolve(n.data);return Ce(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Zn.create=(t,e)=>new Zn({type:t,typeName:P.ZodPromise,...O(e)});class Je extends U{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===P.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:a=>{w(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const a=s.transform(r.data,i);if(r.common.async)return Promise.resolve(a).then(async o=>{if(n.value==="aborted")return b;const u=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return u.status==="aborted"?b:u.status==="dirty"||n.value==="dirty"?bn(u.value):u});{if(n.value==="aborted")return b;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?b:o.status==="dirty"||n.value==="dirty"?bn(o.value):o}}if(s.type==="refinement"){const a=o=>{const u=s.refinement(o,i);if(r.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?b:(o.status==="dirty"&&n.dirty(),a(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?b:(o.status==="dirty"&&n.dirty(),a(o.value).then(()=>({status:n.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!qr(a))return a;const o=s.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>qr(a)?Promise.resolve(s.transform(a.value,i)).then(o=>({status:n.value,value:o})):a);$.assertNever(s)}}Je.create=(t,e,n)=>new Je({schema:t,typeName:P.ZodEffects,effect:e,...O(n)});Je.createWithPreprocess=(t,e,n)=>new Je({schema:e,effect:{type:"preprocess",transform:t},typeName:P.ZodEffects,...O(n)});class ut extends U{_parse(e){return this._getType(e)===T.undefined?Ce(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ut.create=(t,e)=>new ut({innerType:t,typeName:P.ZodOptional,...O(e)});class Gt extends U{_parse(e){return this._getType(e)===T.null?Ce(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Gt.create=(t,e)=>new Gt({innerType:t,typeName:P.ZodNullable,...O(e)});class ns extends U{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===T.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}ns.create=(t,e)=>new ns({innerType:t,typeName:P.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...O(e)});class rs extends U{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return zr(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Le(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Le(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}rs.create=(t,e)=>new rs({innerType:t,typeName:P.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...O(e)});class vi extends U{_parse(e){if(this._getType(e)!==T.nan){const r=this._getOrReturnCtx(e);return w(r,{code:g.invalid_type,expected:T.nan,received:r.parsedType}),b}return{status:"valid",value:e.data}}}vi.create=t=>new vi({typeName:P.ZodNaN,...O(t)});const fI=Symbol("zod_brand");class Ju extends U{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Is extends U{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?b:i.status==="dirty"?(n.dirty(),bn(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?b:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new Is({in:e,out:n,typeName:P.ZodPipeline})}}class ss extends U{_parse(e){const n=this._def.innerType._parse(e),r=s=>(qr(s)&&(s.value=Object.freeze(s.value)),s);return zr(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}ss.create=(t,e)=>new ss({innerType:t,typeName:P.ZodReadonly,...O(e)});function Gf(t,e={},n){return t?Gn.create().superRefine((r,s)=>{var i,a;if(!t(r)){const o=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,u=(a=(i=o.fatal)!==null&&i!==void 0?i:n)!==null&&a!==void 0?a:!0,l=typeof o=="string"?{message:o}:o;s.addIssue({code:"custom",...l,fatal:u})}}):Gn.create()}const mI={object:se.lazycreate};var P;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(P||(P={}));const pI=(t,e={message:`Input not instance of ${t.name}`})=>Gf(n=>n instanceof t,e),Zf=qe.create,Kf=qt.create,gI=vi.create,_I=zt.create,Qf=Hr.create,yI=fn.create,vI=gi.create,wI=Gr.create,TI=Zr.create,EI=Gn.create,II=on.create,AI=Pt.create,SI=_i.create,RI=He.create,kI=se.create,DI=se.strictCreate,PI=Kr.create,bI=oa.create,CI=Qr.create,xI=ft.create,MI=Jr.create,VI=yi.create,NI=mn.create,OI=Fn.create,LI=Xr.create,FI=es.create,UI=Ht.create,jI=ts.create,BI=Zn.create,gc=Je.create,YI=ut.create,$I=Gt.create,WI=Je.createWithPreprocess,qI=Is.create,zI=()=>Zf().optional(),HI=()=>Kf().optional(),GI=()=>Qf().optional(),ZI={string:t=>qe.create({...t,coerce:!0}),number:t=>qt.create({...t,coerce:!0}),boolean:t=>Hr.create({...t,coerce:!0}),bigint:t=>zt.create({...t,coerce:!0}),date:t=>fn.create({...t,coerce:!0})},KI=b;var QI=Object.freeze({__proto__:null,defaultErrorMap:Hn,setErrorMap:KE,getErrorMap:fi,makeIssue:mi,EMPTY_PATH:QE,addIssueToContext:w,ParseStatus:Pe,INVALID:b,DIRTY:bn,OK:Ce,isAborted:_o,isDirty:yo,isValid:qr,isAsync:zr,get util(){return $},get objectUtil(){return go},ZodParsedType:T,getParsedType:Mt,ZodType:U,datetimeRegex:zf,ZodString:qe,ZodNumber:qt,ZodBigInt:zt,ZodBoolean:Hr,ZodDate:fn,ZodSymbol:gi,ZodUndefined:Gr,ZodNull:Zr,ZodAny:Gn,ZodUnknown:on,ZodNever:Pt,ZodVoid:_i,ZodArray:He,ZodObject:se,ZodUnion:Kr,ZodDiscriminatedUnion:oa,ZodIntersection:Qr,ZodTuple:ft,ZodRecord:Jr,ZodMap:yi,ZodSet:mn,ZodFunction:Fn,ZodLazy:Xr,ZodLiteral:es,ZodEnum:Ht,ZodNativeEnum:ts,ZodPromise:Zn,ZodEffects:Je,ZodTransformer:Je,ZodOptional:ut,ZodNullable:Gt,ZodDefault:ns,ZodCatch:rs,ZodNaN:vi,BRAND:fI,ZodBranded:Ju,ZodPipeline:Is,ZodReadonly:ss,custom:Gf,Schema:U,ZodSchema:U,late:mI,get ZodFirstPartyTypeKind(){return P},coerce:ZI,any:EI,array:RI,bigint:_I,boolean:Qf,date:yI,discriminatedUnion:bI,effect:gc,enum:UI,function:OI,instanceof:pI,intersection:CI,lazy:LI,literal:FI,map:VI,nan:gI,nativeEnum:jI,never:AI,null:TI,nullable:$I,number:Kf,object:kI,oboolean:GI,onumber:HI,optional:YI,ostring:zI,pipeline:qI,preprocess:WI,promise:BI,record:MI,set:NI,strictObject:DI,string:Zf,symbol:vI,transformer:gc,tuple:xI,undefined:wI,union:PI,unknown:II,void:SI,NEVER:KI,ZodIssueCode:g,quotelessJson:ZE,ZodError:Le});const $s=document.getElementById("list"),Jf=QI.string().min(2).max(40).trim(),_c=document.getElementById("form"),yc=document.getElementById("todo_text");let JI=6;window.addEventListener("load",function(){this.setTimeout(()=>{this.document.getElementById("loading_box").remove()},1e3)});_c.addEventListener("submit",t=>{t.preventDefault(),Jf.safeParse(yc.value).success?Wv(Pu,{content:yc.value.replace(/["<>/'``]/gi,"_"),done:!1,date:he.fromDate(new Date)}).then(e=>{console.log(e.id),_c.reset()}):swal({title:"mkin walo ?",text:"Lorem Ipsum is simply dummy",icon:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxnIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZiYWY4ZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjEuNSI+PHBhdGggZD0iTTcuODA1IDMuNDY5QzguMTYgMy4xMTUgOC40NTEgMyA4LjkzNyAzaDYuMTI2Yy40ODYgMCAuNzc4LjExNSAxLjEzMi40NjlsNC4zMzYgNC4zMzZjLjM1NC4zNTQuNDY5LjY0Ni40NjkgMS4xMzJ2Ni4xMjZjMCAuNS0uMTI1Ljc4OC0uNDY5IDEuMTMybC00LjMzNiA0LjMzNmMtLjM1NC4zNTQtLjY0Ni40NjktMS4xMzIuNDY5SDguOTM3Yy0uNSAwLS43ODgtLjEyNS0xLjEzMi0uNDY5TDMuNDcgMTYuMTk1Yy0uMzU1LS4zNTUtLjQ3LS42NDYtLjQ3LTEuMTMyVjguOTM3YzAtLjUuMTI1LS43ODguNDY5LTEuMTMyeiIvPjxwYXRoIGQ9Ik0xMiAxMy40OTZjMC0yLjAwMyAyLTEuNTAzIDItMy41MDZjMC0yLjY1OS00LTIuNjU5LTQgMG0yIDYuMDA3di0uNSIvPjwvZz48L3N2Zz4=",button:{text:"Close"}})});const XI=Ov(Pu,Lv("date","desc"),Fv(JI));qv(XI,t=>{const e=t.docs.map(n=>({id:n.id,content:n.data().content,done:n.data().done,date:n.data().date.toDate()}));nt.showData(e),Yv(Pu).then(n=>{document.getElementById("h1_logo").dataset.count=n.size<10?"0"+n.size:"+9"})});const eA=new MutationObserver(()=>{document.querySelectorAll(".delete_todo").forEach(t=>t.addEventListener("click",e=>nt.delete(e.target.dataset.id))),document.querySelectorAll(".done_todo").forEach(t=>t.addEventListener("click",e=>nt.done(e.target.dataset))),document.querySelectorAll(".update_todo_btn").forEach(t=>t.addEventListener("click",e=>nt.update(e.target.dataset))),document.querySelectorAll(".show_todo").forEach(t=>t.addEventListener("click",e=>nt.showInfo(e.target.dataset)))});eA.observe($s,{childList:!0});setInterval(()=>{document.getElementById("date_new").innerHTML=v().format("MMMM Do YYYY, h:mm:ss a")},1e3);class nt{}wn(nt,"update",({id:e,content:n})=>{const r=Aa(e);swal({title:"Are you sure?",content:{element:"input",attributes:{value:n}},buttons:["Cancel","Update"]}).then(s=>{if(console.log(s),Jf.safeParse(s).success)try{uc(r,{content:s,done:!1})}catch(i){console.error(i)}swal.close()})}),wn(nt,"done",({id:e,done:n})=>{const r=/^true$/i.test(n),s=Aa(e);try{uc(s,{done:!r})}catch{}}),wn(nt,"delete",e=>{const n=Aa(e);swal({title:"Are you sure?",text:"Lorem Ipsum is simply dummy text of the",icon:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9IiM2YmFmOGQiIGQ9Ik0xNiAydjRoNnYyaC0ydjE0SDRWOEgyVjZoNlYyem0tMiAyaC00djJoNHptMCA0SDZ2MTJoMTJWOHptLTUgMmgydjhIOXptNiAwaC0ydjhoMnoiLz48L3N2Zz4=",buttons:["Cancel","Delete"],dangerMode:!0,className:"ttt"}).then(r=>{r&&$v(n).then(s=>{})})}),wn(nt,"showInfo",e=>{swal({title:"Created At",text:v(new Date(e.date)).format("LLL"),button:"close"})}),wn(nt,"showData",e=>{$s.innerHTML="",e.length>0?e.forEach(n=>{$s.innerHTML+=GE(n)}):$s.innerHTML="<div class='empty'><span>Empty</span><i class='material-symbols-outlined'>scan_delete</i></div>"})});export default tA();
